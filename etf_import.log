2025-04-12 22:19:08,320 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:19:08,321 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:19:08,321 - INFO - 开始导入ETF基本信息...
2025-04-12 22:19:08,327 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:19:09,084 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:19:09,085 - INFO - 开始导入ETF价格数据...
2025-04-12 22:19:09,085 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:19:09,586 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:19:09,586 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:19:09,589 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:19:09,599 - ERROR - 导入ETF持有人数据时出错: 'code'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'code'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "import_excel_data.py", line 210, in import_etf_holders
    df['code'] = df['code'].apply(normalize_etf_code)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'code'
2025-04-12 22:19:09,602 - INFO - 开始导入ETF自选数据...
2025-04-12 22:19:09,604 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:19:09,615 - ERROR - 导入ETF自选数据时出错: 'code'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'code'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "import_excel_data.py", line 260, in import_etf_attention
    df['code'] = df['code'].apply(normalize_etf_code)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'code'
2025-04-12 22:19:09,615 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:19:09,616 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:19:09,666 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:19:09,667 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:19:09,670 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:19:09,770 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:19:09,770 - INFO - === ETF数据导入完成 ===
2025-04-12 22:19:09,770 - INFO - ETF基本信息: 成功
2025-04-12 22:19:09,770 - INFO - ETF价格数据: 成功
2025-04-12 22:19:09,770 - INFO - ETF持有人数据: 失败
2025-04-12 22:19:09,771 - INFO - ETF自选数据: 失败
2025-04-12 22:19:09,771 - INFO - ETF指数分类数据: 成功
2025-04-12 22:19:09,771 - INFO - ETF商务协议数据: 成功
2025-04-12 22:19:09,771 - INFO - === 数据库记录统计 ===
2025-04-12 22:19:09,771 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:19:09,772 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:19:09,772 - INFO - ETF持有人数据表: 1120条记录
2025-04-12 22:19:09,772 - INFO - ETF自选数据表: 1096条记录
2025-04-12 22:19:09,772 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 22:24:17,013 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:24:17,016 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:24:17,016 - INFO - 开始导入ETF基本信息...
2025-04-12 22:24:17,019 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:24:19,723 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:24:19,723 - INFO - 开始导入ETF价格数据...
2025-04-12 22:24:19,723 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:24:20,215 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:24:20,216 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:24:20,216 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:24:20,227 - ERROR - 找不到证券代码列
2025-04-12 22:24:20,227 - ERROR - 导入ETF持有人数据时出错: 'holder_count'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'holder_count'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 217, in import_etf_holders
    df['holder_count'] = pd.to_numeric(df['holder_count'], errors='coerce').fillna(0).astype(int)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'holder_count'
2025-04-12 22:24:20,231 - INFO - 开始导入ETF自选数据...
2025-04-12 22:24:20,231 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:24:20,241 - ERROR - 找不到证券代码列
2025-04-12 22:24:20,241 - ERROR - 导入ETF自选数据时出错: 'attention_count'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'attention_count'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 276, in import_etf_attention
    df['attention_count'] = pd.to_numeric(df['attention_count'], errors='coerce').fillna(0).astype(int)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'attention_count'
2025-04-12 22:24:20,241 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:24:20,243 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:24:20,293 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:24:20,293 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:24:20,295 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:24:20,393 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:24:20,393 - INFO - === ETF数据导入完成 ===
2025-04-12 22:24:20,393 - INFO - ETF基本信息: 成功
2025-04-12 22:24:20,393 - INFO - ETF价格数据: 成功
2025-04-12 22:24:20,393 - INFO - ETF持有人数据: 失败
2025-04-12 22:24:20,393 - INFO - ETF自选数据: 失败
2025-04-12 22:24:20,393 - INFO - ETF指数分类数据: 成功
2025-04-12 22:24:20,393 - INFO - ETF商务协议数据: 成功
2025-04-12 22:24:20,394 - INFO - === 数据库记录统计 ===
2025-04-12 22:24:20,394 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:24:20,394 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:24:20,394 - INFO - ETF持有人数据表: 1120条记录
2025-04-12 22:24:20,394 - INFO - ETF自选数据表: 1096条记录
2025-04-12 22:24:20,394 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 22:25:23,682 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:25:23,686 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:25:23,686 - INFO - 开始导入ETF基本信息...
2025-04-12 22:25:23,688 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:25:24,467 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:25:24,467 - INFO - 开始导入ETF价格数据...
2025-04-12 22:25:24,467 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:25:24,967 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:25:24,967 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:25:24,968 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:25:24,978 - ERROR - 找不到证券代码列
2025-04-12 22:25:24,978 - ERROR - 导入ETF持有人数据时出错: 'holder_count'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'holder_count'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 217, in import_etf_holders
    df['holder_count'] = pd.to_numeric(df['holder_count'], errors='coerce').fillna(0).astype(int)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'holder_count'
2025-04-12 22:25:24,981 - INFO - 开始导入ETF自选数据...
2025-04-12 22:25:24,981 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:25:24,993 - ERROR - 找不到证券代码列
2025-04-12 22:25:24,993 - ERROR - 导入ETF自选数据时出错: 'attention_count'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'attention_count'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 276, in import_etf_attention
    df['attention_count'] = pd.to_numeric(df['attention_count'], errors='coerce').fillna(0).astype(int)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'attention_count'
2025-04-12 22:25:24,994 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:25:24,995 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:25:25,045 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:25:25,045 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:25:25,047 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:25:25,147 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:25:25,147 - INFO - === ETF数据导入完成 ===
2025-04-12 22:25:25,147 - INFO - ETF基本信息: 成功
2025-04-12 22:25:25,147 - INFO - ETF价格数据: 成功
2025-04-12 22:25:25,147 - INFO - ETF持有人数据: 失败
2025-04-12 22:25:25,147 - INFO - ETF自选数据: 失败
2025-04-12 22:25:25,147 - INFO - ETF指数分类数据: 成功
2025-04-12 22:25:25,147 - INFO - ETF商务协议数据: 成功
2025-04-12 22:25:25,148 - INFO - === 数据库记录统计 ===
2025-04-12 22:25:25,148 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:25:25,148 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:25:25,149 - INFO - ETF持有人数据表: 1120条记录
2025-04-12 22:25:25,149 - INFO - ETF自选数据表: 1096条记录
2025-04-12 22:25:25,149 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 22:27:31,833 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:27:31,837 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:27:31,838 - INFO - 开始导入ETF基本信息...
2025-04-12 22:27:31,841 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:27:32,640 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:27:32,641 - INFO - 开始导入ETF价格数据...
2025-04-12 22:27:32,641 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:27:33,141 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:27:33,141 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:27:33,142 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:27:33,152 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:27:33,153 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:27:33,153 - INFO - 标准化后列名: ['数据截止日期']
2025-04-12 22:27:33,153 - INFO - 找到的代码列: []
2025-04-12 22:27:33,153 - INFO - 找到的持有人列: []
2025-04-12 22:27:33,153 - INFO - 找到的持仓价值列: []
2025-04-12 22:27:33,153 - ERROR - 未找到代码列
2025-04-12 22:27:33,153 - ERROR - 文件中的所有列: ['数据截止日期']
2025-04-12 22:27:33,153 - INFO - 开始导入ETF自选数据...
2025-04-12 22:27:33,154 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:27:33,165 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:27:33,165 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:27:33,165 - INFO - 标准化后列名: ['数据截止日期']
2025-04-12 22:27:33,165 - INFO - 找到的代码列: []
2025-04-12 22:27:33,165 - INFO - 找到的自选列: []
2025-04-12 22:27:33,165 - ERROR - 未找到代码列
2025-04-12 22:27:33,166 - ERROR - 文件中的所有列: ['数据截止日期']
2025-04-12 22:27:33,166 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:27:33,167 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:27:33,218 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:27:33,218 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:27:33,219 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:27:33,320 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:27:33,321 - INFO - === ETF数据导入完成 ===
2025-04-12 22:27:33,321 - INFO - ETF基本信息: 成功
2025-04-12 22:27:33,321 - INFO - ETF价格数据: 成功
2025-04-12 22:27:33,321 - INFO - ETF持有人数据: 失败
2025-04-12 22:27:33,321 - INFO - ETF自选数据: 失败
2025-04-12 22:27:33,321 - INFO - ETF指数分类数据: 成功
2025-04-12 22:27:33,321 - INFO - ETF商务协议数据: 成功
2025-04-12 22:27:33,322 - INFO - === 数据库记录统计 ===
2025-04-12 22:27:33,323 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:27:33,323 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:27:33,323 - INFO - ETF持有人数据表: 1120条记录
2025-04-12 22:27:33,323 - INFO - ETF自选数据表: 1096条记录
2025-04-12 22:27:33,323 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 22:32:50,101 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:32:50,102 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:32:50,102 - INFO - 开始导入ETF基本信息...
2025-04-12 22:32:50,105 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:32:50,858 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:32:50,858 - INFO - 开始导入ETF价格数据...
2025-04-12 22:32:50,859 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:32:51,367 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:32:51,368 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:32:51,368 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:32:51,378 - INFO - 读取工作表：默认
2025-04-12 22:32:51,378 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:32:51,379 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:32:51,379 - ERROR - Excel文件缺少以下列: ['标的代码', '持仓客户数', '持仓市值', '持仓份额']
2025-04-12 22:32:51,379 - ERROR - 实际列名: ['数据截止日期']
2025-04-12 22:32:51,379 - ERROR - 列数不足，无法识别数据结构
2025-04-12 22:32:51,379 - INFO - 开始导入ETF自选数据...
2025-04-12 22:32:51,380 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:32:51,390 - INFO - 读取工作表：默认
2025-04-12 22:32:51,390 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:32:51,391 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:32:51,391 - ERROR - Excel文件格式不匹配。期望列名: ['标的代码', '加自选人数']
2025-04-12 22:32:51,391 - ERROR - 实际列名: ['数据截止日期']
2025-04-12 22:32:51,391 - ERROR - 列数不足，无法识别数据结构
2025-04-12 22:32:51,391 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:32:51,392 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:32:51,443 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:32:51,443 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:32:51,445 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:32:51,545 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:32:51,545 - INFO - === ETF数据导入完成 ===
2025-04-12 22:32:51,546 - INFO - ETF基本信息: 成功
2025-04-12 22:32:51,546 - INFO - ETF价格数据: 成功
2025-04-12 22:32:51,546 - INFO - ETF持有人数据: 失败
2025-04-12 22:32:51,546 - INFO - ETF自选数据: 失败
2025-04-12 22:32:51,546 - INFO - ETF指数分类数据: 成功
2025-04-12 22:32:51,546 - INFO - ETF商务协议数据: 成功
2025-04-12 22:32:51,547 - INFO - === 数据库记录统计 ===
2025-04-12 22:32:51,547 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:32:51,547 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:32:51,547 - INFO - ETF持有人数据表: 1120条记录
2025-04-12 22:32:51,547 - INFO - ETF自选数据表: 1096条记录
2025-04-12 22:32:51,547 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 22:52:24,247 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 22:52:24,249 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 22:52:24,249 - INFO - 开始导入ETF基本信息...
2025-04-12 22:52:24,255 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:52:26,939 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 22:52:26,939 - INFO - 开始导入ETF价格数据...
2025-04-12 22:52:26,939 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 22:52:27,437 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 22:52:27,437 - INFO - 开始导入ETF持有人数据...
2025-04-12 22:52:27,438 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 22:52:27,499 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-12 22:52:27,508 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:52:27,508 - INFO - 数据形状: (0, 1)
2025-04-12 22:52:27,508 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:52:27,509 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 22:52:27,612 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-12 22:52:27,618 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-12 22:52:27,620 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-12 22:52:27,622 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value']
2025-04-12 22:52:27,626 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value
0  20250410  159001       货币ETF         54105.0            11     5410554.10
1      None  159003     招商快线ETF           853.0             4       85300.00
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53
2025-04-12 22:52:27,662 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-12 22:52:27,662 - INFO - 开始导入ETF自选数据...
2025-04-12 22:52:27,663 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 22:52:27,689 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-12 22:52:27,697 - INFO - 原始列名: ['数据截止日期']
2025-04-12 22:52:27,698 - INFO - 数据形状: (0, 1)
2025-04-12 22:52:27,698 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 22:52:27,698 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 22:52:27,772 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-12 22:52:27,775 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-12 22:52:27,776 - INFO - 成功读取数据，形状: (1114, 3)
2025-04-12 22:52:27,777 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count']
2025-04-12 22:52:27,780 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count
0  20250410  159001              100
1      None  159003               97
2      None  159005               43
3      None  159150              248
4      None  159201              867
2025-04-12 22:52:27,811 - INFO - 成功导入ETF自选数据，共1114条记录
2025-04-12 22:52:27,811 - INFO - 开始导入ETF指数分类数据...
2025-04-12 22:52:27,812 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 22:52:27,861 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 22:52:27,861 - INFO - 开始导入ETF商务协议数据...
2025-04-12 22:52:27,863 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 22:52:27,958 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 22:52:27,959 - INFO - === ETF数据导入完成 ===
2025-04-12 22:52:27,959 - INFO - ETF基本信息: 成功
2025-04-12 22:52:27,959 - INFO - ETF价格数据: 成功
2025-04-12 22:52:27,959 - INFO - ETF持有人数据: 成功
2025-04-12 22:52:27,959 - INFO - ETF自选数据: 成功
2025-04-12 22:52:27,959 - INFO - ETF指数分类数据: 成功
2025-04-12 22:52:27,959 - INFO - ETF商务协议数据: 成功
2025-04-12 22:52:27,960 - INFO - === 数据库记录统计 ===
2025-04-12 22:52:27,960 - INFO - ETF基本信息表: 1128条记录
2025-04-12 22:52:27,960 - INFO - ETF价格数据表: 1128条记录
2025-04-12 22:52:27,960 - INFO - ETF持有人数据表: 1104条记录
2025-04-12 22:52:27,960 - INFO - ETF自选数据表: 1114条记录
2025-04-12 22:52:27,960 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 23:02:28,390 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 23:02:28,392 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 23:02:28,392 - INFO - 开始导入ETF基本信息...
2025-04-12 23:02:28,395 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 23:02:31,585 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 23:02:31,586 - INFO - 开始导入ETF价格数据...
2025-04-12 23:02:31,586 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 23:02:32,470 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 23:02:32,472 - INFO - 开始导入ETF持有人数据...
2025-04-12 23:02:32,479 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 23:02:32,571 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-12 23:02:32,583 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:02:32,583 - INFO - 数据形状: (0, 1)
2025-04-12 23:02:32,584 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:02:32,584 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:02:32,721 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-12 23:02:32,727 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-12 23:02:32,733 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-12 23:02:32,735 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value']
2025-04-12 23:02:32,742 - INFO - 处理后数据前5行:
     数据截止日期  ... holding_value
0  20250410  ...    5410554.10
1      None  ...      85300.00
2      None  ...     129998.70
3      None  ...    1977585.17
4      None  ...   25270498.53

[5 rows x 6 columns]
2025-04-12 23:02:32,778 - ERROR - 导入ETF持有人数据失败
2025-04-12 23:02:32,778 - INFO - 开始导入ETF自选数据...
2025-04-12 23:02:32,779 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 23:02:32,779 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-12 23:02:32,814 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-12 23:02:32,823 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:02:32,823 - INFO - 数据形状: (0, 1)
2025-04-12 23:02:32,824 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:02:32,824 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:02:32,921 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-12 23:02:32,925 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-12 23:02:32,926 - INFO - 成功读取数据，形状: (1114, 3)
2025-04-12 23:02:32,928 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-12 23:02:32,932 - INFO - 处理后数据前5行:
     数据截止日期  ...        date
0  20250410  ...  2025-04-10
1      None  ...  2025-04-10
2      None  ...  2025-04-10
3      None  ...  2025-04-10
4      None  ...  2025-04-10

[5 rows x 4 columns]
2025-04-12 23:02:32,956 - ERROR - 导入ETF自选数据失败
2025-04-12 23:02:32,956 - INFO - 开始导入ETF指数分类数据...
2025-04-12 23:02:32,959 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 23:02:33,014 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 23:02:33,014 - INFO - 开始导入ETF商务协议数据...
2025-04-12 23:02:33,018 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 23:02:33,124 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 23:02:33,124 - INFO - === ETF数据导入完成 ===
2025-04-12 23:02:33,124 - INFO - ETF基本信息: 成功
2025-04-12 23:02:33,124 - INFO - ETF价格数据: 成功
2025-04-12 23:02:33,124 - INFO - ETF持有人数据: 失败
2025-04-12 23:02:33,124 - INFO - ETF自选数据: 失败
2025-04-12 23:02:33,124 - INFO - ETF指数分类数据: 成功
2025-04-12 23:02:33,125 - INFO - ETF商务协议数据: 成功
2025-04-12 23:02:33,125 - INFO - === 数据库记录统计 ===
2025-04-12 23:02:33,125 - INFO - ETF基本信息表: 1128条记录
2025-04-12 23:02:33,125 - INFO - ETF价格数据表: 1128条记录
2025-04-12 23:02:33,125 - INFO - ETF持有人数据表: 1104条记录
2025-04-12 23:02:33,125 - INFO - ETF自选数据表: 1114条记录
2025-04-12 23:02:33,125 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 23:04:57,088 - INFO - === 开始导入所有ETF数据 ===
2025-04-12 23:04:57,093 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-12 23:04:57,094 - INFO - 开始导入ETF基本信息...
2025-04-12 23:04:57,099 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 23:04:57,885 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-12 23:04:57,885 - INFO - 开始导入ETF价格数据...
2025-04-12 23:04:57,885 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-12 23:04:58,376 - INFO - 成功导入ETF价格数据，共1128条记录
2025-04-12 23:04:58,376 - INFO - 开始导入ETF持有人数据...
2025-04-12 23:04:58,377 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 23:04:58,377 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-12 23:04:58,439 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-12 23:04:58,449 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:04:58,449 - INFO - 数据形状: (0, 1)
2025-04-12 23:04:58,449 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:04:58,449 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:04:58,557 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-12 23:04:58,562 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-12 23:04:58,565 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-12 23:04:58,567 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-12 23:04:58,572 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-10
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-10
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-10
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-10
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-10
2025-04-12 23:04:58,624 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-12 23:04:58,624 - INFO - 开始导入ETF自选数据...
2025-04-12 23:04:58,625 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 23:04:58,625 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-12 23:04:58,652 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-12 23:04:58,660 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:04:58,660 - INFO - 数据形状: (0, 1)
2025-04-12 23:04:58,660 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:04:58,660 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:04:58,734 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-12 23:04:58,737 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-12 23:04:58,738 - INFO - 成功读取数据，形状: (1114, 3)
2025-04-12 23:04:58,740 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-12 23:04:58,743 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250410  159001              100  2025-04-10
1      None  159003               97  2025-04-10
2      None  159005               43  2025-04-10
3      None  159150              248  2025-04-10
4      None  159201              867  2025-04-10
2025-04-12 23:04:58,781 - INFO - 成功导入ETF自选数据，共1114条记录
2025-04-12 23:04:58,781 - INFO - 开始导入ETF指数分类数据...
2025-04-12 23:04:58,783 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-12 23:04:58,831 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-12 23:04:58,831 - INFO - 开始导入ETF商务协议数据...
2025-04-12 23:04:58,833 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-12 23:04:58,927 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-12 23:04:58,927 - INFO - === ETF数据导入完成 ===
2025-04-12 23:04:58,927 - INFO - ETF基本信息: 成功
2025-04-12 23:04:58,927 - INFO - ETF价格数据: 成功
2025-04-12 23:04:58,928 - INFO - ETF持有人数据: 成功
2025-04-12 23:04:58,928 - INFO - ETF自选数据: 成功
2025-04-12 23:04:58,928 - INFO - ETF指数分类数据: 成功
2025-04-12 23:04:58,928 - INFO - ETF商务协议数据: 成功
2025-04-12 23:04:58,928 - INFO - === 数据库记录统计 ===
2025-04-12 23:04:58,928 - INFO - ETF基本信息表: 1128条记录
2025-04-12 23:04:58,928 - INFO - ETF价格数据表: 1128条记录
2025-04-12 23:04:58,929 - INFO - ETF持有人数据表: 1104条记录
2025-04-12 23:04:58,929 - INFO - ETF自选数据表: 1114条记录
2025-04-12 23:04:58,929 - INFO - ETF商务协议数据表: 339条记录
2025-04-12 23:18:45,398 - INFO - 开始导入ETF持有人数据...
2025-04-12 23:18:45,399 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-12 23:18:45,399 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-12 23:18:45,475 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-12 23:18:45,637 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:18:45,638 - INFO - 数据形状: (0, 1)
2025-04-12 23:18:45,638 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:18:45,638 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:18:45,748 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-12 23:18:45,754 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-12 23:18:45,757 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-12 23:18:45,761 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-12 23:18:45,768 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-10
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-10
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-10
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-10
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-10
2025-04-12 23:18:45,827 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-12 23:18:55,146 - INFO - 开始导入ETF自选数据...
2025-04-12 23:18:55,147 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-12 23:18:55,147 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-12 23:18:55,191 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-12 23:18:55,350 - INFO - 原始列名: ['数据截止日期']
2025-04-12 23:18:55,350 - INFO - 数据形状: (0, 1)
2025-04-12 23:18:55,351 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-12 23:18:55,351 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-12 23:18:55,425 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-12 23:18:55,428 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-12 23:18:55,431 - INFO - 成功读取数据，形状: (1114, 3)
2025-04-12 23:18:55,436 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-12 23:18:55,441 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250410  159001              100  2025-04-10
1      None  159003               97  2025-04-10
2      None  159005               43  2025-04-10
3      None  159150              248  2025-04-10
4      None  159201              867  2025-04-10
2025-04-12 23:18:55,492 - INFO - 成功导入ETF自选数据，共1114条记录
2025-04-13 00:30:14,712 - INFO - === 开始导入所有ETF数据 ===
2025-04-13 00:30:14,727 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-13 00:30:14,727 - INFO - 开始导入ETF基本信息...
2025-04-13 00:30:14,741 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:30:14,741 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:30:17,713 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-13 00:30:17,713 - INFO - 开始导入ETF价格数据...
2025-04-13 00:30:17,714 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:30:17,714 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:30:18,204 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-13 00:30:18,204 - INFO - 开始导入ETF持有人数据...
2025-04-13 00:30:18,205 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-13 00:30:18,205 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:30:18,266 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-13 00:30:18,275 - INFO - 原始列名: ['数据截止日期']
2025-04-13 00:30:18,275 - INFO - 数据形状: (0, 1)
2025-04-13 00:30:18,275 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-13 00:30:18,275 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-13 00:30:18,380 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-13 00:30:18,386 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-13 00:30:18,388 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-13 00:30:18,390 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-13 00:30:18,396 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-10
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-10
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-10
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-10
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-10
2025-04-13 00:30:18,449 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-13 00:30:18,450 - INFO - 开始导入ETF自选数据...
2025-04-13 00:30:18,450 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-13 00:30:18,450 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:30:18,459 - INFO - 原始列名: ['数据截止日期']
2025-04-13 00:30:18,460 - INFO - 数据形状: (0, 1)
2025-04-13 00:30:18,460 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-13 00:30:18,460 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-13 00:30:18,460 - INFO - 开始导入ETF指数分类数据...
2025-04-13 00:30:18,461 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-13 00:30:18,511 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-13 00:30:18,512 - INFO - 开始导入ETF商务协议数据...
2025-04-13 00:30:18,513 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-13 00:30:18,626 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-13 00:30:18,627 - INFO - 开始导入ETF规模数据到历史表...
2025-04-13 00:30:18,627 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:30:18,627 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:30:19,103 - INFO - 使用列: 代码=证券代码, 规模=基金规模(合计)
[交易日期] S_cal_date(now(),0,D,0)
[单位] 亿元
2025-04-13 00:30:19,165 - INFO - 成功导入 1126 条 2025-04-10 的ETF规模历史数据
2025-04-13 00:30:19,165 - INFO - === ETF数据导入完成 ===
2025-04-13 00:30:19,165 - INFO - ETF基本信息: 成功
2025-04-13 00:30:19,165 - INFO - ETF价格数据: 失败
2025-04-13 00:30:19,165 - INFO - ETF持有人数据: 成功
2025-04-13 00:30:19,165 - INFO - ETF自选数据: 失败
2025-04-13 00:30:19,165 - INFO - ETF指数分类数据: 成功
2025-04-13 00:30:19,165 - INFO - ETF商务协议数据: 成功
2025-04-13 00:30:19,165 - INFO - ETF规模数据: 成功
2025-04-13 00:30:19,166 - INFO - === 数据库记录统计 ===
2025-04-13 00:30:19,166 - INFO - ETF基本信息表: 1128条记录
2025-04-13 00:30:19,166 - INFO - ETF价格数据表: 1128条记录
2025-04-13 00:30:19,166 - INFO - ETF持有人数据表: 1104条记录
2025-04-13 00:30:19,166 - INFO - ETF自选数据表: 1114条记录
2025-04-13 00:30:19,166 - INFO - ETF商务协议数据表: 339条记录
2025-04-13 00:32:13,810 - INFO - === 开始导入所有ETF数据 ===
2025-04-13 00:32:13,813 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-13 00:32:13,813 - INFO - 开始导入ETF基本信息...
2025-04-13 00:32:13,817 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:32:13,818 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:32:14,568 - INFO - 成功导入ETF基本信息，共1128条记录
2025-04-13 00:32:14,568 - INFO - 开始导入ETF价格数据...
2025-04-13 00:32:14,568 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:32:14,568 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:32:15,359 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-13 00:32:15,359 - INFO - 开始导入ETF持有人数据...
2025-04-13 00:32:15,360 - INFO - 使用文件: data/客户ETF保有量20250410.xlsx
2025-04-13 00:32:15,360 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:32:15,428 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-13 00:32:15,443 - INFO - 原始列名: ['数据截止日期']
2025-04-13 00:32:15,443 - INFO - 数据形状: (0, 1)
2025-04-13 00:32:15,446 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-13 00:32:15,446 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-13 00:32:15,566 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-13 00:32:15,572 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-13 00:32:15,575 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-13 00:32:15,577 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-13 00:32:15,582 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-10
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-10
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-10
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-10
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-10
2025-04-13 00:32:15,635 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-13 00:32:15,635 - INFO - 开始导入ETF自选数据...
2025-04-13 00:32:15,636 - INFO - 使用文件: data/客户ETF自选人数20250410.xlsx
2025-04-13 00:32:15,636 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:32:15,646 - INFO - 原始列名: ['数据截止日期']
2025-04-13 00:32:15,646 - INFO - 数据形状: (0, 1)
2025-04-13 00:32:15,647 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-13 00:32:15,647 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-13 00:32:15,647 - INFO - 开始导入ETF指数分类数据...
2025-04-13 00:32:15,653 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-13 00:32:15,908 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-13 00:32:15,910 - INFO - 开始导入ETF商务协议数据...
2025-04-13 00:32:15,944 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-13 00:32:16,134 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-13 00:32:16,135 - INFO - 开始导入ETF规模数据到历史表...
2025-04-13 00:32:16,136 - INFO - 使用文件: data/ETF_DATA_20250410.xlsx
2025-04-13 00:32:16,136 - INFO - 从文件名中提取的日期: 2025-04-10
2025-04-13 00:32:16,142 - INFO - 日期 2025-04-10 的ETF规模历史数据已存在，跳过导入
2025-04-13 00:32:16,143 - INFO - === ETF数据导入完成 ===
2025-04-13 00:32:16,143 - INFO - ETF基本信息: 成功
2025-04-13 00:32:16,143 - INFO - ETF价格数据: 失败
2025-04-13 00:32:16,143 - INFO - ETF持有人数据: 成功
2025-04-13 00:32:16,143 - INFO - ETF自选数据: 失败
2025-04-13 00:32:16,143 - INFO - ETF指数分类数据: 成功
2025-04-13 00:32:16,143 - INFO - ETF商务协议数据: 成功
2025-04-13 00:32:16,143 - INFO - ETF规模数据: 成功
2025-04-13 00:32:16,144 - INFO - === 数据库记录统计 ===
2025-04-13 00:32:16,144 - INFO - ETF基本信息表: 1128条记录
2025-04-13 00:32:16,144 - INFO - ETF价格数据表: 1128条记录
2025-04-13 00:32:16,144 - INFO - ETF持有人数据表: 1104条记录
2025-04-13 00:32:16,144 - INFO - ETF自选数据表: 1114条记录
2025-04-13 00:32:16,144 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 10:09:31,455 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 10:09:31,493 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 10:09:31,493 - INFO - 开始导入ETF基本信息...
2025-04-14 10:09:31,499 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:09:31,499 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:09:32,297 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 10:09:32,297 - INFO - 开始导入ETF价格数据...
2025-04-14 10:09:32,297 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:09:32,297 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:09:32,872 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 10:09:32,872 - INFO - 开始导入ETF持有人数据...
2025-04-14 10:09:32,873 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 10:09:32,873 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:09:32,930 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 10:09:32,941 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:09:32,941 - INFO - 数据形状: (0, 1)
2025-04-14 10:09:32,941 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:09:32,941 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:09:33,042 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 10:09:33,049 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 10:09:33,050 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-14 10:09:33,052 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 10:09:33,059 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-11
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-11
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-11
2025-04-14 10:09:33,116 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-14 10:09:33,116 - INFO - 开始导入ETF自选数据...
2025-04-14 10:09:33,116 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:09:33,116 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:09:33,126 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:09:33,127 - INFO - 数据形状: (0, 1)
2025-04-14 10:09:33,127 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:09:33,127 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:09:33,127 - INFO - 开始导入ETF指数分类数据...
2025-04-14 10:09:33,128 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 10:09:33,192 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 10:09:33,192 - INFO - 开始导入ETF商务协议数据...
2025-04-14 10:09:33,193 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 10:09:33,290 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 10:09:33,291 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:09:33,291 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:09:33,291 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:09:33,774 - INFO - 使用列: 代码=证券代码, 规模=基金规模(合计)
[交易日期] S_cal_date(now(),0,D,0)
[单位] 亿元
2025-04-14 10:09:33,836 - INFO - 成功导入 1130 条 2025-04-11 的ETF规模历史数据
2025-04-14 10:09:33,837 - INFO - === ETF数据导入完成 ===
2025-04-14 10:09:33,837 - INFO - ETF基本信息: 成功
2025-04-14 10:09:33,837 - INFO - ETF价格数据: 失败
2025-04-14 10:09:33,837 - INFO - ETF持有人数据: 成功
2025-04-14 10:09:33,837 - INFO - ETF自选数据: 失败
2025-04-14 10:09:33,837 - INFO - ETF指数分类数据: 成功
2025-04-14 10:09:33,837 - INFO - ETF商务协议数据: 成功
2025-04-14 10:09:33,837 - INFO - ETF规模数据: 成功
2025-04-14 10:09:33,837 - INFO - === 数据库记录统计 ===
2025-04-14 10:09:33,837 - INFO - ETF基本信息表: 1132条记录
2025-04-14 10:09:33,837 - INFO - ETF价格数据表: 1128条记录
2025-04-14 10:09:33,837 - INFO - ETF持有人数据表: 1104条记录
2025-04-14 10:09:33,837 - INFO - ETF自选数据表: 1114条记录
2025-04-14 10:09:33,838 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 10:12:31,190 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 10:12:31,193 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 10:12:31,193 - INFO - 开始导入ETF基本信息...
2025-04-14 10:12:31,197 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:12:31,197 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:12:32,007 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 10:12:32,007 - INFO - 开始导入ETF价格数据...
2025-04-14 10:12:32,007 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:12:32,007 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:12:32,522 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 10:12:32,522 - INFO - 开始导入ETF持有人数据...
2025-04-14 10:12:32,523 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 10:12:32,523 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:12:32,585 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 10:12:32,595 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:12:32,595 - INFO - 数据形状: (0, 1)
2025-04-14 10:12:32,596 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:12:32,596 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:12:32,709 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 10:12:32,715 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 10:12:32,716 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-14 10:12:32,719 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 10:12:32,728 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-11
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-11
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-11
2025-04-14 10:12:32,783 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-14 10:12:32,784 - INFO - 开始导入ETF自选数据...
2025-04-14 10:12:32,784 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:12:32,784 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:12:32,795 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:12:32,795 - INFO - 数据形状: (0, 1)
2025-04-14 10:12:32,796 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:12:32,796 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:12:32,796 - INFO - 开始导入ETF指数分类数据...
2025-04-14 10:12:32,796 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 10:12:32,855 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 10:12:32,855 - INFO - 开始导入ETF商务协议数据...
2025-04-14 10:12:32,856 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 10:12:32,975 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 10:12:32,975 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:12:32,976 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:12:32,977 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:12:32,980 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 10:12:32,980 - INFO - === ETF数据导入完成 ===
2025-04-14 10:12:32,980 - INFO - ETF基本信息: 成功
2025-04-14 10:12:32,981 - INFO - ETF价格数据: 失败
2025-04-14 10:12:32,981 - INFO - ETF持有人数据: 成功
2025-04-14 10:12:32,981 - INFO - ETF自选数据: 失败
2025-04-14 10:12:32,981 - INFO - ETF指数分类数据: 成功
2025-04-14 10:12:32,981 - INFO - ETF商务协议数据: 成功
2025-04-14 10:12:32,981 - INFO - ETF规模数据: 成功
2025-04-14 10:12:32,981 - INFO - === 数据库记录统计 ===
2025-04-14 10:12:32,981 - INFO - ETF基本信息表: 1132条记录
2025-04-14 10:12:32,981 - INFO - ETF价格数据表: 1128条记录
2025-04-14 10:12:32,981 - INFO - ETF持有人数据表: 1104条记录
2025-04-14 10:12:32,982 - INFO - ETF自选数据表: 1114条记录
2025-04-14 10:12:32,982 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 10:15:14,803 - INFO - 开始导入ETF自选数据...
2025-04-14 10:15:14,804 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:15:14,804 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:15:14,962 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:15:14,962 - INFO - 数据形状: (0, 1)
2025-04-14 10:15:14,962 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:15:14,963 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:16:30,180 - INFO - 开始导入ETF自选数据...
2025-04-14 10:16:30,181 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:16:30,181 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:16:30,372 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:16:30,372 - INFO - 数据形状: (0, 1)
2025-04-14 10:16:30,373 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:16:30,374 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:17:34,118 - INFO - 开始导入ETF自选数据...
2025-04-14 10:17:34,119 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:17:34,120 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:17:34,120 - INFO - 读取Excel文件
2025-04-14 10:17:34,281 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:17:34,281 - INFO - 数据形状: (0, 1)
2025-04-14 10:17:34,282 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:17:34,283 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:18:46,010 - INFO - 使用测试数据模式
2025-04-14 10:18:46,011 - INFO - 开始导入ETF自选数据...
2025-04-14 10:18:46,011 - INFO - 使用测试文件: test/test_attention.csv
2025-04-14 10:18:46,011 - INFO - 使用文件: test/test_attention.csv
2025-04-14 10:18:46,011 - WARNING - 无法从文件名中提取日期，使用当前日期: 2025-04-14
2025-04-14 10:18:46,011 - INFO - 读取CSV文件
2025-04-14 10:18:46,019 - INFO - 原始列名: ['标的代码', '加自选人数']
2025-04-14 10:18:46,019 - INFO - 数据形状: (2, 2)
2025-04-14 10:18:46,026 - INFO - 数据前5行:
     标的代码  加自选人数
0  510050   1234
1  159915   5678
2025-04-14 10:18:46,028 - INFO - 处理后列名: ['code', 'attention_count', 'date']
2025-04-14 10:18:46,031 - INFO - 处理后数据前5行:
     code  attention_count        date
0  510050             1234  2025-04-14
1  159915             5678  2025-04-14
2025-04-14 10:18:46,087 - INFO - 成功导入ETF自选数据，共2条记录
2025-04-14 10:18:46,088 - INFO - 导入完成，成功 1/1 个任务
2025-04-14 10:19:31,452 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 10:19:31,488 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 10:19:31,488 - INFO - 开始导入ETF基本信息...
2025-04-14 10:19:31,493 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:19:31,493 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:19:32,223 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 10:19:32,223 - INFO - 开始导入ETF价格数据...
2025-04-14 10:19:32,224 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:19:32,224 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:19:32,776 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 10:19:32,776 - INFO - 开始导入ETF持有人数据...
2025-04-14 10:19:32,776 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 10:19:32,776 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:19:32,830 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 10:19:32,838 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:19:32,838 - INFO - 数据形状: (0, 1)
2025-04-14 10:19:32,839 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:19:32,839 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:19:32,940 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 10:19:32,945 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 10:19:32,947 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-14 10:19:32,949 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 10:19:32,954 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-11
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-11
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-11
2025-04-14 10:19:33,012 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-14 10:19:33,012 - INFO - 开始导入ETF自选数据...
2025-04-14 10:19:33,017 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:19:33,017 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:19:33,027 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:19:33,027 - INFO - 数据形状: (0, 1)
2025-04-14 10:19:33,027 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:19:33,027 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:19:33,027 - INFO - 开始导入ETF指数分类数据...
2025-04-14 10:19:33,028 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 10:19:33,094 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 10:19:33,094 - INFO - 开始导入ETF商务协议数据...
2025-04-14 10:19:33,095 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 10:19:33,193 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 10:19:33,193 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:19:33,193 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:19:33,193 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:19:33,198 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 10:19:33,198 - INFO - === ETF数据导入完成 ===
2025-04-14 10:19:33,198 - INFO - ETF基本信息: 成功
2025-04-14 10:19:33,198 - INFO - ETF价格数据: 失败
2025-04-14 10:19:33,198 - INFO - ETF持有人数据: 成功
2025-04-14 10:19:33,198 - INFO - ETF自选数据: 失败
2025-04-14 10:19:33,198 - INFO - ETF指数分类数据: 成功
2025-04-14 10:19:33,199 - INFO - ETF商务协议数据: 成功
2025-04-14 10:19:33,199 - INFO - ETF规模数据: 成功
2025-04-14 10:19:33,199 - INFO - === 数据库记录统计 ===
2025-04-14 10:19:33,199 - INFO - ETF基本信息表: 1132条记录
2025-04-14 10:19:33,200 - INFO - ETF价格数据表: 1128条记录
2025-04-14 10:19:33,200 - INFO - ETF持有人数据表: 1104条记录
2025-04-14 10:19:33,200 - INFO - ETF自选数据表: 2条记录
2025-04-14 10:19:33,200 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 10:40:24,227 - INFO - 开始导入ETF自选数据...
2025-04-14 10:40:24,228 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:40:24,228 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:40:24,394 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:40:24,394 - INFO - 数据形状: (0, 1)
2025-04-14 10:40:24,395 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:40:24,396 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:42:05,249 - INFO - 开始导入ETF自选数据...
2025-04-14 10:42:05,250 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:42:05,250 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:42:05,411 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:42:05,411 - INFO - 数据形状: (0, 1)
2025-04-14 10:42:05,412 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:42:05,413 - ERROR - ETF自选数据文件缺少以下列: ['标的代码', '加自选人数']
2025-04-14 10:49:35,074 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:49:35,078 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:49:35,078 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:49:35,103 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 10:51:00,435 - INFO - 开始导入ETF自选数据...
2025-04-14 10:51:00,436 - INFO - 使用文件: data/客户ETF自选人数20250411_restore.xlsx
2025-04-14 10:51:00,437 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:51:00,483 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 10:51:00,653 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:51:00,653 - INFO - 数据形状: (0, 1)
2025-04-14 10:51:00,654 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:51:00,654 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:51:00,726 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 10:51:00,730 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 10:51:00,733 - INFO - 成功读取数据，形状: (1113, 3)
2025-04-14 10:51:00,733 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 10:51:00,733 - INFO - 找到的代码列: ['标的代码']
2025-04-14 10:51:00,733 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 10:51:00,737 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 10:51:00,742 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250409  159001              100  2025-04-11
1      None  159003               97  2025-04-11
2      None  159005               42  2025-04-11
3      None  159150              250  2025-04-11
4      None  159201              853  2025-04-11
2025-04-14 10:51:00,807 - INFO - 成功导入ETF自选数据，共1113条记录
2025-04-14 10:52:47,115 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 10:52:47,116 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 10:52:47,116 - INFO - 开始导入ETF基本信息...
2025-04-14 10:52:47,118 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:52:47,118 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:52:47,934 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 10:52:47,934 - INFO - 开始导入ETF价格数据...
2025-04-14 10:52:47,935 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:52:47,935 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:52:48,463 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 10:52:48,463 - INFO - 开始导入ETF持有人数据...
2025-04-14 10:52:48,464 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 10:52:48,464 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:52:48,527 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 10:52:48,536 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:52:48,536 - INFO - 数据形状: (0, 1)
2025-04-14 10:52:48,536 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:52:48,537 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:52:48,649 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 10:52:48,655 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 10:52:48,657 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-14 10:52:48,659 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 10:52:48,666 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-11
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-11
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-11
2025-04-14 10:52:48,725 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-14 10:52:48,726 - INFO - 开始导入ETF自选数据...
2025-04-14 10:52:48,726 - INFO - 使用文件: data/客户ETF自选人数20250411_restore.xlsx
2025-04-14 10:52:48,726 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:52:48,757 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 10:52:48,769 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:52:48,769 - INFO - 数据形状: (0, 1)
2025-04-14 10:52:48,769 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:52:48,769 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:52:48,849 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 10:52:48,853 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 10:52:48,853 - INFO - 成功读取数据，形状: (1113, 3)
2025-04-14 10:52:48,853 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 10:52:48,853 - INFO - 找到的代码列: ['标的代码']
2025-04-14 10:52:48,854 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 10:52:48,855 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 10:52:48,859 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250409  159001              100  2025-04-11
1      None  159003               97  2025-04-11
2      None  159005               42  2025-04-11
3      None  159150              250  2025-04-11
4      None  159201              853  2025-04-11
2025-04-14 10:52:48,900 - INFO - 成功导入ETF自选数据，共1113条记录
2025-04-14 10:52:48,900 - INFO - 开始导入ETF指数分类数据...
2025-04-14 10:52:48,900 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 10:52:48,953 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 10:52:48,953 - INFO - 开始导入ETF商务协议数据...
2025-04-14 10:52:48,953 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 10:52:49,061 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 10:52:49,061 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:52:49,061 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:52:49,061 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:52:49,067 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 10:52:49,067 - INFO - === ETF数据导入完成 ===
2025-04-14 10:52:49,067 - INFO - ETF基本信息: 成功
2025-04-14 10:52:49,067 - INFO - ETF价格数据: 失败
2025-04-14 10:52:49,067 - INFO - ETF持有人数据: 成功
2025-04-14 10:52:49,067 - INFO - ETF自选数据: 成功
2025-04-14 10:52:49,067 - INFO - ETF指数分类数据: 成功
2025-04-14 10:52:49,067 - INFO - ETF商务协议数据: 成功
2025-04-14 10:52:49,068 - INFO - ETF规模数据: 成功
2025-04-14 10:52:49,068 - INFO - === 数据库记录统计 ===
2025-04-14 10:52:49,068 - INFO - ETF基本信息表: 1132条记录
2025-04-14 10:52:49,068 - INFO - ETF价格数据表: 1128条记录
2025-04-14 10:52:49,068 - INFO - ETF持有人数据表: 1104条记录
2025-04-14 10:52:49,068 - INFO - ETF自选数据表: 1113条记录
2025-04-14 10:52:49,068 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 10:55:02,137 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 10:55:02,140 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 10:55:02,140 - INFO - 开始导入ETF基本信息...
2025-04-14 10:55:02,142 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:55:02,143 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:55:02,927 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 10:55:02,928 - INFO - 开始导入ETF价格数据...
2025-04-14 10:55:02,928 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:55:02,928 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:55:03,429 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 10:55:03,430 - INFO - 开始导入ETF持有人数据...
2025-04-14 10:55:03,430 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 10:55:03,430 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:55:03,491 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 10:55:03,500 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:55:03,500 - INFO - 数据形状: (0, 1)
2025-04-14 10:55:03,501 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:55:03,501 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:55:03,608 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 10:55:03,613 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 10:55:03,616 - INFO - 成功读取数据，形状: (1104, 6)
2025-04-14 10:55:03,618 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 10:55:03,624 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250410  159001       货币ETF         54105.0            11     5410554.10  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-11
3      None  159150  深证50ETF易方达       1804366.0            37     1977585.17  2025-04-11
4      None  159201    自由现金流ETF      26854940.0           560    25270498.53  2025-04-11
2025-04-14 10:55:03,679 - INFO - 成功导入ETF持有人数据，共1104条记录
2025-04-14 10:55:03,679 - INFO - 开始导入ETF自选数据...
2025-04-14 10:55:03,680 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 10:55:03,680 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:55:03,708 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 10:55:03,716 - INFO - 原始列名: ['数据截止日期']
2025-04-14 10:55:03,716 - INFO - 数据形状: (0, 1)
2025-04-14 10:55:03,717 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 10:55:03,717 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 10:55:03,808 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 10:55:03,811 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 10:55:03,812 - INFO - 成功读取数据，形状: (1113, 3)
2025-04-14 10:55:03,812 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 10:55:03,812 - INFO - 找到的代码列: ['标的代码']
2025-04-14 10:55:03,812 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 10:55:03,814 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 10:55:03,818 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250409  159001              100  2025-04-11
1      None  159003               97  2025-04-11
2      None  159005               42  2025-04-11
3      None  159150              250  2025-04-11
4      None  159201              853  2025-04-11
2025-04-14 10:55:03,860 - INFO - 成功导入ETF自选数据，共1113条记录
2025-04-14 10:55:03,860 - INFO - 开始导入ETF指数分类数据...
2025-04-14 10:55:03,861 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 10:55:03,912 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 10:55:03,913 - INFO - 开始导入ETF商务协议数据...
2025-04-14 10:55:03,913 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 10:55:04,012 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 10:55:04,012 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 10:55:04,013 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 10:55:04,013 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 10:55:04,018 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 10:55:04,019 - INFO - === ETF数据导入完成 ===
2025-04-14 10:55:04,019 - INFO - ETF基本信息: 成功
2025-04-14 10:55:04,019 - INFO - ETF价格数据: 失败
2025-04-14 10:55:04,019 - INFO - ETF持有人数据: 成功
2025-04-14 10:55:04,019 - INFO - ETF自选数据: 成功
2025-04-14 10:55:04,019 - INFO - ETF指数分类数据: 成功
2025-04-14 10:55:04,019 - INFO - ETF商务协议数据: 成功
2025-04-14 10:55:04,019 - INFO - ETF规模数据: 成功
2025-04-14 10:55:04,019 - INFO - === 数据库记录统计 ===
2025-04-14 10:55:04,019 - INFO - ETF基本信息表: 1132条记录
2025-04-14 10:55:04,019 - INFO - ETF价格数据表: 1128条记录
2025-04-14 10:55:04,020 - INFO - ETF持有人数据表: 1104条记录
2025-04-14 10:55:04,020 - INFO - ETF自选数据表: 1113条记录
2025-04-14 10:55:04,020 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 14:16:05,328 - INFO - 开始导入ETF基本信息...
2025-04-14 14:16:05,333 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 14:16:05,333 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 14:16:11,294 - ERROR - 导入ETF基本信息失败
2025-04-14 14:16:26,488 - INFO - 开始导入ETF基本信息...
2025-04-14 14:16:26,489 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 14:16:26,489 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 14:16:27,279 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 18:11:52,528 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 18:11:52,530 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 18:11:52,530 - INFO - 开始导入ETF基本信息...
2025-04-14 18:11:52,538 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 18:11:52,538 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 18:11:53,366 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 18:11:53,367 - INFO - 开始导入ETF价格数据...
2025-04-14 18:11:53,367 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 18:11:53,367 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 18:11:53,871 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 18:11:53,871 - INFO - 开始导入ETF持有人数据...
2025-04-14 18:11:53,872 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 18:11:53,872 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 18:11:53,935 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 18:11:53,944 - INFO - 原始列名: ['数据截止日期']
2025-04-14 18:11:53,944 - INFO - 数据形状: (0, 1)
2025-04-14 18:11:53,945 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 18:11:53,945 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 18:11:54,055 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 18:11:54,060 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 18:11:54,062 - INFO - 成功读取数据，形状: (1102, 6)
2025-04-14 18:11:54,064 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 18:11:54,071 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250411  159001       货币ETF         54205.0            11     5420500.00  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          2100.0            13      209997.90  2025-04-11
3      None  159150  深证50ETF易方达       1769366.0            37     1946302.60  2025-04-11
4      None  159201    自由现金流ETF      28220532.0           576    26499079.57  2025-04-11
2025-04-14 18:11:54,122 - INFO - 成功导入ETF持有人数据，共1102条记录
2025-04-14 18:11:54,123 - INFO - 开始导入ETF自选数据...
2025-04-14 18:11:54,123 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 18:11:54,123 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 18:11:54,151 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 18:11:54,160 - INFO - 原始列名: ['数据截止日期']
2025-04-14 18:11:54,160 - INFO - 数据形状: (0, 1)
2025-04-14 18:11:54,160 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 18:11:54,160 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 18:11:54,239 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 18:11:54,242 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 18:11:54,243 - INFO - 成功读取数据，形状: (1116, 3)
2025-04-14 18:11:54,243 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 18:11:54,243 - INFO - 找到的代码列: ['标的代码']
2025-04-14 18:11:54,243 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 18:11:54,245 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 18:11:54,248 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250411  159001               99  2025-04-11
1      None  159003               98  2025-04-11
2      None  159005               43  2025-04-11
3      None  159150              248  2025-04-11
4      None  159201              880  2025-04-11
2025-04-14 18:11:54,287 - INFO - 成功导入ETF自选数据，共1116条记录
2025-04-14 18:11:54,287 - INFO - 开始导入ETF指数分类数据...
2025-04-14 18:11:54,287 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 18:11:54,338 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 18:11:54,338 - INFO - 开始导入ETF商务协议数据...
2025-04-14 18:11:54,339 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 18:11:54,438 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 18:11:54,439 - INFO - 开始导入ETF规模数据到历史表...
2025-04-14 18:11:54,439 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 18:11:54,439 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 18:11:54,445 - INFO - 日期 2025-04-11 的ETF规模历史数据已存在，跳过导入
2025-04-14 18:11:54,445 - INFO - === ETF数据导入完成 ===
2025-04-14 18:11:54,445 - INFO - ETF基本信息: 成功
2025-04-14 18:11:54,445 - INFO - ETF价格数据: 失败
2025-04-14 18:11:54,445 - INFO - ETF持有人数据: 成功
2025-04-14 18:11:54,445 - INFO - ETF自选数据: 成功
2025-04-14 18:11:54,445 - INFO - ETF指数分类数据: 成功
2025-04-14 18:11:54,445 - INFO - ETF商务协议数据: 成功
2025-04-14 18:11:54,446 - INFO - ETF规模数据: 成功
2025-04-14 18:11:54,446 - INFO - === 数据库记录统计 ===
2025-04-14 18:11:54,446 - INFO - ETF基本信息表: 1132条记录
2025-04-14 18:11:54,446 - INFO - ETF价格数据表: 1128条记录
2025-04-14 18:11:54,446 - INFO - ETF持有人数据表: 1102条记录
2025-04-14 18:11:54,446 - INFO - ETF自选数据表: 1116条记录
2025-04-14 18:11:54,446 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 21:45:14,494 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 21:45:14,498 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 21:45:14,498 - INFO - 开始导入ETF基本信息...
2025-04-14 21:45:14,501 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 21:45:14,502 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 21:45:17,433 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 21:45:17,433 - INFO - 开始导入ETF价格数据...
2025-04-14 21:45:17,434 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 21:45:17,434 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 21:45:18,137 - ERROR - ETF价格数据文件缺少以下列: ['最新价', '涨跌幅', '成交量', '成交额']
2025-04-14 21:45:18,137 - INFO - 开始导入ETF持有人数据...
2025-04-14 21:45:18,142 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 21:45:18,143 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 21:45:18,221 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 21:45:18,236 - INFO - 原始列名: ['数据截止日期']
2025-04-14 21:45:18,236 - INFO - 数据形状: (0, 1)
2025-04-14 21:45:18,237 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 21:45:18,237 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 21:45:18,368 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 21:45:18,381 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 21:45:18,390 - INFO - 成功读取数据，形状: (1102, 6)
2025-04-14 21:45:18,400 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 21:45:18,452 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250411  159001       货币ETF         54205.0            11     5420500.00  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          2100.0            13      209997.90  2025-04-11
3      None  159150  深证50ETF易方达       1769366.0            37     1946302.60  2025-04-11
4      None  159201    自由现金流ETF      28220532.0           576    26499079.57  2025-04-11
2025-04-14 21:45:18,620 - INFO - 成功导入ETF持有人数据，共1102条记录
2025-04-14 21:45:18,621 - INFO - 开始导入ETF自选数据...
2025-04-14 21:45:18,622 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 21:45:18,622 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 21:45:18,666 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 21:45:18,681 - INFO - 原始列名: ['数据截止日期']
2025-04-14 21:45:18,682 - INFO - 数据形状: (0, 1)
2025-04-14 21:45:18,682 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 21:45:18,682 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 21:45:18,787 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 21:45:18,791 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 21:45:18,792 - INFO - 成功读取数据，形状: (1116, 3)
2025-04-14 21:45:18,792 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 21:45:18,792 - INFO - 找到的代码列: ['标的代码']
2025-04-14 21:45:18,792 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 21:45:18,795 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 21:45:18,801 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250411  159001               99  2025-04-11
1      None  159003               98  2025-04-11
2      None  159005               43  2025-04-11
3      None  159150              248  2025-04-11
4      None  159201              880  2025-04-11
2025-04-14 21:45:18,830 - INFO - 成功导入ETF自选数据，共1116条记录
2025-04-14 21:45:18,831 - INFO - 开始导入ETF指数分类数据...
2025-04-14 21:45:18,831 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 21:45:18,890 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 21:45:18,891 - INFO - 开始导入ETF商务协议数据...
2025-04-14 21:45:18,891 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 21:45:19,015 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 21:45:19,015 - INFO - === ETF数据导入完成 ===
2025-04-14 21:45:19,015 - INFO - ETF基本信息: 成功
2025-04-14 21:45:19,015 - INFO - ETF价格数据: 失败
2025-04-14 21:45:19,015 - INFO - ETF持有人数据: 成功
2025-04-14 21:45:19,015 - INFO - ETF自选数据: 成功
2025-04-14 21:45:19,015 - INFO - ETF指数分类数据: 成功
2025-04-14 21:45:19,015 - INFO - ETF商务协议数据: 成功
2025-04-14 21:45:19,016 - INFO - === 数据库记录统计 ===
2025-04-14 21:45:19,016 - INFO - ETF基本信息表: 1132条记录
2025-04-14 21:45:19,016 - INFO - ETF价格数据表: 1128条记录
2025-04-14 21:45:19,016 - INFO - ETF持有人数据表: 1102条记录
2025-04-14 21:45:19,016 - INFO - ETF自选数据表: 1116条记录
2025-04-14 21:45:19,016 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 22:00:39,207 - INFO - 开始导入ETF价格数据...
2025-04-14 22:00:39,208 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:00:39,209 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:00:39,943 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:00:39,943 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:00:39,950 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:00:39,984 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)  ...                -0.0010  2025-04-11  2025-04-14 22:00:39
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率  ...                -0.0874  2025-04-11  2025-04-14 22:00:39
2  159597  创业板成长ETF易方达                 创业板成长指数收益率  ...                 0.0942  2025-04-11  2025-04-14 22:00:39
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)  ...                 0.9636  2025-04-11  2025-04-14 22:00:39
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率  ...                -0.2099  2025-04-11  2025-04-14 22:00:39

[5 rows x 39 columns]
2025-04-14 22:00:40,008 - ERROR - 导入ETF价格数据失败
2025-04-14 22:01:48,748 - INFO - 开始导入ETF价格数据...
2025-04-14 22:01:48,765 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:01:48,766 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:01:49,469 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:01:49,469 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:01:49,475 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:01:49,506 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)  ...                -0.0010  2025-04-11  2025-04-14 22:01:49
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率  ...                -0.0874  2025-04-11  2025-04-14 22:01:49
2  159597  创业板成长ETF易方达                 创业板成长指数收益率  ...                 0.0942  2025-04-11  2025-04-14 22:01:49
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)  ...                 0.9636  2025-04-11  2025-04-14 22:01:49
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率  ...                -0.2099  2025-04-11  2025-04-14 22:01:49

[5 rows x 39 columns]
2025-04-14 22:01:49,550 - ERROR - 导入ETF价格数据失败
2025-04-14 22:02:33,602 - INFO - 开始导入ETF价格数据...
2025-04-14 22:02:33,604 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:02:33,605 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:02:34,225 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:02:34,226 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:02:34,228 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:02:34,252 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)  ...                -0.0010  2025-04-11  2025-04-14 22:02:34
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率  ...                -0.0874  2025-04-11  2025-04-14 22:02:34
2  159597  创业板成长ETF易方达                 创业板成长指数收益率  ...                 0.0942  2025-04-11  2025-04-14 22:02:34
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)  ...                 0.9636  2025-04-11  2025-04-14 22:02:34
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率  ...                -0.2099  2025-04-11  2025-04-14 22:02:34

[5 rows x 39 columns]
2025-04-14 22:02:34,286 - INFO - 成功导入ETF价格数据，共1132条记录
2025-04-14 22:02:45,101 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 22:02:45,101 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 22:02:45,102 - INFO - 开始导入ETF基本信息...
2025-04-14 22:02:45,104 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:02:45,105 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:02:46,014 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 22:02:46,015 - INFO - 开始导入ETF价格数据...
2025-04-14 22:02:46,016 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:02:46,016 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:02:46,576 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:02:46,577 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:02:46,579 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:02:46,604 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)  ...                -0.0010  2025-04-11  2025-04-14 22:02:46
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率  ...                -0.0874  2025-04-11  2025-04-14 22:02:46
2  159597  创业板成长ETF易方达                 创业板成长指数收益率  ...                 0.0942  2025-04-11  2025-04-14 22:02:46
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)  ...                 0.9636  2025-04-11  2025-04-14 22:02:46
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率  ...                -0.2099  2025-04-11  2025-04-14 22:02:46

[5 rows x 39 columns]
2025-04-14 22:02:46,661 - INFO - 成功导入ETF价格数据，共1132条记录
2025-04-14 22:02:46,661 - INFO - 开始导入ETF持有人数据...
2025-04-14 22:02:46,662 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 22:02:46,662 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:02:46,740 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 22:02:46,750 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:02:46,750 - INFO - 数据形状: (0, 1)
2025-04-14 22:02:46,750 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:02:46,750 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:02:46,858 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 22:02:46,863 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 22:02:46,865 - INFO - 成功读取数据，形状: (1102, 6)
2025-04-14 22:02:46,867 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 22:02:46,873 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250411  159001       货币ETF         54205.0            11     5420500.00  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          2100.0            13      209997.90  2025-04-11
3      None  159150  深证50ETF易方达       1769366.0            37     1946302.60  2025-04-11
4      None  159201    自由现金流ETF      28220532.0           576    26499079.57  2025-04-11
2025-04-14 22:02:46,925 - INFO - 成功导入ETF持有人数据，共1102条记录
2025-04-14 22:02:46,926 - INFO - 开始导入ETF自选数据...
2025-04-14 22:02:46,926 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 22:02:46,926 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:02:46,955 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 22:02:46,965 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:02:46,965 - INFO - 数据形状: (0, 1)
2025-04-14 22:02:46,965 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:02:46,965 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:02:47,041 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 22:02:47,045 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 22:02:47,045 - INFO - 成功读取数据，形状: (1116, 3)
2025-04-14 22:02:47,046 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 22:02:47,046 - INFO - 找到的代码列: ['标的代码']
2025-04-14 22:02:47,046 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 22:02:47,047 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 22:02:47,051 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250411  159001               99  2025-04-11
1      None  159003               98  2025-04-11
2      None  159005               43  2025-04-11
3      None  159150              248  2025-04-11
4      None  159201              880  2025-04-11
2025-04-14 22:02:47,088 - INFO - 成功导入ETF自选数据，共1116条记录
2025-04-14 22:02:47,089 - INFO - 开始导入ETF指数分类数据...
2025-04-14 22:02:47,089 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 22:02:47,142 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 22:02:47,142 - INFO - 开始导入ETF商务协议数据...
2025-04-14 22:02:47,143 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 22:02:47,243 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 22:02:47,243 - INFO - === ETF数据导入完成 ===
2025-04-14 22:02:47,243 - INFO - ETF基本信息: 成功
2025-04-14 22:02:47,243 - INFO - ETF价格数据: 成功
2025-04-14 22:02:47,243 - INFO - ETF持有人数据: 成功
2025-04-14 22:02:47,243 - INFO - ETF自选数据: 成功
2025-04-14 22:02:47,243 - INFO - ETF指数分类数据: 成功
2025-04-14 22:02:47,243 - INFO - ETF商务协议数据: 成功
2025-04-14 22:02:47,244 - INFO - === 数据库记录统计 ===
2025-04-14 22:02:47,244 - INFO - ETF基本信息表: 1132条记录
2025-04-14 22:02:47,244 - INFO - ETF价格数据表: 1132条记录
2025-04-14 22:02:47,244 - INFO - ETF持有人数据表: 1102条记录
2025-04-14 22:02:47,244 - INFO - ETF自选数据表: 1116条记录
2025-04-14 22:02:47,244 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 22:04:24,568 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 22:04:24,572 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 22:04:24,572 - INFO - 开始导入ETF基本信息...
2025-04-14 22:04:24,575 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:04:24,576 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:04:25,327 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 22:04:25,327 - INFO - 开始导入ETF价格数据...
2025-04-14 22:04:25,327 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:04:25,327 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:04:25,819 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:04:25,820 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:04:25,821 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:04:25,846 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)       10.3151  ...          -0.0010               -0.0010  2025-04-11  2025-04-14 22:04:25
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率        0.9315  ...          -0.0009               -0.0874  2025-04-11  2025-04-14 22:04:25
2  159597  创业板成长ETF易方达                 创业板成长指数收益率        0.9342  ...           0.0010                0.0942  2025-04-11  2025-04-14 22:04:25
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)        3.1425  ...           0.0111                0.9636  2025-04-11  2025-04-14 22:04:25
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率        2.9644  ...          -0.0015               -0.2099  2025-04-11  2025-04-14 22:04:25

[5 rows x 39 columns]
2025-04-14 22:04:25,882 - INFO - 成功导入ETF价格数据，共1132条记录
2025-04-14 22:04:25,882 - INFO - 开始导入ETF持有人数据...
2025-04-14 22:04:25,883 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 22:04:25,883 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:04:25,942 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 22:04:25,951 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:04:25,951 - INFO - 数据形状: (0, 1)
2025-04-14 22:04:25,952 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:04:25,952 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:04:26,056 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 22:04:26,061 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 22:04:26,063 - INFO - 成功读取数据，形状: (1102, 6)
2025-04-14 22:04:26,065 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 22:04:26,070 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250411  159001       货币ETF         54205.0            11     5420500.00  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          2100.0            13      209997.90  2025-04-11
3      None  159150  深证50ETF易方达       1769366.0            37     1946302.60  2025-04-11
4      None  159201    自由现金流ETF      28220532.0           576    26499079.57  2025-04-11
2025-04-14 22:04:26,119 - INFO - 成功导入ETF持有人数据，共1102条记录
2025-04-14 22:04:26,119 - INFO - 开始导入ETF自选数据...
2025-04-14 22:04:26,119 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 22:04:26,120 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:04:26,147 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 22:04:26,155 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:04:26,156 - INFO - 数据形状: (0, 1)
2025-04-14 22:04:26,156 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:04:26,156 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:04:26,235 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 22:04:26,238 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 22:04:26,239 - INFO - 成功读取数据，形状: (1116, 3)
2025-04-14 22:04:26,239 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 22:04:26,239 - INFO - 找到的代码列: ['标的代码']
2025-04-14 22:04:26,239 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 22:04:26,241 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 22:04:26,244 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250411  159001               99  2025-04-11
1      None  159003               98  2025-04-11
2      None  159005               43  2025-04-11
3      None  159150              248  2025-04-11
4      None  159201              880  2025-04-11
2025-04-14 22:04:26,282 - INFO - 成功导入ETF自选数据，共1116条记录
2025-04-14 22:04:26,283 - INFO - 开始导入ETF指数分类数据...
2025-04-14 22:04:26,283 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 22:04:26,332 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 22:04:26,332 - INFO - 开始导入ETF商务协议数据...
2025-04-14 22:04:26,333 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 22:04:26,432 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 22:04:26,432 - INFO - === ETF数据导入完成 ===
2025-04-14 22:04:26,433 - INFO - ETF基本信息: 成功
2025-04-14 22:04:26,433 - INFO - ETF价格数据: 成功
2025-04-14 22:04:26,433 - INFO - ETF持有人数据: 成功
2025-04-14 22:04:26,433 - INFO - ETF自选数据: 成功
2025-04-14 22:04:26,433 - INFO - ETF指数分类数据: 成功
2025-04-14 22:04:26,433 - INFO - ETF商务协议数据: 成功
2025-04-14 22:04:26,433 - INFO - === 数据库记录统计 ===
2025-04-14 22:04:26,433 - INFO - ETF基本信息表: 1132条记录
2025-04-14 22:04:26,433 - INFO - ETF价格数据表: 1132条记录
2025-04-14 22:04:26,434 - INFO - ETF持有人数据表: 1102条记录
2025-04-14 22:04:26,434 - INFO - ETF自选数据表: 1116条记录
2025-04-14 22:04:26,434 - INFO - ETF商务协议数据表: 339条记录
2025-04-14 22:10:56,715 - INFO - === 开始导入所有ETF数据 ===
2025-04-14 22:10:56,718 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-14 22:10:56,718 - INFO - 开始导入ETF基本信息...
2025-04-14 22:10:56,720 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:10:56,721 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:10:57,630 - INFO - 成功导入ETF基本信息，共1132条记录
2025-04-14 22:10:57,630 - INFO - 开始导入ETF价格数据...
2025-04-14 22:10:57,630 - INFO - 使用文件: data/ETF_DATA_20250411.xlsx
2025-04-14 22:10:57,630 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:10:58,120 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-14 22:10:58,120 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-14 22:10:58,122 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-14 22:10:58,144 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)       10.3151  ...          -0.0010               -0.0010  2025-04-11  2025-04-14 22:10:58
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率        0.9315  ...          -0.0009               -0.0874  2025-04-11  2025-04-14 22:10:58
2  159597  创业板成长ETF易方达                 创业板成长指数收益率        0.9342  ...           0.0010                0.0942  2025-04-11  2025-04-14 22:10:58
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)        3.1425  ...           0.0111                0.9636  2025-04-11  2025-04-14 22:10:58
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率        2.9644  ...          -0.0015               -0.2099  2025-04-11  2025-04-14 22:10:58

[5 rows x 39 columns]
2025-04-14 22:10:58,180 - INFO - 成功导入ETF价格数据，共1132条记录
2025-04-14 22:10:58,181 - INFO - 开始导入ETF持有人数据...
2025-04-14 22:10:58,182 - INFO - 使用文件: data/客户ETF保有量20250411.xlsx
2025-04-14 22:10:58,182 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:10:58,240 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-14 22:10:58,250 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:10:58,250 - INFO - 数据形状: (0, 1)
2025-04-14 22:10:58,251 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:10:58,251 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:10:58,354 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-14 22:10:58,359 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-14 22:10:58,361 - INFO - 成功读取数据，形状: (1102, 6)
2025-04-14 22:10:58,363 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-14 22:10:58,368 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250411  159001       货币ETF         54205.0            11     5420500.00  2025-04-11
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-11
2      None  159005    汇添富快钱ETF          2100.0            13      209997.90  2025-04-11
3      None  159150  深证50ETF易方达       1769366.0            37     1946302.60  2025-04-11
4      None  159201    自由现金流ETF      28220532.0           576    26499079.57  2025-04-11
2025-04-14 22:10:58,438 - INFO - 成功导入ETF持有人数据，共1102条记录
2025-04-14 22:10:58,438 - INFO - 开始导入ETF自选数据...
2025-04-14 22:10:58,439 - INFO - 使用文件: data/客户ETF自选人数20250411.xlsx
2025-04-14 22:10:58,439 - INFO - 从文件名中提取的日期: 2025-04-11
2025-04-14 22:10:58,466 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-14 22:10:58,474 - INFO - 原始列名: ['数据截止日期']
2025-04-14 22:10:58,474 - INFO - 数据形状: (0, 1)
2025-04-14 22:10:58,474 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-14 22:10:58,474 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-14 22:10:58,550 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-14 22:10:58,553 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-14 22:10:58,554 - INFO - 成功读取数据，形状: (1116, 3)
2025-04-14 22:10:58,554 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-14 22:10:58,554 - INFO - 找到的代码列: ['标的代码']
2025-04-14 22:10:58,554 - INFO - 找到的自选列: ['加自选人数']
2025-04-14 22:10:58,555 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-14 22:10:58,560 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250411  159001               99  2025-04-11
1      None  159003               98  2025-04-11
2      None  159005               43  2025-04-11
3      None  159150              248  2025-04-11
4      None  159201              880  2025-04-11
2025-04-14 22:10:58,599 - INFO - 成功导入ETF自选数据，共1116条记录
2025-04-14 22:10:58,599 - INFO - 开始导入ETF指数分类数据...
2025-04-14 22:10:58,600 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-14 22:10:58,651 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-14 22:10:58,651 - INFO - 开始导入ETF商务协议数据...
2025-04-14 22:10:58,652 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-14 22:10:58,747 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-14 22:10:58,747 - INFO - === ETF数据导入完成 ===
2025-04-14 22:10:58,747 - INFO - ETF基本信息: 成功
2025-04-14 22:10:58,747 - INFO - ETF价格数据: 成功
2025-04-14 22:10:58,747 - INFO - ETF持有人数据: 成功
2025-04-14 22:10:58,747 - INFO - ETF自选数据: 成功
2025-04-14 22:10:58,747 - INFO - ETF指数分类数据: 成功
2025-04-14 22:10:58,747 - INFO - ETF商务协议数据: 成功
2025-04-14 22:10:58,748 - INFO - === 数据库记录统计 ===
2025-04-14 22:10:58,748 - INFO - ETF基本信息表: 1132条记录
2025-04-14 22:10:58,748 - INFO - ETF价格数据表: 1132条记录
2025-04-14 22:10:58,748 - INFO - ETF持有人数据表: 1102条记录
2025-04-14 22:10:58,748 - INFO - ETF自选数据表: 1116条记录
2025-04-14 22:10:58,748 - INFO - ETF商务协议数据表: 339条记录
2025-04-15 10:12:16,050 - INFO - === 开始导入所有ETF数据 ===
2025-04-15 10:12:16,055 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-15 10:12:16,056 - INFO - 开始导入ETF基本信息...
2025-04-15 10:12:16,059 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:12:16,060 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:12:18,943 - ERROR - 导入ETF基本信息失败
2025-04-15 10:12:18,944 - INFO - 开始导入ETF价格数据...
2025-04-15 10:12:18,944 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:12:18,945 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:12:19,513 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-15 10:12:19,514 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-15 10:12:19,516 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-15 10:12:19,540 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010        电信ETF       中证电信主题指数收益率        1.7808  上海证券交易所  ...    0.9868          -0.0017                -0.1393  2025-04-14  2025-04-15 10:12:19
1  159005     汇添富快钱ETF        活期存款利率(税后)       10.3178  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-04-14  2025-04-15 10:12:19
2  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率        0.9342  深圳证券交易所  ...    6.1224           0.0128                 1.1894  2025-04-14  2025-04-15 10:12:19
3  159531    中证2000ETF       中证2000指数收益率        1.6055  深圳证券交易所  ...    2.0916           0.0008                 0.0779  2025-04-14  2025-04-15 10:12:19
4  159597  创业板成长ETF易方达        创业板成长指数收益率        0.9370  深圳证券交易所  ...    1.4111          -0.0004                -0.0375  2025-04-14  2025-04-15 10:12:19

[5 rows x 39 columns]
2025-04-15 10:12:19,580 - INFO - 成功导入ETF价格数据，共1135条记录
2025-04-15 10:12:19,580 - INFO - 开始导入ETF持有人数据...
2025-04-15 10:12:19,581 - INFO - 使用文件: data/客户ETF保有量20250414.xlsx
2025-04-15 10:12:19,581 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:12:19,654 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-15 10:12:19,664 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:12:19,664 - INFO - 数据形状: (0, 1)
2025-04-15 10:12:19,665 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:12:19,665 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:12:19,781 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-15 10:12:19,787 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-15 10:12:19,789 - INFO - 成功读取数据，形状: (1107, 6)
2025-04-15 10:12:19,792 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-15 10:12:19,797 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250414  159001       货币ETF         54406.0            12     5440600.00  2025-04-14
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-14
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-14
3      None  159150  深证50ETF易方达       1769366.0            37     1949841.33  2025-04-14
4      None  159201    自由现金流ETF      28125532.0           565    26663004.35  2025-04-14
2025-04-15 10:12:19,850 - INFO - 成功导入ETF持有人数据，共1107条记录
2025-04-15 10:12:19,850 - INFO - 开始导入ETF自选数据...
2025-04-15 10:12:19,851 - INFO - 使用文件: data/客户ETF自选人数20250414.xlsx
2025-04-15 10:12:19,851 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:12:19,880 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-15 10:12:19,889 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:12:19,889 - INFO - 数据形状: (0, 1)
2025-04-15 10:12:19,890 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:12:19,890 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:12:19,954 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-15 10:12:19,958 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-15 10:12:19,959 - INFO - 成功读取数据，形状: (1120, 3)
2025-04-15 10:12:19,959 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-15 10:12:19,959 - INFO - 找到的代码列: ['标的代码']
2025-04-15 10:12:19,959 - INFO - 找到的自选列: ['加自选人数']
2025-04-15 10:12:19,961 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-15 10:12:19,964 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250414  159001               99  2025-04-14
1      None  159003               98  2025-04-14
2      None  159005               43  2025-04-14
3      None  159150              248  2025-04-14
4      None  159201              885  2025-04-14
2025-04-15 10:12:20,004 - INFO - 成功导入ETF自选数据，共1120条记录
2025-04-15 10:12:20,004 - INFO - 开始导入ETF指数分类数据...
2025-04-15 10:12:20,005 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-15 10:12:20,059 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-15 10:12:20,060 - INFO - 开始导入ETF商务协议数据...
2025-04-15 10:12:20,060 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-15 10:12:20,185 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-15 10:12:20,185 - INFO - === ETF数据导入完成 ===
2025-04-15 10:12:20,185 - INFO - ETF基本信息: 失败
2025-04-15 10:12:20,185 - INFO - ETF价格数据: 成功
2025-04-15 10:12:20,185 - INFO - ETF持有人数据: 成功
2025-04-15 10:12:20,185 - INFO - ETF自选数据: 成功
2025-04-15 10:12:20,185 - INFO - ETF指数分类数据: 成功
2025-04-15 10:12:20,185 - INFO - ETF商务协议数据: 成功
2025-04-15 10:12:20,186 - INFO - === 数据库记录统计 ===
2025-04-15 10:12:20,186 - INFO - ETF基本信息表: 0条记录
2025-04-15 10:12:20,186 - INFO - ETF价格数据表: 1135条记录
2025-04-15 10:12:20,186 - INFO - ETF持有人数据表: 1107条记录
2025-04-15 10:12:20,186 - INFO - ETF自选数据表: 1120条记录
2025-04-15 10:12:20,186 - INFO - ETF商务协议数据表: 339条记录
2025-04-15 10:18:31,257 - INFO - 开始导入ETF基本信息...
2025-04-15 10:18:31,259 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:18:31,260 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:18:32,186 - INFO - 成功导入ETF基本信息，共1135条记录
2025-04-15 10:19:40,482 - INFO - === 开始导入所有ETF数据 ===
2025-04-15 10:19:40,483 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-15 10:19:40,483 - INFO - 开始导入ETF基本信息...
2025-04-15 10:19:40,485 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:19:40,485 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:19:41,321 - INFO - 成功导入ETF基本信息，共1135条记录
2025-04-15 10:19:41,321 - INFO - 开始导入ETF价格数据...
2025-04-15 10:19:41,322 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:19:41,322 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:19:41,842 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-15 10:19:41,852 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-15 10:19:41,855 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-15 10:19:41,880 - INFO - 数据示例:
     code         证券简称            业绩比较基准  ...  premium_discount_rate        date          update_time
0  563010        电信ETF       中证电信主题指数收益率  ...                -0.1393  2025-04-14  2025-04-15 10:19:41
1  159005     汇添富快钱ETF        活期存款利率(税后)  ...                 0.0010  2025-04-14  2025-04-15 10:19:41
2  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率  ...                 1.1894  2025-04-14  2025-04-15 10:19:41
3  159531    中证2000ETF       中证2000指数收益率  ...                 0.0779  2025-04-14  2025-04-15 10:19:41
4  159597  创业板成长ETF易方达        创业板成长指数收益率  ...                -0.0375  2025-04-14  2025-04-15 10:19:41

[5 rows x 39 columns]
2025-04-15 10:19:41,915 - INFO - 成功导入ETF价格数据，共1135条记录
2025-04-15 10:19:41,915 - INFO - 开始导入ETF持有人数据...
2025-04-15 10:19:41,916 - INFO - 使用文件: data/客户ETF保有量20250414.xlsx
2025-04-15 10:19:41,916 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:19:41,980 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-15 10:19:41,990 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:19:41,990 - INFO - 数据形状: (0, 1)
2025-04-15 10:19:41,991 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:19:41,991 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:19:42,119 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-15 10:19:42,126 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-15 10:19:42,128 - INFO - 成功读取数据，形状: (1107, 6)
2025-04-15 10:19:42,130 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-15 10:19:42,137 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250414  159001       货币ETF         54406.0            12     5440600.00  2025-04-14
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-14
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-14
3      None  159150  深证50ETF易方达       1769366.0            37     1949841.33  2025-04-14
4      None  159201    自由现金流ETF      28125532.0           565    26663004.35  2025-04-14
2025-04-15 10:19:42,201 - INFO - 成功导入ETF持有人数据，共1107条记录
2025-04-15 10:19:42,202 - INFO - 开始导入ETF自选数据...
2025-04-15 10:19:42,202 - INFO - 使用文件: data/客户ETF自选人数20250414.xlsx
2025-04-15 10:19:42,202 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:19:42,231 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-15 10:19:42,240 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:19:42,240 - INFO - 数据形状: (0, 1)
2025-04-15 10:19:42,240 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:19:42,240 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:19:42,299 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-15 10:19:42,303 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-15 10:19:42,304 - INFO - 成功读取数据，形状: (1120, 3)
2025-04-15 10:19:42,304 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-15 10:19:42,304 - INFO - 找到的代码列: ['标的代码']
2025-04-15 10:19:42,304 - INFO - 找到的自选列: ['加自选人数']
2025-04-15 10:19:42,306 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-15 10:19:42,309 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250414  159001               99  2025-04-14
1      None  159003               98  2025-04-14
2      None  159005               43  2025-04-14
3      None  159150              248  2025-04-14
4      None  159201              885  2025-04-14
2025-04-15 10:19:42,351 - INFO - 成功导入ETF自选数据，共1120条记录
2025-04-15 10:19:42,351 - INFO - 开始导入ETF指数分类数据...
2025-04-15 10:19:42,352 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-15 10:19:42,405 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-15 10:19:42,405 - INFO - 开始导入ETF商务协议数据...
2025-04-15 10:19:42,406 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-15 10:19:42,528 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-15 10:19:42,528 - INFO - === ETF数据导入完成 ===
2025-04-15 10:19:42,528 - INFO - ETF基本信息: 成功
2025-04-15 10:19:42,528 - INFO - ETF价格数据: 成功
2025-04-15 10:19:42,528 - INFO - ETF持有人数据: 成功
2025-04-15 10:19:42,528 - INFO - ETF自选数据: 成功
2025-04-15 10:19:42,528 - INFO - ETF指数分类数据: 成功
2025-04-15 10:19:42,528 - INFO - ETF商务协议数据: 成功
2025-04-15 10:19:42,529 - INFO - === 数据库记录统计 ===
2025-04-15 10:19:42,529 - INFO - ETF基本信息表: 1135条记录
2025-04-15 10:19:42,529 - INFO - ETF价格数据表: 1135条记录
2025-04-15 10:19:42,529 - INFO - ETF持有人数据表: 1107条记录
2025-04-15 10:19:42,529 - INFO - ETF自选数据表: 1120条记录
2025-04-15 10:19:42,529 - INFO - ETF商务协议数据表: 339条记录
2025-04-15 10:20:17,754 - INFO - === 开始导入所有ETF数据 ===
2025-04-15 10:20:17,756 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-15 10:20:17,756 - INFO - 开始导入ETF基本信息...
2025-04-15 10:20:17,759 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:20:17,759 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:20:18,466 - INFO - 成功导入ETF基本信息，共1135条记录
2025-04-15 10:20:18,466 - INFO - 开始导入ETF价格数据...
2025-04-15 10:20:18,467 - INFO - 使用文件: data/ETF_DATA_20250414.xlsx
2025-04-15 10:20:18,467 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:20:18,969 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-15 10:20:18,970 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-15 10:20:18,972 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-15 10:20:18,994 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010        电信ETF       中证电信主题指数收益率        1.7808  上海证券交易所  ...    0.9868          -0.0017                -0.1393  2025-04-14  2025-04-15 10:20:18
1  159005     汇添富快钱ETF        活期存款利率(税后)       10.3178  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-04-14  2025-04-15 10:20:18
2  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率        0.9342  深圳证券交易所  ...    6.1224           0.0128                 1.1894  2025-04-14  2025-04-15 10:20:18
3  159531    中证2000ETF       中证2000指数收益率        1.6055  深圳证券交易所  ...    2.0916           0.0008                 0.0779  2025-04-14  2025-04-15 10:20:18
4  159597  创业板成长ETF易方达        创业板成长指数收益率        0.9370  深圳证券交易所  ...    1.4111          -0.0004                -0.0375  2025-04-14  2025-04-15 10:20:18

[5 rows x 39 columns]
2025-04-15 10:20:19,023 - INFO - 成功导入ETF价格数据，共1135条记录
2025-04-15 10:20:19,024 - INFO - 开始导入ETF持有人数据...
2025-04-15 10:20:19,024 - INFO - 使用文件: data/客户ETF保有量20250414.xlsx
2025-04-15 10:20:19,024 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:20:19,084 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-15 10:20:19,094 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:20:19,094 - INFO - 数据形状: (0, 1)
2025-04-15 10:20:19,094 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:20:19,094 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:20:19,204 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-15 10:20:19,210 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-15 10:20:19,212 - INFO - 成功读取数据，形状: (1107, 6)
2025-04-15 10:20:19,214 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-15 10:20:19,220 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250414  159001       货币ETF         54406.0            12     5440600.00  2025-04-14
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-14
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-14
3      None  159150  深证50ETF易方达       1769366.0            37     1949841.33  2025-04-14
4      None  159201    自由现金流ETF      28125532.0           565    26663004.35  2025-04-14
2025-04-15 10:20:19,258 - INFO - 成功导入ETF持有人数据，共1107条记录
2025-04-15 10:20:19,259 - INFO - 开始导入ETF自选数据...
2025-04-15 10:20:19,259 - INFO - 使用文件: data/客户ETF自选人数20250414.xlsx
2025-04-15 10:20:19,259 - INFO - 从文件名中提取的日期: 2025-04-14
2025-04-15 10:20:19,288 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-15 10:20:19,298 - INFO - 原始列名: ['数据截止日期']
2025-04-15 10:20:19,298 - INFO - 数据形状: (0, 1)
2025-04-15 10:20:19,299 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-15 10:20:19,299 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-15 10:20:19,358 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-15 10:20:19,361 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-15 10:20:19,362 - INFO - 成功读取数据，形状: (1120, 3)
2025-04-15 10:20:19,362 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-15 10:20:19,362 - INFO - 找到的代码列: ['标的代码']
2025-04-15 10:20:19,362 - INFO - 找到的自选列: ['加自选人数']
2025-04-15 10:20:19,364 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-15 10:20:19,367 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250414  159001               99  2025-04-14
1      None  159003               98  2025-04-14
2      None  159005               43  2025-04-14
3      None  159150              248  2025-04-14
4      None  159201              885  2025-04-14
2025-04-15 10:20:19,397 - INFO - 成功导入ETF自选数据，共1120条记录
2025-04-15 10:20:19,398 - INFO - 开始导入ETF指数分类数据...
2025-04-15 10:20:19,399 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-15 10:20:19,449 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-15 10:20:19,449 - INFO - 开始导入ETF商务协议数据...
2025-04-15 10:20:19,450 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-15 10:20:19,567 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-15 10:20:19,568 - INFO - === ETF数据导入完成 ===
2025-04-15 10:20:19,568 - INFO - ETF基本信息: 成功
2025-04-15 10:20:19,568 - INFO - ETF价格数据: 成功
2025-04-15 10:20:19,568 - INFO - ETF持有人数据: 成功
2025-04-15 10:20:19,568 - INFO - ETF自选数据: 成功
2025-04-15 10:20:19,568 - INFO - ETF指数分类数据: 成功
2025-04-15 10:20:19,568 - INFO - ETF商务协议数据: 成功
2025-04-15 10:20:19,568 - INFO - === 数据库记录统计 ===
2025-04-15 10:20:19,568 - INFO - ETF基本信息表: 1135条记录
2025-04-15 10:20:19,568 - INFO - ETF价格数据表: 1135条记录
2025-04-15 10:20:19,568 - INFO - ETF持有人数据表: 1107条记录
2025-04-15 10:20:19,569 - INFO - ETF自选数据表: 1120条记录
2025-04-15 10:20:19,569 - INFO - ETF商务协议数据表: 339条记录
2025-04-16 08:22:16,870 - INFO - === 开始导入所有ETF数据 ===
2025-04-16 08:22:16,872 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-16 08:22:16,872 - INFO - 开始导入ETF基本信息...
2025-04-16 08:22:16,874 - INFO - 使用文件: data/ETF_DATA_20250415.xlsx
2025-04-16 08:22:16,875 - INFO - 从文件名中提取的日期: 2025-04-15
2025-04-16 08:22:17,744 - INFO - 成功导入ETF基本信息，共1136条记录
2025-04-16 08:22:17,745 - INFO - 开始导入ETF价格数据...
2025-04-16 08:22:17,745 - INFO - 使用文件: data/ETF_DATA_20250415.xlsx
2025-04-16 08:22:17,745 - INFO - 从文件名中提取的日期: 2025-04-15
2025-04-16 08:22:18,235 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-16 08:22:18,236 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-16 08:22:18,238 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-16 08:22:18,260 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)       10.3205  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-04-15  2025-04-16 08:22:18
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率        0.9370  深圳证券交易所  ...    3.8567           0.0027                 0.2506  2025-04-15  2025-04-16 08:22:18
2  159531    中证2000ETF                中证2000指数收益率        1.6082  深圳证券交易所  ...    1.4591           0.0004                 0.0390  2025-04-15  2025-04-16 08:22:18
3  159597  创业板成长ETF易方达                 创业板成长指数收益率        0.9397  深圳证券交易所  ...    1.4071          -0.0009                -0.0848  2025-04-15  2025-04-16 08:22:18
4  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)        3.1479  深圳证券交易所  ...    1.0989           0.0058                 0.4910  2025-04-15  2025-04-16 08:22:18

[5 rows x 39 columns]
2025-04-16 08:22:18,292 - INFO - 成功导入ETF价格数据，共1136条记录
2025-04-16 08:22:18,292 - INFO - 开始导入ETF持有人数据...
2025-04-16 08:22:18,293 - INFO - 使用文件: data/客户ETF保有量20250415.xlsx
2025-04-16 08:22:18,293 - INFO - 从文件名中提取的日期: 2025-04-15
2025-04-16 08:22:18,352 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-16 08:22:18,360 - INFO - 原始列名: ['数据截止日期']
2025-04-16 08:22:18,360 - INFO - 数据形状: (0, 1)
2025-04-16 08:22:18,361 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-16 08:22:18,361 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-16 08:22:18,463 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-16 08:22:18,469 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-16 08:22:18,471 - INFO - 成功读取数据，形状: (1109, 6)
2025-04-16 08:22:18,474 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-16 08:22:18,479 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250415  159001       货币ETF         54506.0            12   5.450655e+06  2025-04-15
1      None  159003     招商快线ETF          5953.0             5   5.953000e+05  2025-04-15
2      None  159005    汇添富快钱ETF          1300.0            12   1.300013e+05  2025-04-15
3      None  159150  深证50ETF易方达       1769366.0            37   1.949841e+06  2025-04-15
4      None  159201    自由现金流ETF      27759532.0           569   2.634380e+07  2025-04-15
2025-04-16 08:22:18,519 - INFO - 成功导入ETF持有人数据，共1109条记录
2025-04-16 08:22:18,520 - INFO - 开始导入ETF自选数据...
2025-04-16 08:22:18,520 - INFO - 使用文件: data/客户ETF自选人数20250415.xlsx
2025-04-16 08:22:18,520 - INFO - 从文件名中提取的日期: 2025-04-15
2025-04-16 08:22:18,546 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-16 08:22:18,555 - INFO - 原始列名: ['数据截止日期']
2025-04-16 08:22:18,555 - INFO - 数据形状: (0, 1)
2025-04-16 08:22:18,555 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-16 08:22:18,555 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-16 08:22:18,628 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-16 08:22:18,632 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-16 08:22:18,633 - INFO - 成功读取数据，形状: (1121, 3)
2025-04-16 08:22:18,633 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-16 08:22:18,633 - INFO - 找到的代码列: ['标的代码']
2025-04-16 08:22:18,633 - INFO - 找到的自选列: ['加自选人数']
2025-04-16 08:22:18,635 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-16 08:22:18,638 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250415  159001               99  2025-04-15
1      None  159003               98  2025-04-15
2      None  159005               43  2025-04-15
3      None  159150              249  2025-04-15
4      None  159201              892  2025-04-15
2025-04-16 08:22:18,671 - INFO - 成功导入ETF自选数据，共1121条记录
2025-04-16 08:22:18,671 - INFO - 开始导入ETF指数分类数据...
2025-04-16 08:22:18,672 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-16 08:22:18,720 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-16 08:22:18,720 - INFO - 开始导入ETF商务协议数据...
2025-04-16 08:22:18,721 - INFO - 使用文件: data/ETF单产品商务协议20250328.xlsx
2025-04-16 08:22:18,819 - INFO - 成功导入ETF商务协议数据，共339条记录
2025-04-16 08:22:18,819 - INFO - === ETF数据导入完成 ===
2025-04-16 08:22:18,819 - INFO - ETF基本信息: 成功
2025-04-16 08:22:18,819 - INFO - ETF价格数据: 成功
2025-04-16 08:22:18,819 - INFO - ETF持有人数据: 成功
2025-04-16 08:22:18,819 - INFO - ETF自选数据: 成功
2025-04-16 08:22:18,819 - INFO - ETF指数分类数据: 成功
2025-04-16 08:22:18,819 - INFO - ETF商务协议数据: 成功
2025-04-16 08:22:18,820 - INFO - === 数据库记录统计 ===
2025-04-16 08:22:18,820 - INFO - ETF基本信息表: 1136条记录
2025-04-16 08:22:18,820 - INFO - ETF价格数据表: 1136条记录
2025-04-16 08:22:18,820 - INFO - ETF持有人数据表: 1109条记录
2025-04-16 08:22:18,820 - INFO - ETF自选数据表: 1121条记录
2025-04-16 08:22:18,820 - INFO - ETF商务协议数据表: 339条记录
2025-04-18 16:52:32,632 - INFO - === 开始导入所有ETF数据 ===
2025-04-18 16:52:32,637 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-18 16:52:32,637 - INFO - 开始导入ETF基本信息...
2025-04-18 16:52:32,640 - INFO - 使用文件: data/ETF_DATA_20250416.xlsx
2025-04-18 16:52:32,640 - INFO - 从文件名中提取的日期: 2025-04-16
2025-04-18 16:52:35,506 - INFO - 成功导入ETF基本信息，共1137条记录
2025-04-18 16:52:35,506 - INFO - 开始导入ETF价格数据...
2025-04-18 16:52:35,506 - INFO - 使用文件: data/ETF_DATA_20250416.xlsx
2025-04-18 16:52:35,507 - INFO - 从文件名中提取的日期: 2025-04-16
2025-04-18 16:52:36,217 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-18 16:52:36,219 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-18 16:52:36,221 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-18 16:52:36,248 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.7890  ...          -0.0056               -0.4611  2025-04-16  2025-04-18 16:52:36
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3260  ...           0.0000                0.0000  2025-04-16  2025-04-18 16:52:36
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0849  ...           0.0033                0.3471  2025-04-16  2025-04-18 16:52:36
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9425  ...           0.0024                0.2207  2025-04-16  2025-04-18 16:52:36
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.3945  ...          -0.0020               -0.1996  2025-04-16  2025-04-18 16:52:36

[5 rows x 39 columns]
2025-04-18 16:52:36,295 - INFO - 成功导入ETF价格数据，共1137条记录
2025-04-18 16:52:36,297 - INFO - 开始导入ETF持有人数据...
2025-04-18 16:52:36,301 - INFO - 使用文件: data/客户ETF保有量20250416.xlsx
2025-04-18 16:52:36,302 - INFO - 从文件名中提取的日期: 2025-04-16
2025-04-18 16:52:36,527 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-18 16:52:36,542 - INFO - 原始列名: ['数据截止日期']
2025-04-18 16:52:36,542 - INFO - 数据形状: (0, 1)
2025-04-18 16:52:36,543 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-18 16:52:36,543 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-18 16:52:36,700 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-18 16:52:36,709 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-18 16:52:36,712 - INFO - 成功读取数据，形状: (1111, 6)
2025-04-18 16:52:36,716 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-18 16:52:36,723 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250416  159001       货币ETF         54606.0            12   5.460655e+06  2025-04-16
1      None  159003     招商快线ETF          5953.0             5   5.952941e+05  2025-04-16
2      None  159005    汇添富快钱ETF          1300.0            12   1.299987e+05  2025-04-16
3      None  159150  深证50ETF易方达       1766366.0            37   1.932404e+06  2025-04-16
4      None  159201    自由现金流ETF      26256832.0           572   2.478645e+07  2025-04-16
2025-04-18 16:52:36,762 - INFO - 成功导入ETF持有人数据，共1111条记录
2025-04-18 16:52:36,763 - INFO - 开始导入ETF自选数据...
2025-04-18 16:52:36,763 - INFO - 使用文件: data/客户ETF自选人数20250416.xlsx
2025-04-18 16:52:36,763 - INFO - 从文件名中提取的日期: 2025-04-16
2025-04-18 16:52:36,794 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-18 16:52:36,804 - INFO - 原始列名: ['数据截止日期']
2025-04-18 16:52:36,804 - INFO - 数据形状: (0, 1)
2025-04-18 16:52:36,804 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-18 16:52:36,804 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-18 16:52:36,909 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-18 16:52:36,913 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-18 16:52:36,914 - INFO - 成功读取数据，形状: (1123, 3)
2025-04-18 16:52:36,915 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-18 16:52:36,915 - INFO - 找到的代码列: ['标的代码']
2025-04-18 16:52:36,915 - INFO - 找到的自选列: ['加自选人数']
2025-04-18 16:52:36,917 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-18 16:52:36,920 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250416  159001               99  2025-04-16
1      None  159003               98  2025-04-16
2      None  159005               43  2025-04-16
3      None  159150              249  2025-04-16
4      None  159201              902  2025-04-16
2025-04-18 16:52:36,950 - INFO - 成功导入ETF自选数据，共1123条记录
2025-04-18 16:52:36,951 - INFO - 开始导入ETF指数分类数据...
2025-04-18 16:52:36,952 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-18 16:52:37,009 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-18 16:52:37,009 - INFO - 开始导入ETF商务协议数据...
2025-04-18 16:52:37,010 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-18 16:52:37,138 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-18 16:52:37,138 - INFO - === ETF数据导入完成 ===
2025-04-18 16:52:37,138 - INFO - ETF基本信息: 成功
2025-04-18 16:52:37,138 - INFO - ETF价格数据: 成功
2025-04-18 16:52:37,138 - INFO - ETF持有人数据: 成功
2025-04-18 16:52:37,138 - INFO - ETF自选数据: 成功
2025-04-18 16:52:37,138 - INFO - ETF指数分类数据: 成功
2025-04-18 16:52:37,138 - INFO - ETF商务协议数据: 成功
2025-04-18 16:52:37,139 - INFO - === 数据库记录统计 ===
2025-04-18 16:52:37,139 - INFO - ETF基本信息表: 1137条记录
2025-04-18 16:52:37,139 - INFO - ETF价格数据表: 1137条记录
2025-04-18 16:52:37,139 - INFO - ETF持有人数据表: 1111条记录
2025-04-18 16:52:37,139 - INFO - ETF自选数据表: 1123条记录
2025-04-18 16:52:37,139 - INFO - ETF商务协议数据表: 341条记录
2025-04-21 13:08:12,126 - INFO - === 开始导入所有ETF数据 ===
2025-04-21 13:08:12,128 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-21 13:08:12,128 - INFO - 开始导入ETF基本信息...
2025-04-21 13:08:12,130 - INFO - 使用文件: data/ETF_DATA_20250418.xlsx
2025-04-21 13:08:12,131 - INFO - 从文件名中提取的日期: 2025-04-18
2025-04-21 13:08:12,897 - INFO - 成功导入ETF基本信息，共1139条记录
2025-04-21 13:08:12,897 - INFO - 开始导入ETF价格数据...
2025-04-21 13:08:12,898 - INFO - 使用文件: data/ETF_DATA_20250418.xlsx
2025-04-21 13:08:12,898 - INFO - 从文件名中提取的日期: 2025-04-18
2025-04-21 13:08:13,405 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-21 13:08:13,406 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-21 13:08:13,408 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-21 13:08:13,433 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.7973  ...          -0.0015               -0.1228  2025-04-18  2025-04-21 13:08:13
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3342  ...           0.0000                0.0000  2025-04-18  2025-04-21 13:08:13
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0932  ...           0.0049                0.5157  2025-04-18  2025-04-21 13:08:13
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9507  ...          -0.0019               -0.1766  2025-04-18  2025-04-21 13:08:13
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4027  ...          -0.0011               -0.1096  2025-04-18  2025-04-21 13:08:13

[5 rows x 39 columns]
2025-04-21 13:08:13,461 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-21 13:08:13,461 - INFO - 开始导入ETF持有人数据...
2025-04-21 13:08:13,462 - INFO - 使用文件: data/客户ETF保有量20250418.xlsx
2025-04-21 13:08:13,462 - INFO - 从文件名中提取的日期: 2025-04-18
2025-04-21 13:08:13,524 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-21 13:08:13,533 - INFO - 原始列名: ['数据截止日期']
2025-04-21 13:08:13,533 - INFO - 数据形状: (0, 1)
2025-04-21 13:08:13,534 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-21 13:08:13,534 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-21 13:08:13,640 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-21 13:08:13,646 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-21 13:08:13,648 - INFO - 成功读取数据，形状: (1110, 6)
2025-04-21 13:08:13,650 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-21 13:08:13,655 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250418  159001       货币ETF         54806.0            12   5.480655e+06  2025-04-18
1      None  159003     招商快线ETF          5953.0             5   5.953000e+05  2025-04-18
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-04-18
3      None  159150  深证50ETF易方达       1776366.0            37   1.955779e+06  2025-04-18
4      None  159201    自由现金流ETF      26318232.0           577   2.494968e+07  2025-04-18
2025-04-21 13:08:13,690 - INFO - 成功导入ETF持有人数据，共1110条记录
2025-04-21 13:08:13,690 - INFO - 开始导入ETF自选数据...
2025-04-21 13:08:13,691 - INFO - 使用文件: data/客户ETF自选人数20250418.xlsx
2025-04-21 13:08:13,691 - INFO - 从文件名中提取的日期: 2025-04-18
2025-04-21 13:08:13,726 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-21 13:08:13,800 - INFO - 原始列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-21 13:08:13,800 - INFO - 数据形状: (1124, 3)
2025-04-21 13:08:13,803 - INFO - 数据前5行:
       数据截止日期    标的代码  加自选人数
0  20250418.0  159001     99
1         NaN  159003     98
2         NaN  159005     43
3         NaN  159150    249
4         NaN  159201    915
2025-04-21 13:08:13,803 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-21 13:08:13,803 - INFO - 找到的代码列: ['标的代码']
2025-04-21 13:08:13,803 - INFO - 找到的自选列: ['加自选人数']
2025-04-21 13:08:13,804 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-21 13:08:13,808 - INFO - 处理后数据前5行:
       数据截止日期    code  attention_count        date
0  20250418.0  159001               99  2025-04-18
1         NaN  159003               98  2025-04-18
2         NaN  159005               43  2025-04-18
3         NaN  159150              249  2025-04-18
4         NaN  159201              915  2025-04-18
2025-04-21 13:08:13,839 - INFO - 成功导入ETF自选数据，共1124条记录
2025-04-21 13:08:13,839 - INFO - 开始导入ETF指数分类数据...
2025-04-21 13:08:13,839 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-21 13:08:13,889 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-21 13:08:13,889 - INFO - 开始导入ETF商务协议数据...
2025-04-21 13:08:13,890 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-21 13:08:13,987 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-21 13:08:13,987 - INFO - === ETF数据导入完成 ===
2025-04-21 13:08:13,987 - INFO - ETF基本信息: 成功
2025-04-21 13:08:13,987 - INFO - ETF价格数据: 成功
2025-04-21 13:08:13,987 - INFO - ETF持有人数据: 成功
2025-04-21 13:08:13,987 - INFO - ETF自选数据: 成功
2025-04-21 13:08:13,987 - INFO - ETF指数分类数据: 成功
2025-04-21 13:08:13,987 - INFO - ETF商务协议数据: 成功
2025-04-21 13:08:13,988 - INFO - === 数据库记录统计 ===
2025-04-21 13:08:13,988 - INFO - ETF基本信息表: 1139条记录
2025-04-21 13:08:13,988 - INFO - ETF价格数据表: 1139条记录
2025-04-21 13:08:13,988 - INFO - ETF持有人数据表: 1110条记录
2025-04-21 13:08:13,988 - INFO - ETF自选数据表: 1124条记录
2025-04-21 13:08:13,988 - INFO - ETF商务协议数据表: 341条记录
2025-04-23 09:45:04,794 - INFO - === 开始导入所有ETF数据 ===
2025-04-23 09:45:04,797 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-23 09:45:04,797 - INFO - 开始导入ETF基本信息...
2025-04-23 09:45:04,800 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:45:04,800 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:45:05,557 - INFO - 成功导入ETF基本信息，共1139条记录
2025-04-23 09:45:05,557 - INFO - 开始导入ETF价格数据...
2025-04-23 09:45:05,558 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:45:05,558 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:45:06,055 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-23 09:45:06,056 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-23 09:45:06,058 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-23 09:45:06,080 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3397  ...           0.0010                0.0010  2025-04-21  2025-04-23 09:45:06
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0986  ...           0.0060                0.5911  2025-04-21  2025-04-23 09:45:06
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9562  ...           0.0062                0.5421  2025-04-21  2025-04-23 09:45:06
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4082  ...          -0.0005               -0.0497  2025-04-21  2025-04-23 09:45:06
4  159531   中证2000ETF              中证2000指数收益率        1.6274  ...          -0.0022               -0.2123  2025-04-21  2025-04-23 09:45:06

[5 rows x 39 columns]
2025-04-23 09:45:06,115 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-23 09:45:06,115 - INFO - 开始导入ETF持有人数据...
2025-04-23 09:45:06,116 - INFO - 使用文件: data/客户ETF保有量 20250421.xlsx
2025-04-23 09:45:06,116 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:45:06,177 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-23 09:45:06,185 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:45:06,185 - INFO - 数据形状: (0, 1)
2025-04-23 09:45:06,186 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:45:06,186 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:45:06,291 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-23 09:45:06,297 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-23 09:45:06,299 - INFO - 成功读取数据，形状: (1112, 6)
2025-04-23 09:45:06,301 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-23 09:45:06,305 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250421  159001       货币ETF         54706.0            12     5470600.00  2025-04-21
1      None  159003     招商快线ETF          3453.0             5      345300.00  2025-04-21
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-21
3      None  159150  深证50ETF易方达       1776366.0            37     1962884.49  2025-04-21
4      None  159201    自由现金流ETF      25949432.0           575    24755758.08  2025-04-21
2025-04-23 09:45:06,359 - INFO - 成功导入ETF持有人数据，共1112条记录
2025-04-23 09:45:06,359 - INFO - 开始导入ETF自选数据...
2025-04-23 09:45:06,360 - INFO - 使用文件: data/客户ETF自选人数 20250421.xlsx
2025-04-23 09:45:06,360 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:45:06,389 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-23 09:45:06,398 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:45:06,398 - INFO - 数据形状: (0, 1)
2025-04-23 09:45:06,398 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:45:06,398 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:45:06,472 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-23 09:45:06,475 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-23 09:45:06,476 - INFO - 成功读取数据，形状: (1123, 3)
2025-04-23 09:45:06,476 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-23 09:45:06,476 - INFO - 找到的代码列: ['标的代码']
2025-04-23 09:45:06,476 - INFO - 找到的自选列: ['加自选人数']
2025-04-23 09:45:06,478 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-23 09:45:06,482 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250421  159001               99  2025-04-21
1      None  159003               98  2025-04-21
2      None  159005               43  2025-04-21
3      None  159150              248  2025-04-21
4      None  159201              920  2025-04-21
2025-04-23 09:45:06,520 - INFO - 成功导入ETF自选数据，共1123条记录
2025-04-23 09:45:06,520 - INFO - 开始导入ETF指数分类数据...
2025-04-23 09:45:06,520 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-23 09:45:06,573 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-23 09:45:06,573 - INFO - 开始导入ETF商务协议数据...
2025-04-23 09:45:06,573 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-23 09:45:06,674 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-23 09:45:06,674 - INFO - === ETF数据导入完成 ===
2025-04-23 09:45:06,674 - INFO - ETF基本信息: 成功
2025-04-23 09:45:06,674 - INFO - ETF价格数据: 成功
2025-04-23 09:45:06,674 - INFO - ETF持有人数据: 成功
2025-04-23 09:45:06,674 - INFO - ETF自选数据: 成功
2025-04-23 09:45:06,674 - INFO - ETF指数分类数据: 成功
2025-04-23 09:45:06,674 - INFO - ETF商务协议数据: 成功
2025-04-23 09:45:06,675 - INFO - === 数据库记录统计 ===
2025-04-23 09:45:06,675 - INFO - ETF基本信息表: 1139条记录
2025-04-23 09:45:06,675 - INFO - ETF价格数据表: 1139条记录
2025-04-23 09:45:06,675 - INFO - ETF持有人数据表: 1112条记录
2025-04-23 09:45:06,675 - INFO - ETF自选数据表: 1123条记录
2025-04-23 09:45:06,675 - INFO - ETF商务协议数据表: 341条记录
2025-04-23 09:54:43,471 - INFO - === 开始导入所有ETF数据 ===
2025-04-23 09:54:43,474 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-23 09:54:43,474 - INFO - 开始导入ETF基本信息...
2025-04-23 09:54:43,478 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:54:43,478 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:54:46,205 - INFO - 成功导入ETF基本信息，共1139条记录
2025-04-23 09:54:46,205 - INFO - 开始导入ETF价格数据...
2025-04-23 09:54:46,206 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:54:46,206 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:54:46,701 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-23 09:54:46,701 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-23 09:54:46,703 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-23 09:54:46,726 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3397  ...           0.0010                0.0010  2025-04-21  2025-04-23 09:54:46
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0986  ...           0.0060                0.5911  2025-04-21  2025-04-23 09:54:46
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9562  ...           0.0062                0.5421  2025-04-21  2025-04-23 09:54:46
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4082  ...          -0.0005               -0.0497  2025-04-21  2025-04-23 09:54:46
4  159531   中证2000ETF              中证2000指数收益率        1.6274  ...          -0.0022               -0.2123  2025-04-21  2025-04-23 09:54:46

[5 rows x 39 columns]
2025-04-23 09:54:46,759 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-23 09:54:46,759 - INFO - 开始导入ETF持有人数据...
2025-04-23 09:54:46,760 - INFO - 使用文件: data/客户ETF保有量20250421.xlsx
2025-04-23 09:54:46,760 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:54:46,819 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-23 09:54:46,828 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:54:46,828 - INFO - 数据形状: (0, 1)
2025-04-23 09:54:46,829 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:54:46,829 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:54:46,933 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-23 09:54:46,939 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-23 09:54:46,941 - INFO - 成功读取数据，形状: (1112, 6)
2025-04-23 09:54:46,943 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-23 09:54:46,948 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250421  159001       货币ETF         54706.0            12     5470600.00  2025-04-21
1      None  159003     招商快线ETF          3453.0             5      345300.00  2025-04-21
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-21
3      None  159150  深证50ETF易方达       1776366.0            37     1962884.49  2025-04-21
4      None  159201    自由现金流ETF      25949432.0           575    24755758.08  2025-04-21
2025-04-23 09:54:47,006 - INFO - 成功导入ETF持有人数据，共1112条记录
2025-04-23 09:54:47,007 - INFO - 开始导入ETF自选数据...
2025-04-23 09:54:47,007 - INFO - 使用文件: data/客户ETF自选人数20250421.xlsx
2025-04-23 09:54:47,007 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:54:47,037 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-23 09:54:47,046 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:54:47,046 - INFO - 数据形状: (0, 1)
2025-04-23 09:54:47,046 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:54:47,046 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:54:47,121 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-23 09:54:47,125 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-23 09:54:47,125 - INFO - 成功读取数据，形状: (1123, 3)
2025-04-23 09:54:47,126 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-23 09:54:47,126 - INFO - 找到的代码列: ['标的代码']
2025-04-23 09:54:47,126 - INFO - 找到的自选列: ['加自选人数']
2025-04-23 09:54:47,127 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-23 09:54:47,130 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250421  159001               99  2025-04-21
1      None  159003               98  2025-04-21
2      None  159005               43  2025-04-21
3      None  159150              248  2025-04-21
4      None  159201              920  2025-04-21
2025-04-23 09:54:47,170 - INFO - 成功导入ETF自选数据，共1123条记录
2025-04-23 09:54:47,170 - INFO - 开始导入ETF指数分类数据...
2025-04-23 09:54:47,170 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-23 09:54:47,224 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-23 09:54:47,224 - INFO - 开始导入ETF商务协议数据...
2025-04-23 09:54:47,224 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-23 09:54:47,323 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-23 09:54:47,323 - INFO - === ETF数据导入完成 ===
2025-04-23 09:54:47,324 - INFO - ETF基本信息: 成功
2025-04-23 09:54:47,324 - INFO - ETF价格数据: 成功
2025-04-23 09:54:47,324 - INFO - ETF持有人数据: 成功
2025-04-23 09:54:47,324 - INFO - ETF自选数据: 成功
2025-04-23 09:54:47,324 - INFO - ETF指数分类数据: 成功
2025-04-23 09:54:47,324 - INFO - ETF商务协议数据: 成功
2025-04-23 09:54:47,325 - INFO - === 数据库记录统计 ===
2025-04-23 09:54:47,325 - INFO - ETF基本信息表: 1139条记录
2025-04-23 09:54:47,325 - INFO - ETF价格数据表: 1139条记录
2025-04-23 09:54:47,325 - INFO - ETF持有人数据表: 1112条记录
2025-04-23 09:54:47,325 - INFO - ETF自选数据表: 1123条记录
2025-04-23 09:54:47,325 - INFO - ETF商务协议数据表: 341条记录
2025-04-23 09:57:22,590 - INFO - === 开始导入所有ETF数据 ===
2025-04-23 09:57:22,594 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-23 09:57:22,594 - INFO - 开始导入ETF基本信息...
2025-04-23 09:57:22,598 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:57:22,598 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:57:23,354 - INFO - 成功导入ETF基本信息，共1139条记录
2025-04-23 09:57:23,354 - INFO - 开始导入ETF价格数据...
2025-04-23 09:57:23,355 - INFO - 使用文件: data/ETF_DATA_20250421.xlsx
2025-04-23 09:57:23,355 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:57:23,860 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-23 09:57:23,860 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-23 09:57:23,862 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-23 09:57:23,883 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3397  ...           0.0010                0.0010  2025-04-21  2025-04-23 09:57:23
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0986  ...           0.0060                0.5911  2025-04-21  2025-04-23 09:57:23
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9562  ...           0.0062                0.5421  2025-04-21  2025-04-23 09:57:23
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4082  ...          -0.0005               -0.0497  2025-04-21  2025-04-23 09:57:23
4  159531   中证2000ETF              中证2000指数收益率        1.6274  ...          -0.0022               -0.2123  2025-04-21  2025-04-23 09:57:23

[5 rows x 39 columns]
2025-04-23 09:57:23,917 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-23 09:57:23,917 - INFO - 开始导入ETF持有人数据...
2025-04-23 09:57:23,918 - INFO - 使用文件: data/客户ETF保有量20250421.xlsx
2025-04-23 09:57:23,918 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:57:23,980 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-23 09:57:23,990 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:57:23,990 - INFO - 数据形状: (0, 1)
2025-04-23 09:57:23,991 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:57:23,991 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:57:24,099 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-23 09:57:24,105 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-23 09:57:24,106 - INFO - 成功读取数据，形状: (1112, 6)
2025-04-23 09:57:24,109 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-23 09:57:24,114 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250421  159001       货币ETF         54706.0            12     5470600.00  2025-04-21
1      None  159003     招商快线ETF          3453.0             5      345300.00  2025-04-21
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-21
3      None  159150  深证50ETF易方达       1776366.0            37     1962884.49  2025-04-21
4      None  159201    自由现金流ETF      25949432.0           575    24755758.08  2025-04-21
2025-04-23 09:57:24,174 - INFO - 成功导入ETF持有人数据，共1112条记录
2025-04-23 09:57:24,174 - INFO - 开始导入ETF自选数据...
2025-04-23 09:57:24,175 - INFO - 使用文件: data/客户ETF自选人数20250421.xlsx
2025-04-23 09:57:24,175 - INFO - 从文件名中提取的日期: 2025-04-21
2025-04-23 09:57:24,203 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-23 09:57:24,212 - INFO - 原始列名: ['数据截止日期']
2025-04-23 09:57:24,212 - INFO - 数据形状: (0, 1)
2025-04-23 09:57:24,213 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 09:57:24,213 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 09:57:24,293 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-23 09:57:24,297 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-23 09:57:24,298 - INFO - 成功读取数据，形状: (1123, 3)
2025-04-23 09:57:24,298 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-23 09:57:24,298 - INFO - 找到的代码列: ['标的代码']
2025-04-23 09:57:24,298 - INFO - 找到的自选列: ['加自选人数']
2025-04-23 09:57:24,300 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-23 09:57:24,303 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250421  159001               99  2025-04-21
1      None  159003               98  2025-04-21
2      None  159005               43  2025-04-21
3      None  159150              248  2025-04-21
4      None  159201              920  2025-04-21
2025-04-23 09:57:24,345 - INFO - 成功导入ETF自选数据，共1123条记录
2025-04-23 09:57:24,346 - INFO - 开始导入ETF指数分类数据...
2025-04-23 09:57:24,346 - INFO - 使用文件: data/ETF-Index-Classification_20250325.xlsx
2025-04-23 09:57:24,398 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-23 09:57:24,399 - INFO - 开始导入ETF商务协议数据...
2025-04-23 09:57:24,399 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-23 09:57:24,501 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-23 09:57:24,501 - INFO - === ETF数据导入完成 ===
2025-04-23 09:57:24,501 - INFO - ETF基本信息: 成功
2025-04-23 09:57:24,501 - INFO - ETF价格数据: 成功
2025-04-23 09:57:24,501 - INFO - ETF持有人数据: 成功
2025-04-23 09:57:24,501 - INFO - ETF自选数据: 成功
2025-04-23 09:57:24,501 - INFO - ETF指数分类数据: 成功
2025-04-23 09:57:24,501 - INFO - ETF商务协议数据: 成功
2025-04-23 09:57:24,502 - INFO - === 数据库记录统计 ===
2025-04-23 09:57:24,502 - INFO - ETF基本信息表: 1139条记录
2025-04-23 09:57:24,502 - INFO - ETF价格数据表: 1139条记录
2025-04-23 09:57:24,502 - INFO - ETF持有人数据表: 1112条记录
2025-04-23 09:57:24,502 - INFO - ETF自选数据表: 1123条记录
2025-04-23 09:57:24,502 - INFO - ETF商务协议数据表: 341条记录
2025-04-23 10:07:33,983 - INFO - === 开始导入所有ETF数据 ===
2025-04-23 10:07:33,991 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-23 10:07:33,991 - INFO - 开始导入ETF基本信息...
2025-04-23 10:07:33,993 - INFO - 使用文件: data/ETF_DATA_20250422.xlsx
2025-04-23 10:07:33,993 - INFO - 从文件名中提取的日期: 2025-04-22
2025-04-23 10:07:34,788 - INFO - 成功导入ETF基本信息，共1139条记录
2025-04-23 10:07:34,788 - INFO - 开始导入ETF价格数据...
2025-04-23 10:07:34,788 - INFO - 使用文件: data/ETF_DATA_20250422.xlsx
2025-04-23 10:07:34,788 - INFO - 从文件名中提取的日期: 2025-04-22
2025-04-23 10:07:35,295 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-23 10:07:35,295 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-23 10:07:35,297 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-23 10:07:35,319 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3397  ...           0.0010                0.0010  2025-04-22  2025-04-23 10:07:35
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.0986  ...           0.0060                0.5911  2025-04-22  2025-04-23 10:07:35
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9562  ...           0.0062                0.5421  2025-04-22  2025-04-23 10:07:35
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4082  ...          -0.0005               -0.0497  2025-04-22  2025-04-23 10:07:35
4  159531   中证2000ETF              中证2000指数收益率        1.6274  ...          -0.0022               -0.2123  2025-04-22  2025-04-23 10:07:35

[5 rows x 39 columns]
2025-04-23 10:07:35,353 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-23 10:07:35,354 - INFO - 开始导入ETF持有人数据...
2025-04-23 10:07:35,354 - INFO - 使用文件: data/客户ETF保有量20250422.xlsx
2025-04-23 10:07:35,354 - INFO - 从文件名中提取的日期: 2025-04-22
2025-04-23 10:07:35,415 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-23 10:07:35,425 - INFO - 原始列名: ['数据截止日期']
2025-04-23 10:07:35,425 - INFO - 数据形状: (0, 1)
2025-04-23 10:07:35,425 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 10:07:35,425 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 10:07:35,536 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-23 10:07:35,542 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-23 10:07:35,544 - INFO - 成功读取数据，形状: (1116, 6)
2025-04-23 10:07:35,546 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-23 10:07:35,551 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250422  159001       货币ETF         53506.0            11   5.350654e+06  2025-04-22
1      None  159003     招商快线ETF          3453.0             5   3.453035e+05  2025-04-22
2      None  159005    汇添富快钱ETF          1300.0            12   1.300013e+05  2025-04-22
3      None  159150  深证50ETF易方达       1776366.0            37   1.968214e+06  2025-04-22
4      None  159201    自由现金流ETF      25742432.0           575   2.466125e+07  2025-04-22
2025-04-23 10:07:35,614 - INFO - 成功导入ETF持有人数据，共1116条记录
2025-04-23 10:07:35,615 - INFO - 开始导入ETF自选数据...
2025-04-23 10:07:35,616 - INFO - 使用文件: data/客户ETF自选人数20250422.xlsx
2025-04-23 10:07:35,616 - INFO - 从文件名中提取的日期: 2025-04-22
2025-04-23 10:07:35,644 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-23 10:07:35,653 - INFO - 原始列名: ['数据截止日期']
2025-04-23 10:07:35,653 - INFO - 数据形状: (0, 1)
2025-04-23 10:07:35,654 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-23 10:07:35,654 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-23 10:07:35,736 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-23 10:07:35,740 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-23 10:07:35,741 - INFO - 成功读取数据，形状: (1122, 3)
2025-04-23 10:07:35,741 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-23 10:07:35,741 - INFO - 找到的代码列: ['标的代码']
2025-04-23 10:07:35,741 - INFO - 找到的自选列: ['加自选人数']
2025-04-23 10:07:35,743 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-23 10:07:35,746 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250422  159001               98  2025-04-22
1      None  159003               97  2025-04-22
2      None  159005               43  2025-04-22
3      None  159150              248  2025-04-22
4      None  159201              924  2025-04-22
2025-04-23 10:07:35,790 - INFO - 成功导入ETF自选数据，共1122条记录
2025-04-23 10:07:35,790 - INFO - 开始导入ETF指数分类数据...
2025-04-23 10:07:35,791 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-04-23 10:07:35,846 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-23 10:07:35,846 - INFO - 开始导入ETF商务协议数据...
2025-04-23 10:07:35,846 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-23 10:07:35,949 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-23 10:07:35,950 - INFO - === ETF数据导入完成 ===
2025-04-23 10:07:35,950 - INFO - ETF基本信息: 成功
2025-04-23 10:07:35,950 - INFO - ETF价格数据: 成功
2025-04-23 10:07:35,950 - INFO - ETF持有人数据: 成功
2025-04-23 10:07:35,950 - INFO - ETF自选数据: 成功
2025-04-23 10:07:35,950 - INFO - ETF指数分类数据: 成功
2025-04-23 10:07:35,950 - INFO - ETF商务协议数据: 成功
2025-04-23 10:07:35,951 - INFO - === 数据库记录统计 ===
2025-04-23 10:07:35,951 - INFO - ETF基本信息表: 1139条记录
2025-04-23 10:07:35,951 - INFO - ETF价格数据表: 1139条记录
2025-04-23 10:07:35,951 - INFO - ETF持有人数据表: 1116条记录
2025-04-23 10:07:35,951 - INFO - ETF自选数据表: 1122条记录
2025-04-23 10:07:35,951 - INFO - ETF商务协议数据表: 341条记录
2025-04-23 10:09:34,349 - INFO - 开始导入ETF价格数据...
2025-04-23 10:09:34,350 - INFO - 使用文件: data/ETF_DATA_20250422.xlsx
2025-04-23 10:09:34,350 - INFO - 从文件名中提取的日期: 2025-04-22
2025-04-23 10:09:35,040 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-23 10:09:35,041 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-23 10:09:35,047 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-23 10:09:35,077 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)  ...                 0.0010  2025-04-22  2025-04-23 10:09:35
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)  ...                 0.5911  2025-04-22  2025-04-23 10:09:35
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率  ...                 0.5421  2025-04-22  2025-04-23 10:09:35
3  159355  800红利低波ETF          中证800红利低波动指数收益率  ...                -0.0497  2025-04-22  2025-04-23 10:09:35
4  159531   中证2000ETF              中证2000指数收益率  ...                -0.2123  2025-04-22  2025-04-23 10:09:35

[5 rows x 39 columns]
2025-04-23 10:09:35,122 - INFO - 成功导入ETF价格数据，共1139条记录
2025-04-24 14:01:06,069 - INFO - === 开始导入所有ETF数据 ===
2025-04-24 14:01:06,073 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-24 14:01:06,073 - INFO - 开始导入ETF基本信息...
2025-04-24 14:01:06,075 - INFO - 使用文件: data/ETF_DATA_20250423.xlsx
2025-04-24 14:01:06,075 - INFO - 从文件名中提取的日期: 2025-04-23
2025-04-24 14:01:09,267 - INFO - 成功导入ETF基本信息，共1141条记录
2025-04-24 14:01:09,267 - INFO - 开始导入ETF价格数据...
2025-04-24 14:01:09,267 - INFO - 使用文件: data/ETF_DATA_20250423.xlsx
2025-04-24 14:01:09,267 - INFO - 从文件名中提取的日期: 2025-04-23
2025-04-24 14:01:09,757 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-24 14:01:09,757 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-24 14:01:09,759 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-24 14:01:09,780 - INFO - 数据示例:
     code        证券简称  ...        date          update_time
0  563010       电信ETF  ...  2025-04-23  2025-04-24 14:01:09
1  159005    汇添富快钱ETF  ...  2025-04-23  2025-04-24 14:01:09
2  159316    恒生创新药ETF  ...  2025-04-23  2025-04-24 14:01:09
3  159321     黄金股票ETF  ...  2025-04-23  2025-04-24 14:01:09
4  159355  800红利低波ETF  ...  2025-04-23  2025-04-24 14:01:09

[5 rows x 39 columns]
2025-04-24 14:01:09,817 - INFO - 成功导入ETF价格数据，共1141条记录
2025-04-24 14:01:09,817 - INFO - 开始导入ETF持有人数据...
2025-04-24 14:01:09,819 - INFO - 使用文件: data/客户ETF保有量20250423.xlsx
2025-04-24 14:01:09,819 - INFO - 从文件名中提取的日期: 2025-04-23
2025-04-24 14:01:09,878 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-24 14:01:09,887 - INFO - 原始列名: ['数据截止日期']
2025-04-24 14:01:09,887 - INFO - 数据形状: (0, 1)
2025-04-24 14:01:09,888 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-24 14:01:09,888 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-24 14:01:09,998 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-24 14:01:10,003 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-24 14:01:10,006 - INFO - 成功读取数据，形状: (1117, 6)
2025-04-24 14:01:10,008 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-24 14:01:10,014 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250423  159001       货币ETF         53306.0            11     5330600.00  2025-04-23
1      None  159003     招商快线ETF          3453.0             5      345300.00  2025-04-23
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-04-23
3      None  159150  深证50ETF易方达       1773366.0            37     1977303.15  2025-04-23
4      None  159201    自由现金流ETF      25622932.0           576    24598014.72  2025-04-23
2025-04-24 14:01:10,076 - INFO - 成功导入ETF持有人数据，共1117条记录
2025-04-24 14:01:10,076 - INFO - 开始导入ETF自选数据...
2025-04-24 14:01:10,077 - INFO - 使用文件: data/客户ETF自选人数20250423.xlsx
2025-04-24 14:01:10,077 - INFO - 从文件名中提取的日期: 2025-04-23
2025-04-24 14:01:10,106 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-24 14:01:10,114 - INFO - 原始列名: ['数据截止日期']
2025-04-24 14:01:10,114 - INFO - 数据形状: (0, 1)
2025-04-24 14:01:10,115 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-24 14:01:10,115 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-24 14:01:10,191 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-24 14:01:10,194 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-24 14:01:10,195 - INFO - 成功读取数据，形状: (1123, 3)
2025-04-24 14:01:10,195 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-24 14:01:10,195 - INFO - 找到的代码列: ['标的代码']
2025-04-24 14:01:10,195 - INFO - 找到的自选列: ['加自选人数']
2025-04-24 14:01:10,197 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-24 14:01:10,200 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250423  159001               98  2025-04-23
1      None  159003               97  2025-04-23
2      None  159005               43  2025-04-23
3      None  159150              248  2025-04-23
4      None  159201              921  2025-04-23
2025-04-24 14:01:10,242 - INFO - 成功导入ETF自选数据，共1123条记录
2025-04-24 14:01:10,242 - INFO - 开始导入ETF指数分类数据...
2025-04-24 14:01:10,243 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-04-24 14:01:10,294 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-24 14:01:10,295 - INFO - 开始导入ETF商务协议数据...
2025-04-24 14:01:10,295 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-24 14:01:10,395 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-24 14:01:10,395 - INFO - === ETF数据导入完成 ===
2025-04-24 14:01:10,395 - INFO - ETF基本信息: 成功
2025-04-24 14:01:10,395 - INFO - ETF价格数据: 成功
2025-04-24 14:01:10,395 - INFO - ETF持有人数据: 成功
2025-04-24 14:01:10,395 - INFO - ETF自选数据: 成功
2025-04-24 14:01:10,395 - INFO - ETF指数分类数据: 成功
2025-04-24 14:01:10,395 - INFO - ETF商务协议数据: 成功
2025-04-24 14:01:10,396 - INFO - === 数据库记录统计 ===
2025-04-24 14:01:10,396 - INFO - ETF基本信息表: 1141条记录
2025-04-24 14:01:10,396 - INFO - ETF价格数据表: 1141条记录
2025-04-24 14:01:10,396 - INFO - ETF持有人数据表: 1117条记录
2025-04-24 14:01:10,396 - INFO - ETF自选数据表: 1123条记录
2025-04-24 14:01:10,397 - INFO - ETF商务协议数据表: 341条记录
2025-04-28 13:09:46,475 - INFO - 开始导入ETF商务协议数据...
2025-04-28 13:09:46,477 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-28 13:09:46,711 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-28 13:13:10,742 - INFO - === 开始导入所有ETF数据 ===
2025-04-28 13:13:10,745 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-04-28 13:13:10,746 - INFO - 开始导入ETF基本信息...
2025-04-28 13:13:10,755 - INFO - 使用文件: data/ETF_DATA_20250425.xlsx
2025-04-28 13:13:10,756 - INFO - 从文件名中提取的日期: 2025-04-25
2025-04-28 13:13:13,541 - INFO - 成功导入ETF基本信息，共1147条记录
2025-04-28 13:13:13,542 - INFO - 开始导入ETF价格数据...
2025-04-28 13:13:13,542 - INFO - 使用文件: data/ETF_DATA_20250425.xlsx
2025-04-28 13:13:13,542 - INFO - 从文件名中提取的日期: 2025-04-25
2025-04-28 13:13:14,045 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-04-28 13:13:14,046 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-04-28 13:13:14,047 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-04-28 13:13:14,070 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.8164  ...          -0.0004               -0.0329  2025-04-25  2025-04-28 13:13:14
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3534  ...          -0.0010               -0.0010  2025-04-25  2025-04-28 13:13:14
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1123  ...           0.0112                1.0699  2025-04-25  2025-04-28 13:13:14
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9699  ...           0.0018                0.1703  2025-04-25  2025-04-28 13:13:14
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4219  ...          -0.0016               -0.1590  2025-04-25  2025-04-28 13:13:14

[5 rows x 39 columns]
2025-04-28 13:13:14,103 - INFO - 成功导入ETF价格数据，共1147条记录
2025-04-28 13:13:14,103 - INFO - 开始导入ETF持有人数据...
2025-04-28 13:13:14,104 - INFO - 使用文件: data/客户ETF保有量20250425.xlsx
2025-04-28 13:13:14,104 - INFO - 从文件名中提取的日期: 2025-04-25
2025-04-28 13:13:14,163 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-04-28 13:13:14,172 - INFO - 原始列名: ['数据截止日期']
2025-04-28 13:13:14,172 - INFO - 数据形状: (0, 1)
2025-04-28 13:13:14,172 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-28 13:13:14,172 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-28 13:13:14,281 - INFO - 尝试读取工作表: 客户ETF保有量
2025-04-28 13:13:14,287 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-04-28 13:13:14,289 - INFO - 成功读取数据，形状: (1118, 6)
2025-04-28 13:13:14,291 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-04-28 13:13:14,295 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250425  159001       货币ETF         53207.0            11     5320700.00  2025-04-25
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-25
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-04-25
3      None  159150  深证50ETF易方达       1773366.0            37     1980849.85  2025-04-25
4      None  159201    自由现金流ETF      25247409.0           568    24313254.85  2025-04-25
2025-04-28 13:13:14,346 - INFO - 成功导入ETF持有人数据，共1118条记录
2025-04-28 13:13:14,347 - INFO - 开始导入ETF自选数据...
2025-04-28 13:13:14,347 - INFO - 使用文件: data/客户ETF自选人数20250425.xlsx
2025-04-28 13:13:14,347 - INFO - 从文件名中提取的日期: 2025-04-25
2025-04-28 13:13:14,374 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-04-28 13:13:14,383 - INFO - 原始列名: ['数据截止日期']
2025-04-28 13:13:14,383 - INFO - 数据形状: (0, 1)
2025-04-28 13:13:14,383 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-04-28 13:13:14,383 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-04-28 13:13:14,460 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-04-28 13:13:14,464 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-04-28 13:13:14,465 - INFO - 成功读取数据，形状: (1129, 3)
2025-04-28 13:13:14,465 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-04-28 13:13:14,465 - INFO - 找到的代码列: ['标的代码']
2025-04-28 13:13:14,465 - INFO - 找到的自选列: ['加自选人数']
2025-04-28 13:13:14,467 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-04-28 13:13:14,470 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250425  159001              100  2025-04-25
1      None  159003               97  2025-04-25
2      None  159005               43  2025-04-25
3      None  159150              247  2025-04-25
4      None  159201              935  2025-04-25
2025-04-28 13:13:14,511 - INFO - 成功导入ETF自选数据，共1129条记录
2025-04-28 13:13:14,511 - INFO - 开始导入ETF指数分类数据...
2025-04-28 13:13:14,511 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-04-28 13:13:14,561 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-04-28 13:13:14,561 - INFO - 开始导入ETF商务协议数据...
2025-04-28 13:13:14,562 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-04-28 13:13:14,660 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-04-28 13:13:14,660 - INFO - === ETF数据导入完成 ===
2025-04-28 13:13:14,660 - INFO - ETF基本信息: 成功
2025-04-28 13:13:14,661 - INFO - ETF价格数据: 成功
2025-04-28 13:13:14,661 - INFO - ETF持有人数据: 成功
2025-04-28 13:13:14,661 - INFO - ETF自选数据: 成功
2025-04-28 13:13:14,661 - INFO - ETF指数分类数据: 成功
2025-04-28 13:13:14,661 - INFO - ETF商务协议数据: 成功
2025-04-28 13:13:14,661 - INFO - === 数据库记录统计 ===
2025-04-28 13:13:14,661 - INFO - ETF基本信息表: 1147条记录
2025-04-28 13:13:14,661 - INFO - ETF价格数据表: 1147条记录
2025-04-28 13:13:14,661 - INFO - ETF持有人数据表: 1118条记录
2025-04-28 13:13:14,661 - INFO - ETF自选数据表: 1129条记录
2025-04-28 13:13:14,661 - INFO - ETF商务协议数据表: 341条记录
2025-05-01 20:05:22,457 - INFO - === 开始导入所有ETF数据 ===
2025-05-01 20:05:22,460 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-01 20:05:22,460 - INFO - 开始导入ETF基本信息...
2025-05-01 20:05:22,462 - INFO - 使用文件: data/ETF_DATA_20250429.xlsx
2025-05-01 20:05:22,462 - INFO - 从文件名中提取的日期: 2025-04-29
2025-05-01 20:05:23,216 - INFO - 成功导入ETF基本信息，共1148条记录
2025-05-01 20:05:23,217 - INFO - 开始导入ETF价格数据...
2025-05-01 20:05:23,217 - INFO - 使用文件: data/ETF_DATA_20250429.xlsx
2025-05-01 20:05:23,217 - INFO - 从文件名中提取的日期: 2025-04-29
2025-05-01 20:05:23,744 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-01 20:05:23,745 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-01 20:05:23,747 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-01 20:05:23,774 - INFO - 数据示例:
     code        证券简称  ...        date          update_time
0  159005    汇添富快钱ETF  ...  2025-04-29  2025-05-01 20:05:23
1  159316    恒生创新药ETF  ...  2025-04-29  2025-05-01 20:05:23
2  159321     黄金股票ETF  ...  2025-04-29  2025-05-01 20:05:23
3  159355  800红利低波ETF  ...  2025-04-29  2025-05-01 20:05:23
4  159531   中证2000ETF  ...  2025-04-29  2025-05-01 20:05:23

[5 rows x 39 columns]
2025-05-01 20:05:23,810 - INFO - 成功导入ETF价格数据，共1148条记录
2025-05-01 20:05:23,810 - INFO - 开始导入ETF持有人数据...
2025-05-01 20:05:23,811 - INFO - 使用文件: data/客户ETF保有量20250429.xlsx
2025-05-01 20:05:23,811 - INFO - 从文件名中提取的日期: 2025-04-29
2025-05-01 20:05:23,872 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-01 20:05:23,880 - INFO - 原始列名: ['数据截止日期']
2025-05-01 20:05:23,880 - INFO - 数据形状: (0, 1)
2025-05-01 20:05:23,881 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-01 20:05:23,881 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-01 20:05:23,990 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-01 20:05:23,995 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-01 20:05:23,997 - INFO - 成功读取数据，形状: (1122, 6)
2025-05-01 20:05:23,999 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-01 20:05:24,006 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  ...  holder_count  holding_value        date
0  20250429  159001       货币ETF  ...            11     7900400.00  2025-04-29
1      None  159003     招商快线ETF  ...             4       85295.74  2025-04-29
2      None  159005    汇添富快钱ETF  ...            12      129993.50  2025-04-29
3      None  159150  深证50ETF易方达  ...            37     1968436.26  2025-04-29
4      None  159201    自由现金流ETF  ...           565    24390344.64  2025-04-29

[5 rows x 7 columns]
2025-05-01 20:05:24,075 - INFO - 成功导入ETF持有人数据，共1122条记录
2025-05-01 20:05:24,075 - INFO - 开始导入ETF自选数据...
2025-05-01 20:05:24,075 - INFO - 使用文件: data/客户ETF自选人数20250429.xlsx
2025-05-01 20:05:24,076 - INFO - 从文件名中提取的日期: 2025-04-29
2025-05-01 20:05:24,103 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-01 20:05:24,112 - INFO - 原始列名: ['数据截止日期']
2025-05-01 20:05:24,112 - INFO - 数据形状: (0, 1)
2025-05-01 20:05:24,112 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-01 20:05:24,112 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-01 20:05:24,194 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-01 20:05:24,216 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-01 20:05:24,217 - INFO - 成功读取数据，形状: (1131, 3)
2025-05-01 20:05:24,218 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-01 20:05:24,218 - INFO - 找到的代码列: ['标的代码']
2025-05-01 20:05:24,218 - INFO - 找到的自选列: ['加自选人数']
2025-05-01 20:05:24,227 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-01 20:05:24,230 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250429  159001              103  2025-04-29
1      None  159003               98  2025-04-29
2      None  159005               45  2025-04-29
3      None  159150              246  2025-04-29
4      None  159201              932  2025-04-29
2025-05-01 20:05:24,279 - INFO - 成功导入ETF自选数据，共1131条记录
2025-05-01 20:05:24,279 - INFO - 开始导入ETF指数分类数据...
2025-05-01 20:05:24,279 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-01 20:05:24,330 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-01 20:05:24,330 - INFO - 开始导入ETF商务协议数据...
2025-05-01 20:05:24,330 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-01 20:05:24,428 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-01 20:05:24,428 - INFO - === ETF数据导入完成 ===
2025-05-01 20:05:24,429 - INFO - ETF基本信息: 成功
2025-05-01 20:05:24,429 - INFO - ETF价格数据: 成功
2025-05-01 20:05:24,429 - INFO - ETF持有人数据: 成功
2025-05-01 20:05:24,429 - INFO - ETF自选数据: 成功
2025-05-01 20:05:24,429 - INFO - ETF指数分类数据: 成功
2025-05-01 20:05:24,429 - INFO - ETF商务协议数据: 成功
2025-05-01 20:05:24,429 - INFO - === 数据库记录统计 ===
2025-05-01 20:05:24,429 - INFO - ETF基本信息表: 1148条记录
2025-05-01 20:05:24,429 - INFO - ETF价格数据表: 1148条记录
2025-05-01 20:05:24,429 - INFO - ETF持有人数据表: 1122条记录
2025-05-01 20:05:24,429 - INFO - ETF自选数据表: 1131条记录
2025-05-01 20:05:24,429 - INFO - ETF商务协议数据表: 341条记录
2025-05-06 08:51:10,903 - INFO - === 开始导入所有ETF数据 ===
2025-05-06 08:51:10,905 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-06 08:51:10,905 - INFO - 开始导入ETF基本信息...
2025-05-06 08:51:10,906 - INFO - 使用文件: data/ETF_DATA_20250430.xlsx
2025-05-06 08:51:10,907 - INFO - 从文件名中提取的日期: 2025-04-30
2025-05-06 08:51:11,652 - INFO - 成功导入ETF基本信息，共1123条记录
2025-05-06 08:51:11,652 - INFO - 开始导入ETF价格数据...
2025-05-06 08:51:11,653 - INFO - 使用文件: data/ETF_DATA_20250430.xlsx
2025-05-06 08:51:11,653 - INFO - 从文件名中提取的日期: 2025-04-30
2025-05-06 08:51:12,137 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-06 08:51:12,138 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-06 08:51:12,140 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-06 08:51:12,163 - INFO - 数据示例:
     code         证券简称                     业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF                 活期存款利率(税后)       10.3753  ...           0.0010                0.0010  2025-04-30  2025-05-06 08:51:12
1  159321      黄金股票ETF           中证沪深港黄金产业股票指数收益率        0.9918  ...           0.0006                0.0572  2025-04-30  2025-05-06 08:51:12
2  159597  创业板成长ETF易方达                 创业板成长指数收益率        0.9945  ...           0.0003                0.0276  2025-04-30  2025-05-06 08:51:12
3  159788    港股通100ETF  中证港股通中国100指数收益率(使用估值汇率折算)        3.2027  ...          -0.0051               -0.4232  2025-04-30  2025-05-06 08:51:12
4  159797    医疗器械ETF基金              中证全指医疗器械指数收益率        3.0247  ...          -0.0004               -0.0565  2025-04-30  2025-05-06 08:51:12

[5 rows x 39 columns]
2025-05-06 08:51:12,196 - INFO - 成功导入ETF价格数据，共1123条记录
2025-05-06 08:51:12,196 - INFO - 开始导入ETF持有人数据...
2025-05-06 08:51:12,197 - INFO - 使用文件: data/客户ETF保有量 20250430.xlsx
2025-05-06 08:51:12,197 - INFO - 从文件名中提取的日期: 2025-04-30
2025-05-06 08:51:12,260 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-06 08:51:12,269 - INFO - 原始列名: ['数据截止日期']
2025-05-06 08:51:12,269 - INFO - 数据形状: (0, 1)
2025-05-06 08:51:12,269 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-06 08:51:12,270 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-06 08:51:12,406 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-06 08:51:12,411 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-06 08:51:12,413 - INFO - 成功读取数据，形状: (1121, 6)
2025-05-06 08:51:12,416 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-06 08:51:12,421 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250430  159001       货币ETF         89204.0            13     8920400.00  2025-04-30
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-04-30
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-04-30
3      None  159150  深证50ETF易方达       1768366.0            37     1971728.15  2025-04-30
4      None  159201    自由现金流ETF      24842003.0           562    23773796.90  2025-04-30
2025-05-06 08:51:12,480 - INFO - 成功导入ETF持有人数据，共1121条记录
2025-05-06 08:51:12,481 - INFO - 开始导入ETF自选数据...
2025-05-06 08:51:12,481 - INFO - 使用文件: data/客户ETF自选人数 20250430.xlsx
2025-05-06 08:51:12,481 - INFO - 从文件名中提取的日期: 2025-04-30
2025-05-06 08:51:12,511 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-06 08:51:12,519 - INFO - 原始列名: ['数据截止日期']
2025-05-06 08:51:12,520 - INFO - 数据形状: (0, 1)
2025-05-06 08:51:12,520 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-06 08:51:12,520 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-06 08:51:12,580 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-06 08:51:12,584 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-06 08:51:12,585 - INFO - 成功读取数据，形状: (1133, 3)
2025-05-06 08:51:12,585 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-06 08:51:12,585 - INFO - 找到的代码列: ['标的代码']
2025-05-06 08:51:12,585 - INFO - 找到的自选列: ['加自选人数']
2025-05-06 08:51:12,587 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-06 08:51:12,590 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250430  159001              104  2025-04-30
1      None  159003               99  2025-04-30
2      None  159005               45  2025-04-30
3      None  159150              246  2025-04-30
4      None  159201              928  2025-04-30
2025-05-06 08:51:12,632 - INFO - 成功导入ETF自选数据，共1133条记录
2025-05-06 08:51:12,632 - INFO - 开始导入ETF指数分类数据...
2025-05-06 08:51:12,633 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-06 08:51:12,686 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-06 08:51:12,687 - INFO - 开始导入ETF商务协议数据...
2025-05-06 08:51:12,687 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-06 08:51:12,800 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-06 08:51:12,800 - INFO - === ETF数据导入完成 ===
2025-05-06 08:51:12,800 - INFO - ETF基本信息: 成功
2025-05-06 08:51:12,800 - INFO - ETF价格数据: 成功
2025-05-06 08:51:12,801 - INFO - ETF持有人数据: 成功
2025-05-06 08:51:12,801 - INFO - ETF自选数据: 成功
2025-05-06 08:51:12,801 - INFO - ETF指数分类数据: 成功
2025-05-06 08:51:12,801 - INFO - ETF商务协议数据: 成功
2025-05-06 08:51:12,802 - INFO - === 数据库记录统计 ===
2025-05-06 08:51:12,802 - INFO - ETF基本信息表: 1123条记录
2025-05-06 08:51:12,802 - INFO - ETF价格数据表: 1123条记录
2025-05-06 08:51:12,802 - INFO - ETF持有人数据表: 1121条记录
2025-05-06 08:51:12,802 - INFO - ETF自选数据表: 1133条记录
2025-05-06 08:51:12,802 - INFO - ETF商务协议数据表: 341条记录
2025-05-07 08:18:07,479 - INFO - === 开始导入所有ETF数据 ===
2025-05-07 08:18:07,485 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-07 08:18:07,486 - INFO - 开始导入ETF基本信息...
2025-05-07 08:18:07,488 - INFO - 使用文件: data/ETF_DATA_20250506.xlsx
2025-05-07 08:18:07,489 - INFO - 从文件名中提取的日期: 2025-05-06
2025-05-07 08:18:08,250 - INFO - 成功导入ETF基本信息，共1150条记录
2025-05-07 08:18:08,250 - INFO - 开始导入ETF价格数据...
2025-05-07 08:18:08,250 - INFO - 使用文件: data/ETF_DATA_20250506.xlsx
2025-05-07 08:18:08,250 - INFO - 从文件名中提取的日期: 2025-05-06
2025-05-07 08:18:08,745 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-07 08:18:08,746 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-07 08:18:08,748 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-07 08:18:08,770 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年  ... premium_discount premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3781  ...          -0.0010               -0.0010  2025-05-06  2025-05-07 08:18:08
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1370  ...           0.0041                0.3946  2025-05-06  2025-05-07 08:18:08
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9945  ...          -0.0019               -0.1761  2025-05-06  2025-05-07 08:18:08
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4466  ...          -0.0033               -0.3292  2025-05-06  2025-05-07 08:18:08
4  159531   中证2000ETF              中证2000指数收益率        1.6658  ...           0.0029                0.2675  2025-05-06  2025-05-07 08:18:08

[5 rows x 39 columns]
2025-05-07 08:18:08,807 - INFO - 成功导入ETF价格数据，共1150条记录
2025-05-07 08:18:08,808 - INFO - 开始导入ETF持有人数据...
2025-05-07 08:18:08,808 - INFO - 使用文件: data/客户ETF保有量20250506.xlsx
2025-05-07 08:18:08,809 - INFO - 从文件名中提取的日期: 2025-05-06
2025-05-07 08:18:08,872 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-07 08:18:08,881 - INFO - 原始列名: ['数据截止日期']
2025-05-07 08:18:08,881 - INFO - 数据形状: (0, 1)
2025-05-07 08:18:08,882 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-07 08:18:08,882 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-07 08:18:08,988 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-07 08:18:08,994 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-07 08:18:08,996 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-07 08:18:08,998 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-07 08:18:09,004 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250506  159001       货币ETF         84004.0            12     8400400.00  2025-05-06
1      None  159003     招商快线ETF           853.0             4       85299.15  2025-05-06
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-05-06
3      None  159150  深证50ETF易方达       1663860.0            36     1878497.95  2025-05-06
4      None  159201    自由现金流ETF      24550703.0           566    23765080.52  2025-05-06
2025-05-07 08:18:09,074 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-07 08:18:09,074 - INFO - 开始导入ETF自选数据...
2025-05-07 08:18:09,075 - INFO - 使用文件: data/客户ETF自选人数20250506.xlsx
2025-05-07 08:18:09,075 - INFO - 从文件名中提取的日期: 2025-05-06
2025-05-07 08:18:09,102 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-07 08:18:09,111 - INFO - 原始列名: ['数据截止日期']
2025-05-07 08:18:09,111 - INFO - 数据形状: (0, 1)
2025-05-07 08:18:09,112 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-07 08:18:09,112 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-07 08:18:09,186 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-07 08:18:09,190 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-07 08:18:09,191 - INFO - 成功读取数据，形状: (1133, 3)
2025-05-07 08:18:09,191 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-07 08:18:09,191 - INFO - 找到的代码列: ['标的代码']
2025-05-07 08:18:09,191 - INFO - 找到的自选列: ['加自选人数']
2025-05-07 08:18:09,192 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-07 08:18:09,196 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250506  159001              102  2025-05-06
1      None  159003               98  2025-05-06
2      None  159005               45  2025-05-06
3      None  159150              246  2025-05-06
4      None  159201              923  2025-05-06
2025-05-07 08:18:09,240 - INFO - 成功导入ETF自选数据，共1133条记录
2025-05-07 08:18:09,241 - INFO - 开始导入ETF指数分类数据...
2025-05-07 08:18:09,241 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-07 08:18:09,292 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-07 08:18:09,292 - INFO - 开始导入ETF商务协议数据...
2025-05-07 08:18:09,292 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-07 08:18:09,391 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-07 08:18:09,391 - INFO - === ETF数据导入完成 ===
2025-05-07 08:18:09,391 - INFO - ETF基本信息: 成功
2025-05-07 08:18:09,391 - INFO - ETF价格数据: 成功
2025-05-07 08:18:09,391 - INFO - ETF持有人数据: 成功
2025-05-07 08:18:09,391 - INFO - ETF自选数据: 成功
2025-05-07 08:18:09,391 - INFO - ETF指数分类数据: 成功
2025-05-07 08:18:09,391 - INFO - ETF商务协议数据: 成功
2025-05-07 08:18:09,392 - INFO - === 数据库记录统计 ===
2025-05-07 08:18:09,392 - INFO - ETF基本信息表: 1150条记录
2025-05-07 08:18:09,392 - INFO - ETF价格数据表: 1150条记录
2025-05-07 08:18:09,392 - INFO - ETF持有人数据表: 1124条记录
2025-05-07 08:18:09,392 - INFO - ETF自选数据表: 1133条记录
2025-05-07 08:18:09,392 - INFO - ETF商务协议数据表: 341条记录
2025-05-08 08:32:41,134 - INFO - === 开始导入所有ETF数据 ===
2025-05-08 08:32:41,137 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-08 08:32:41,138 - INFO - 开始导入ETF基本信息...
2025-05-08 08:32:41,140 - INFO - 使用文件: data/ETF_DATA_20250507.xlsx
2025-05-08 08:32:41,140 - INFO - 从文件名中提取的日期: 2025-05-07
2025-05-08 08:32:44,161 - INFO - 成功导入ETF基本信息，共1153条记录
2025-05-08 08:32:44,161 - INFO - 开始导入ETF价格数据...
2025-05-08 08:32:44,162 - INFO - 使用文件: data/ETF_DATA_20250507.xlsx
2025-05-08 08:32:44,162 - INFO - 从文件名中提取的日期: 2025-05-07
2025-05-08 08:32:44,678 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-08 08:32:44,679 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-08 08:32:44,681 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-08 08:32:44,704 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.8438  上海证券交易所  ...    1.6867          -0.0019                -0.1519  2025-05-07  2025-05-08 08:32:44
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3808  深圳证券交易所  ...    0.0020          -0.0010                -0.0010  2025-05-07  2025-05-08 08:32:44
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1397  深圳证券交易所  ...    4.7939           0.0049                 0.4895  2025-05-07  2025-05-08 08:32:44
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        0.9973  深圳证券交易所  ...    1.9499           0.0016                 0.1477  2025-05-07  2025-05-08 08:32:44
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4493  深圳证券交易所  ...    0.6006          -0.0033                -0.3266  2025-05-07  2025-05-08 08:32:44

[5 rows x 39 columns]
2025-05-08 08:32:44,740 - INFO - 成功导入ETF价格数据，共1153条记录
2025-05-08 08:32:44,740 - INFO - 开始导入ETF持有人数据...
2025-05-08 08:32:44,741 - INFO - 使用文件: data/客户ETF保有量20250507.xlsx
2025-05-08 08:32:44,741 - INFO - 从文件名中提取的日期: 2025-05-07
2025-05-08 08:32:44,807 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-08 08:32:44,816 - INFO - 原始列名: ['数据截止日期']
2025-05-08 08:32:44,816 - INFO - 数据形状: (0, 1)
2025-05-08 08:32:44,817 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-08 08:32:44,817 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-08 08:32:44,933 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-08 08:32:44,940 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-08 08:32:44,942 - INFO - 成功读取数据，形状: (1123, 6)
2025-05-08 08:32:44,944 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-08 08:32:44,951 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250507  159001       货币ETF         79304.0            11     7930400.00  2025-05-07
1      None  159003     招商快线ETF           853.0             4       85299.15  2025-05-07
2      None  159005    汇添富快钱ETF          1300.0            12      129998.70  2025-05-07
3      None  159150  深证50ETF易方达       1662760.0            36     1883907.05  2025-05-07
4      None  159201    自由现金流ETF      24557003.0           560    23943077.99  2025-05-07
2025-05-08 08:32:45,022 - INFO - 成功导入ETF持有人数据，共1123条记录
2025-05-08 08:32:45,022 - INFO - 开始导入ETF自选数据...
2025-05-08 08:32:45,023 - INFO - 使用文件: data/客户ETF自选人数20250507.xlsx
2025-05-08 08:32:45,023 - INFO - 从文件名中提取的日期: 2025-05-07
2025-05-08 08:32:45,051 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-08 08:32:45,075 - INFO - 原始列名: ['数据截止日期']
2025-05-08 08:32:45,076 - INFO - 数据形状: (0, 1)
2025-05-08 08:32:45,076 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-08 08:32:45,076 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-08 08:32:45,135 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-08 08:32:45,138 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-08 08:32:45,139 - INFO - 成功读取数据，形状: (1136, 3)
2025-05-08 08:32:45,139 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-08 08:32:45,139 - INFO - 找到的代码列: ['标的代码']
2025-05-08 08:32:45,139 - INFO - 找到的自选列: ['加自选人数']
2025-05-08 08:32:45,141 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-08 08:32:45,145 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250507  159001              102  2025-05-07
1      None  159003               98  2025-05-07
2      None  159005               45  2025-05-07
3      None  159150              246  2025-05-07
4      None  159201              926  2025-05-07
2025-05-08 08:32:45,194 - INFO - 成功导入ETF自选数据，共1136条记录
2025-05-08 08:32:45,194 - INFO - 开始导入ETF指数分类数据...
2025-05-08 08:32:45,195 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-08 08:32:45,248 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-08 08:32:45,248 - INFO - 开始导入ETF商务协议数据...
2025-05-08 08:32:45,248 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-08 08:32:45,350 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-08 08:32:45,351 - INFO - === ETF数据导入完成 ===
2025-05-08 08:32:45,351 - INFO - ETF基本信息: 成功
2025-05-08 08:32:45,351 - INFO - ETF价格数据: 成功
2025-05-08 08:32:45,351 - INFO - ETF持有人数据: 成功
2025-05-08 08:32:45,351 - INFO - ETF自选数据: 成功
2025-05-08 08:32:45,351 - INFO - ETF指数分类数据: 成功
2025-05-08 08:32:45,351 - INFO - ETF商务协议数据: 成功
2025-05-08 08:32:45,352 - INFO - === 数据库记录统计 ===
2025-05-08 08:32:45,352 - INFO - ETF基本信息表: 1153条记录
2025-05-08 08:32:45,352 - INFO - ETF价格数据表: 1153条记录
2025-05-08 08:32:45,352 - INFO - ETF持有人数据表: 1123条记录
2025-05-08 08:32:45,352 - INFO - ETF自选数据表: 1136条记录
2025-05-08 08:32:45,352 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 08:40:58,556 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 08:40:58,561 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 08:40:58,561 - INFO - 开始导入ETF基本信息...
2025-05-09 08:40:58,564 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 08:40:58,564 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 08:40:59,377 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 08:40:59,377 - INFO - 开始导入ETF价格数据...
2025-05-09 08:40:59,377 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 08:40:59,377 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 08:40:59,886 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 08:40:59,886 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 08:40:59,888 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 08:40:59,909 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 08:40:59
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 08:40:59
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 08:40:59
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 08:40:59
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 08:40:59

[5 rows x 39 columns]
2025-05-09 08:40:59,947 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 08:40:59,948 - INFO - 开始导入ETF持有人数据...
2025-05-09 08:40:59,949 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 08:40:59,949 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 08:41:00,014 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 08:41:00,023 - INFO - 原始列名: ['数据截止日期']
2025-05-09 08:41:00,023 - INFO - 数据形状: (0, 1)
2025-05-09 08:41:00,024 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 08:41:00,024 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 08:41:00,161 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 08:41:00,167 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 08:41:00,169 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 08:41:00,171 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 08:41:00,176 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 08:41:00,243 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 08:41:00,244 - INFO - 开始导入ETF自选数据...
2025-05-09 08:41:00,244 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 08:41:00,244 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 08:41:00,274 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 08:41:00,300 - INFO - 原始列名: ['数据截止日期']
2025-05-09 08:41:00,300 - INFO - 数据形状: (0, 1)
2025-05-09 08:41:00,301 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 08:41:00,301 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 08:41:00,359 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 08:41:00,363 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 08:41:00,364 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 08:41:00,364 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 08:41:00,364 - INFO - 找到的代码列: ['标的代码']
2025-05-09 08:41:00,364 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 08:41:00,366 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 08:41:00,369 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 08:41:00,422 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 08:41:00,422 - INFO - 开始导入ETF指数分类数据...
2025-05-09 08:41:00,423 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 08:41:00,475 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 08:41:00,476 - INFO - 开始导入ETF商务协议数据...
2025-05-09 08:41:00,476 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 08:41:00,578 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 08:41:00,579 - INFO - === ETF数据导入完成 ===
2025-05-09 08:41:00,579 - INFO - ETF基本信息: 成功
2025-05-09 08:41:00,579 - INFO - ETF价格数据: 成功
2025-05-09 08:41:00,579 - INFO - ETF持有人数据: 成功
2025-05-09 08:41:00,579 - INFO - ETF自选数据: 成功
2025-05-09 08:41:00,579 - INFO - ETF指数分类数据: 成功
2025-05-09 08:41:00,579 - INFO - ETF商务协议数据: 成功
2025-05-09 08:41:00,580 - INFO - === 数据库记录统计 ===
2025-05-09 08:41:00,580 - INFO - ETF基本信息表: 1156条记录
2025-05-09 08:41:00,580 - INFO - ETF价格数据表: 1156条记录
2025-05-09 08:41:00,580 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 08:41:00,580 - INFO - ETF自选数据表: 1137条记录
2025-05-09 08:41:00,580 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:47:33,265 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:47:33,266 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:47:33,266 - INFO - 开始导入ETF基本信息...
2025-05-09 09:47:33,267 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:47:33,267 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:47:34,058 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:47:34,059 - INFO - 开始导入ETF价格数据...
2025-05-09 09:47:34,059 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:47:34,059 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:47:34,568 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:47:34,569 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:47:34,570 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:47:34,593 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:47:34
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:47:34
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:47:34
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:47:34
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:47:34

[5 rows x 39 columns]
2025-05-09 09:47:34,629 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:47:34,629 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:47:34,630 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:47:34,630 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:47:34,691 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:47:34,701 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:47:34,701 - INFO - 数据形状: (0, 1)
2025-05-09 09:47:34,701 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:47:34,702 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:47:34,809 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:47:34,815 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:47:34,817 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:47:34,820 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:47:34,825 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:47:34,890 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:47:34,891 - INFO - 开始导入ETF自选数据...
2025-05-09 09:47:34,891 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:47:34,891 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:47:34,921 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:47:34,946 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:47:34,947 - INFO - 数据形状: (0, 1)
2025-05-09 09:47:34,947 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:47:34,947 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:47:35,008 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:47:35,012 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:47:35,012 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:47:35,013 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:47:35,013 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:47:35,013 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:47:35,014 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:47:35,019 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:47:35,064 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:47:35,065 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:47:35,065 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:47:35,115 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:47:35,115 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:47:35,115 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:47:35,215 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:47:35,215 - INFO - === ETF数据导入完成 ===
2025-05-09 09:47:35,215 - INFO - ETF基本信息: 成功
2025-05-09 09:47:35,215 - INFO - ETF价格数据: 成功
2025-05-09 09:47:35,215 - INFO - ETF持有人数据: 成功
2025-05-09 09:47:35,215 - INFO - ETF自选数据: 成功
2025-05-09 09:47:35,215 - INFO - ETF指数分类数据: 成功
2025-05-09 09:47:35,215 - INFO - ETF商务协议数据: 成功
2025-05-09 09:47:35,216 - INFO - === 数据库记录统计 ===
2025-05-09 09:47:35,216 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:47:35,216 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:47:35,216 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:47:35,216 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:47:35,216 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:47:35,216 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:47:35,217 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:48:38,084 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:48:38,087 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:48:38,087 - INFO - 开始导入ETF基本信息...
2025-05-09 09:48:38,089 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:48:38,089 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:48:38,867 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:48:38,867 - INFO - 开始导入ETF价格数据...
2025-05-09 09:48:38,868 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:48:38,868 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:48:39,364 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:48:39,365 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:48:39,367 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:48:39,439 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:48:39
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:48:39
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:48:39
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:48:39
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:48:39

[5 rows x 39 columns]
2025-05-09 09:48:39,474 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:48:39,474 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:48:39,475 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:48:39,475 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:48:39,534 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:48:39,545 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:48:39,545 - INFO - 数据形状: (0, 1)
2025-05-09 09:48:39,546 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:48:39,546 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:48:39,652 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:48:39,658 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:48:39,660 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:48:39,662 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:48:39,667 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:48:39,732 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:48:39,732 - INFO - 开始导入ETF自选数据...
2025-05-09 09:48:39,733 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:48:39,733 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:48:39,761 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:48:39,785 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:48:39,785 - INFO - 数据形状: (0, 1)
2025-05-09 09:48:39,786 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:48:39,786 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:48:39,845 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:48:39,848 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:48:39,849 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:48:39,849 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:48:39,849 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:48:39,849 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:48:39,851 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:48:39,854 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:48:39,899 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:48:39,899 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:48:39,899 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:48:39,948 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:48:39,949 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:48:39,949 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:48:40,044 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:48:40,044 - INFO - === ETF数据导入完成 ===
2025-05-09 09:48:40,044 - INFO - ETF基本信息: 成功
2025-05-09 09:48:40,044 - INFO - ETF价格数据: 成功
2025-05-09 09:48:40,044 - INFO - ETF持有人数据: 成功
2025-05-09 09:48:40,045 - INFO - ETF自选数据: 成功
2025-05-09 09:48:40,045 - INFO - ETF指数分类数据: 成功
2025-05-09 09:48:40,045 - INFO - ETF商务协议数据: 成功
2025-05-09 09:48:40,045 - INFO - === 数据库记录统计 ===
2025-05-09 09:48:40,045 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:48:40,045 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:48:40,045 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:48:40,045 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:48:40,045 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:48:40,045 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:48:40,050 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:50:24,023 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:50:24,026 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:50:24,026 - INFO - 开始导入ETF基本信息...
2025-05-09 09:50:24,028 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:50:24,029 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:50:24,804 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:50:24,804 - INFO - 开始导入ETF价格数据...
2025-05-09 09:50:24,805 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:50:24,805 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:50:25,319 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:50:25,320 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:50:25,322 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:50:25,344 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:50:25
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:50:25
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:50:25
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:50:25
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:50:25

[5 rows x 39 columns]
2025-05-09 09:50:25,379 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:50:25,380 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:50:25,381 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:50:25,381 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:50:25,489 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:50:25,498 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:50:25,498 - INFO - 数据形状: (0, 1)
2025-05-09 09:50:25,499 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:50:25,499 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:50:25,605 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:50:25,611 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:50:25,614 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:50:25,616 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:50:25,621 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:50:25,689 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:50:25,689 - INFO - 开始导入ETF自选数据...
2025-05-09 09:50:25,690 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:50:25,690 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:50:25,718 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:50:25,744 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:50:25,744 - INFO - 数据形状: (0, 1)
2025-05-09 09:50:25,745 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:50:25,745 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:50:25,804 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:50:25,807 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:50:25,808 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:50:25,808 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:50:25,808 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:50:25,808 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:50:25,810 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:50:25,814 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:50:25,867 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:50:25,868 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:50:25,869 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:50:25,919 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:50:25,919 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:50:25,920 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:50:26,018 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:50:26,018 - INFO - === ETF数据导入完成 ===
2025-05-09 09:50:26,018 - INFO - ETF基本信息: 成功
2025-05-09 09:50:26,018 - INFO - ETF价格数据: 成功
2025-05-09 09:50:26,018 - INFO - ETF持有人数据: 成功
2025-05-09 09:50:26,018 - INFO - ETF自选数据: 成功
2025-05-09 09:50:26,018 - INFO - ETF指数分类数据: 成功
2025-05-09 09:50:26,018 - INFO - ETF商务协议数据: 成功
2025-05-09 09:50:26,019 - INFO - === 数据库记录统计 ===
2025-05-09 09:50:26,019 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:50:26,019 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:50:26,019 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:50:26,019 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:50:26,019 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:50:26,019 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:50:26,022 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:51:09,197 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:51:09,199 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:51:09,199 - INFO - 开始导入ETF基本信息...
2025-05-09 09:51:09,202 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:51:09,202 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:51:09,979 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:51:09,980 - INFO - 开始导入ETF价格数据...
2025-05-09 09:51:09,980 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:51:09,980 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:51:10,488 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:51:10,488 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:51:10,490 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:51:10,512 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:51:10
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:51:10
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:51:10
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:51:10
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:51:10

[5 rows x 39 columns]
2025-05-09 09:51:10,552 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:51:10,552 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:51:10,554 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:51:10,554 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:51:10,618 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:51:10,628 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:51:10,628 - INFO - 数据形状: (0, 1)
2025-05-09 09:51:10,629 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:51:10,629 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:51:10,736 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:51:10,742 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:51:10,744 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:51:10,746 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:51:10,752 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:51:10,820 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:51:10,821 - INFO - 开始导入ETF自选数据...
2025-05-09 09:51:10,821 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:51:10,821 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:51:10,849 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:51:10,876 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:51:10,877 - INFO - 数据形状: (0, 1)
2025-05-09 09:51:10,877 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:51:10,877 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:51:10,936 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:51:10,940 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:51:10,941 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:51:10,941 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:51:10,941 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:51:10,941 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:51:10,943 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:51:10,946 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:51:10,996 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:51:10,996 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:51:10,997 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:51:11,047 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:51:11,047 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:51:11,048 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:51:11,147 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:51:11,147 - INFO - === ETF数据导入完成 ===
2025-05-09 09:51:11,147 - INFO - ETF基本信息: 成功
2025-05-09 09:51:11,147 - INFO - ETF价格数据: 成功
2025-05-09 09:51:11,147 - INFO - ETF持有人数据: 成功
2025-05-09 09:51:11,147 - INFO - ETF自选数据: 成功
2025-05-09 09:51:11,147 - INFO - ETF指数分类数据: 成功
2025-05-09 09:51:11,147 - INFO - ETF商务协议数据: 成功
2025-05-09 09:51:11,148 - INFO - === 数据库记录统计 ===
2025-05-09 09:51:11,148 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:51:11,148 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:51:11,148 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:51:11,148 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:51:11,148 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:51:11,148 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:51:11,156 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:53:08,145 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:53:08,146 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:53:08,147 - INFO - 开始导入ETF基本信息...
2025-05-09 09:53:08,148 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:53:08,149 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:08,924 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:53:08,924 - INFO - 开始导入ETF价格数据...
2025-05-09 09:53:08,925 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:53:08,925 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:09,430 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:53:09,430 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:53:09,432 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:53:09,455 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:53:09
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:53:09
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:53:09
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:53:09
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:53:09

[5 rows x 39 columns]
2025-05-09 09:53:09,490 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:53:09,490 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:53:09,491 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:53:09,491 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:09,559 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:53:09,569 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:53:09,569 - INFO - 数据形状: (0, 1)
2025-05-09 09:53:09,570 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:53:09,570 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:53:09,676 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:53:09,682 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:53:09,684 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:53:09,686 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:53:09,691 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:53:09,761 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:53:09,762 - INFO - 开始导入ETF自选数据...
2025-05-09 09:53:09,762 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:53:09,762 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:09,790 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:53:09,815 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:53:09,815 - INFO - 数据形状: (0, 1)
2025-05-09 09:53:09,815 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:53:09,816 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:53:09,874 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:53:09,878 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:53:09,878 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:53:09,878 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:53:09,879 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:53:09,879 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:53:09,880 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:53:09,884 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:53:09,933 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:53:09,933 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:53:09,934 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:53:09,985 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:53:09,985 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:53:09,986 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:53:10,082 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:53:10,083 - INFO - === ETF数据导入完成 ===
2025-05-09 09:53:10,083 - INFO - ETF基本信息: 成功
2025-05-09 09:53:10,083 - INFO - ETF价格数据: 成功
2025-05-09 09:53:10,083 - INFO - ETF持有人数据: 成功
2025-05-09 09:53:10,083 - INFO - ETF自选数据: 成功
2025-05-09 09:53:10,083 - INFO - ETF指数分类数据: 成功
2025-05-09 09:53:10,083 - INFO - ETF商务协议数据: 成功
2025-05-09 09:53:10,084 - INFO - === 数据库记录统计 ===
2025-05-09 09:53:10,084 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:53:10,084 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:53:10,084 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:53:10,084 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:53:10,085 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:53:10,085 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:53:10,101 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:53:49,414 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:53:49,415 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:53:49,415 - INFO - 开始导入ETF基本信息...
2025-05-09 09:53:49,417 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:53:49,418 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:50,195 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:53:50,196 - INFO - 开始导入ETF价格数据...
2025-05-09 09:53:50,196 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:53:50,196 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:50,706 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:53:50,707 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:53:50,709 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:53:50,731 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:53:50
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:53:50
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:53:50
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:53:50
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:53:50

[5 rows x 39 columns]
2025-05-09 09:53:50,765 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:53:50,765 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:53:50,766 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:53:50,766 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:50,828 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:53:50,837 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:53:50,837 - INFO - 数据形状: (0, 1)
2025-05-09 09:53:50,838 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:53:50,838 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:53:50,945 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:53:50,950 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:53:50,952 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:53:50,955 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:53:50,961 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:53:51,028 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:53:51,029 - INFO - 开始导入ETF自选数据...
2025-05-09 09:53:51,029 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:53:51,029 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:53:51,057 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:53:51,081 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:53:51,082 - INFO - 数据形状: (0, 1)
2025-05-09 09:53:51,082 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:53:51,082 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:53:51,142 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:53:51,146 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:53:51,147 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:53:51,147 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:53:51,147 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:53:51,147 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:53:51,149 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:53:51,152 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:53:51,200 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:53:51,200 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:53:51,200 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:53:51,250 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:53:51,250 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:53:51,251 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:53:51,348 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:53:51,348 - INFO - === ETF数据导入完成 ===
2025-05-09 09:53:51,348 - INFO - ETF基本信息: 成功
2025-05-09 09:53:51,348 - INFO - ETF价格数据: 成功
2025-05-09 09:53:51,348 - INFO - ETF持有人数据: 成功
2025-05-09 09:53:51,348 - INFO - ETF自选数据: 成功
2025-05-09 09:53:51,348 - INFO - ETF指数分类数据: 成功
2025-05-09 09:53:51,348 - INFO - ETF商务协议数据: 成功
2025-05-09 09:53:51,349 - INFO - === 数据库记录统计 ===
2025-05-09 09:53:51,349 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:53:51,349 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:53:51,349 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:53:51,349 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:53:51,349 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:53:51,349 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:53:51,382 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:54:35,820 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:54:35,832 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:54:35,834 - INFO - 开始导入ETF基本信息...
2025-05-09 09:54:35,838 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:54:35,838 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:36,542 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:54:36,542 - INFO - 开始导入ETF价格数据...
2025-05-09 09:54:36,543 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:54:36,543 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:37,043 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:54:37,044 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:54:37,046 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:54:37,068 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:54:37
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:54:37
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:54:37
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:54:37
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:54:37

[5 rows x 39 columns]
2025-05-09 09:54:37,101 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:54:37,101 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:54:37,102 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:54:37,102 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:37,155 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:54:37,164 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:54:37,164 - INFO - 数据形状: (0, 1)
2025-05-09 09:54:37,165 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:54:37,165 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:54:37,281 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:54:37,287 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:54:37,288 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:54:37,290 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:54:37,295 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:54:37,358 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:54:37,358 - INFO - 开始导入ETF自选数据...
2025-05-09 09:54:37,359 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:54:37,359 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:37,387 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:54:37,396 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:54:37,396 - INFO - 数据形状: (0, 1)
2025-05-09 09:54:37,396 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:54:37,396 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:54:37,456 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:54:37,459 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:54:37,460 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:54:37,460 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:54:37,460 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:54:37,460 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:54:37,462 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:54:37,465 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:54:37,512 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:54:37,512 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:54:37,512 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:54:37,561 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:54:37,562 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:54:37,562 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:54:37,658 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:54:37,658 - INFO - === ETF数据导入完成 ===
2025-05-09 09:54:37,658 - INFO - ETF基本信息: 成功
2025-05-09 09:54:37,658 - INFO - ETF价格数据: 成功
2025-05-09 09:54:37,659 - INFO - ETF持有人数据: 成功
2025-05-09 09:54:37,659 - INFO - ETF自选数据: 成功
2025-05-09 09:54:37,659 - INFO - ETF指数分类数据: 成功
2025-05-09 09:54:37,659 - INFO - ETF商务协议数据: 成功
2025-05-09 09:54:37,659 - INFO - === 数据库记录统计 ===
2025-05-09 09:54:37,659 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:54:37,659 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:54:37,659 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:54:37,659 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:54:37,659 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:54:37,659 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:54:37,687 - ERROR - 基金公司分析数据更新失败。
2025-05-09 09:54:48,501 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 09:54:48,503 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 09:54:48,504 - INFO - 开始导入ETF基本信息...
2025-05-09 09:54:48,506 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:54:48,507 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:49,270 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 09:54:49,271 - INFO - 开始导入ETF价格数据...
2025-05-09 09:54:49,271 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 09:54:49,271 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:49,784 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 09:54:49,784 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 09:54:49,786 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 09:54:49,808 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 09:54:49
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 09:54:49
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 09:54:49
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 09:54:49
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 09:54:49

[5 rows x 39 columns]
2025-05-09 09:54:49,843 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 09:54:49,843 - INFO - 开始导入ETF持有人数据...
2025-05-09 09:54:49,844 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 09:54:49,844 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:49,905 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 09:54:49,913 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:54:49,914 - INFO - 数据形状: (0, 1)
2025-05-09 09:54:49,914 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:54:49,914 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:54:50,020 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 09:54:50,026 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 09:54:50,028 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 09:54:50,031 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 09:54:50,036 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 09:54:50,095 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 09:54:50,096 - INFO - 开始导入ETF自选数据...
2025-05-09 09:54:50,096 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 09:54:50,096 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 09:54:50,125 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 09:54:50,149 - INFO - 原始列名: ['数据截止日期']
2025-05-09 09:54:50,149 - INFO - 数据形状: (0, 1)
2025-05-09 09:54:50,149 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 09:54:50,150 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 09:54:50,208 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 09:54:50,212 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 09:54:50,213 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 09:54:50,213 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 09:54:50,213 - INFO - 找到的代码列: ['标的代码']
2025-05-09 09:54:50,213 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 09:54:50,216 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 09:54:50,220 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 09:54:50,306 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 09:54:50,306 - INFO - 开始导入ETF指数分类数据...
2025-05-09 09:54:50,307 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 09:54:50,356 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 09:54:50,356 - INFO - 开始导入ETF商务协议数据...
2025-05-09 09:54:50,356 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 09:54:50,454 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 09:54:50,454 - INFO - === ETF数据导入完成 ===
2025-05-09 09:54:50,454 - INFO - ETF基本信息: 成功
2025-05-09 09:54:50,454 - INFO - ETF价格数据: 成功
2025-05-09 09:54:50,454 - INFO - ETF持有人数据: 成功
2025-05-09 09:54:50,454 - INFO - ETF自选数据: 成功
2025-05-09 09:54:50,454 - INFO - ETF指数分类数据: 成功
2025-05-09 09:54:50,455 - INFO - ETF商务协议数据: 成功
2025-05-09 09:54:50,455 - INFO - === 数据库记录统计 ===
2025-05-09 09:54:50,455 - INFO - ETF基本信息表: 1156条记录
2025-05-09 09:54:50,455 - INFO - ETF价格数据表: 1156条记录
2025-05-09 09:54:50,455 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 09:54:50,455 - INFO - ETF自选数据表: 1137条记录
2025-05-09 09:54:50,455 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 09:54:50,455 - INFO - 开始更新基金公司分析数据...
2025-05-09 09:54:50,487 - INFO - 基金公司分析数据更新成功。
2025-05-09 09:54:50,487 - INFO - 基金公司分析表: 54条记录
2025-05-09 11:14:17,896 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 11:14:17,898 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 11:14:17,899 - INFO - 开始导入ETF基本信息...
2025-05-09 11:14:17,901 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 11:14:17,901 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:14:18,666 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 11:14:18,666 - INFO - 开始导入ETF价格数据...
2025-05-09 11:14:18,667 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 11:14:18,667 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:14:19,178 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 11:14:19,179 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 11:14:19,180 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 11:14:19,202 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 11:14:19
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 11:14:19
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 11:14:19
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 11:14:19
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 11:14:19

[5 rows x 39 columns]
2025-05-09 11:14:19,238 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 11:14:19,239 - INFO - 开始导入ETF持有人数据...
2025-05-09 11:14:19,239 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 11:14:19,239 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:14:19,300 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 11:14:19,310 - INFO - 原始列名: ['数据截止日期']
2025-05-09 11:14:19,310 - INFO - 数据形状: (0, 1)
2025-05-09 11:14:19,310 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 11:14:19,310 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 11:14:19,417 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 11:14:19,423 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 11:14:19,425 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 11:14:19,427 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 11:14:19,433 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 11:14:19,498 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 11:14:19,499 - INFO - 开始导入ETF自选数据...
2025-05-09 11:14:19,499 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 11:14:19,499 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:14:19,527 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 11:14:19,551 - INFO - 原始列名: ['数据截止日期']
2025-05-09 11:14:19,551 - INFO - 数据形状: (0, 1)
2025-05-09 11:14:19,552 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 11:14:19,552 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 11:14:19,610 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 11:14:19,614 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 11:14:19,615 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 11:14:19,615 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 11:14:19,615 - INFO - 找到的代码列: ['标的代码']
2025-05-09 11:14:19,615 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 11:14:19,617 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 11:14:19,620 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 11:14:19,668 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 11:14:19,669 - INFO - 开始导入ETF指数分类数据...
2025-05-09 11:14:19,669 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 11:14:19,719 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 11:14:19,719 - INFO - 开始导入ETF商务协议数据...
2025-05-09 11:14:19,720 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 11:14:19,818 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 11:14:19,818 - INFO - === ETF数据导入完成 ===
2025-05-09 11:14:19,818 - INFO - ETF基本信息: 成功
2025-05-09 11:14:19,818 - INFO - ETF价格数据: 成功
2025-05-09 11:14:19,818 - INFO - ETF持有人数据: 成功
2025-05-09 11:14:19,818 - INFO - ETF自选数据: 成功
2025-05-09 11:14:19,818 - INFO - ETF指数分类数据: 成功
2025-05-09 11:14:19,818 - INFO - ETF商务协议数据: 成功
2025-05-09 11:14:19,819 - INFO - === 数据库记录统计 ===
2025-05-09 11:14:19,819 - INFO - ETF基本信息表: 1156条记录
2025-05-09 11:14:19,819 - INFO - ETF价格数据表: 1156条记录
2025-05-09 11:14:19,819 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 11:14:19,819 - INFO - ETF自选数据表: 1137条记录
2025-05-09 11:14:19,819 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 11:14:19,819 - INFO - 开始更新基金公司分析数据...
2025-05-09 11:14:19,849 - INFO - 基金公司分析数据更新成功。
2025-05-09 11:14:19,849 - INFO - 基金公司分析表: 54条记录
2025-05-09 11:18:37,309 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 11:18:37,311 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 11:18:37,311 - INFO - 开始导入ETF基本信息...
2025-05-09 11:18:37,313 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 11:18:37,313 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:18:38,061 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 11:18:38,061 - INFO - 开始导入ETF价格数据...
2025-05-09 11:18:38,062 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 11:18:38,062 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:18:38,558 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 11:18:38,558 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 11:18:38,560 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 11:18:38,582 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 11:18:38
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 11:18:38
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 11:18:38
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 11:18:38
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 11:18:38

[5 rows x 39 columns]
2025-05-09 11:18:38,613 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 11:18:38,614 - INFO - 开始导入ETF持有人数据...
2025-05-09 11:18:38,614 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 11:18:38,615 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:18:38,677 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 11:18:38,686 - INFO - 原始列名: ['数据截止日期']
2025-05-09 11:18:38,687 - INFO - 数据形状: (0, 1)
2025-05-09 11:18:38,687 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 11:18:38,687 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 11:18:38,792 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 11:18:38,798 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 11:18:38,800 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 11:18:38,802 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 11:18:38,807 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 11:18:38,851 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 11:18:38,851 - INFO - 开始导入ETF自选数据...
2025-05-09 11:18:38,852 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 11:18:38,852 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 11:18:38,879 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 11:18:38,903 - INFO - 原始列名: ['数据截止日期']
2025-05-09 11:18:38,903 - INFO - 数据形状: (0, 1)
2025-05-09 11:18:38,903 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 11:18:38,903 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 11:18:38,962 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 11:18:38,965 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 11:18:38,966 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 11:18:38,966 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 11:18:38,966 - INFO - 找到的代码列: ['标的代码']
2025-05-09 11:18:38,966 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 11:18:38,968 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 11:18:38,972 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 11:18:39,011 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 11:18:39,011 - INFO - 开始导入ETF指数分类数据...
2025-05-09 11:18:39,012 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 11:18:39,061 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 11:18:39,061 - INFO - 开始导入ETF商务协议数据...
2025-05-09 11:18:39,062 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 11:18:39,157 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 11:18:39,157 - INFO - === ETF数据导入完成 ===
2025-05-09 11:18:39,157 - INFO - ETF基本信息: 成功
2025-05-09 11:18:39,157 - INFO - ETF价格数据: 成功
2025-05-09 11:18:39,157 - INFO - ETF持有人数据: 成功
2025-05-09 11:18:39,157 - INFO - ETF自选数据: 成功
2025-05-09 11:18:39,157 - INFO - ETF指数分类数据: 成功
2025-05-09 11:18:39,157 - INFO - ETF商务协议数据: 成功
2025-05-09 11:18:39,158 - INFO - === 数据库记录统计 ===
2025-05-09 11:18:39,158 - INFO - ETF基本信息表: 1156条记录
2025-05-09 11:18:39,158 - INFO - ETF价格数据表: 1156条记录
2025-05-09 11:18:39,158 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 11:18:39,158 - INFO - ETF自选数据表: 1137条记录
2025-05-09 11:18:39,158 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 11:18:39,158 - INFO - 开始更新基金公司分析数据...
2025-05-09 11:18:39,190 - INFO - 基金公司分析数据更新成功。
2025-05-09 11:18:39,190 - INFO - 基金公司分析表: 54条记录
2025-05-09 13:34:38,069 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:34:38,072 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:34:38,072 - INFO - 开始导入ETF基本信息...
2025-05-09 13:34:38,075 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:34:38,075 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:34:44,020 - ERROR - 导入ETF基本信息失败
2025-05-09 13:34:44,020 - INFO - 开始导入ETF价格数据...
2025-05-09 13:34:44,022 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:34:44,022 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:34:44,560 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 13:34:44,560 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 13:34:44,562 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 13:34:44,584 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 13:34:44
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 13:34:44
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 13:34:44
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 13:34:44
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 13:34:44

[5 rows x 39 columns]
2025-05-09 13:34:49,785 - ERROR - 导入ETF价格数据失败
2025-05-09 13:34:49,786 - INFO - 开始导入ETF持有人数据...
2025-05-09 13:34:49,793 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 13:34:49,794 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:34:49,887 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 13:34:49,897 - INFO - 原始列名: ['数据截止日期']
2025-05-09 13:34:49,897 - INFO - 数据形状: (0, 1)
2025-05-09 13:34:49,898 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 13:34:49,898 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 13:34:50,006 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 13:34:50,013 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 13:34:50,016 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 13:34:50,019 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 13:34:50,025 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 13:34:55,253 - ERROR - 导入ETF持有人数据失败
2025-05-09 13:34:55,253 - INFO - 开始导入ETF自选数据...
2025-05-09 13:34:55,254 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 13:34:55,254 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:34:55,312 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 13:34:55,321 - INFO - 原始列名: ['数据截止日期']
2025-05-09 13:34:55,321 - INFO - 数据形状: (0, 1)
2025-05-09 13:34:55,322 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 13:34:55,322 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 13:34:55,384 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 13:34:55,387 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 13:34:55,388 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 13:34:55,388 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 13:34:55,388 - INFO - 找到的代码列: ['标的代码']
2025-05-09 13:34:55,388 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 13:34:55,390 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 13:34:55,394 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 13:35:00,603 - ERROR - 导入ETF自选数据失败
2025-05-09 13:35:00,604 - INFO - 开始导入ETF指数分类数据...
2025-05-09 13:35:00,606 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 13:35:05,927 - ERROR - 导入ETF指数分类数据失败
2025-05-09 13:35:05,928 - INFO - 开始导入ETF商务协议数据...
2025-05-09 13:35:05,931 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 13:35:11,277 - ERROR - 导入ETF商务协议数据失败
2025-05-09 13:35:11,279 - INFO - === ETF数据导入完成 ===
2025-05-09 13:35:11,279 - INFO - ETF基本信息: 失败
2025-05-09 13:35:11,279 - INFO - ETF价格数据: 失败
2025-05-09 13:35:11,279 - INFO - ETF持有人数据: 失败
2025-05-09 13:35:11,279 - INFO - ETF自选数据: 失败
2025-05-09 13:35:11,280 - INFO - ETF指数分类数据: 失败
2025-05-09 13:35:11,280 - INFO - ETF商务协议数据: 失败
2025-05-09 13:35:11,283 - INFO - === 数据库记录统计 ===
2025-05-09 13:35:11,283 - INFO - ETF基本信息表: 1156条记录
2025-05-09 13:35:11,283 - INFO - ETF价格数据表: 1156条记录
2025-05-09 13:35:11,283 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 13:35:11,283 - INFO - ETF自选数据表: 1137条记录
2025-05-09 13:35:11,283 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 13:35:11,284 - INFO - 开始更新基金公司分析数据...
2025-05-09 13:35:16,499 - ERROR - 基金公司分析数据更新失败。
2025-05-09 13:40:20,893 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:40:20,894 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:40:20,905 - ERROR - 导入所有数据过程中发生严重错误: 'sqlite3.Connection' object has no attribute 'closed'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 357, in import_all_data
    conn = db_main.connect() # Get the connection object
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/database/models.py", line 51, in connect
    if self.conn is None or self.conn.closed:
AttributeError: 'sqlite3.Connection' object has no attribute 'closed'
2025-05-09 13:40:20,908 - INFO - === 所有数据导入操作结束 ===
2025-05-09 13:43:54,077 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:43:54,088 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:43:54,099 - ERROR - 导入所有数据过程中发生严重错误: 'sqlite3.Connection' object has no attribute 'closed'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 357, in import_all_data
    conn = db_main.connect() # Get the connection object
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/database/models.py", line 51, in connect
    if self.conn is None:
AttributeError: 'sqlite3.Connection' object has no attribute 'closed'
2025-05-09 13:43:54,103 - INFO - === 所有数据导入操作结束 ===
2025-05-09 13:44:01,038 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:44:01,041 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:44:01,051 - INFO - 确保数据库表结构存在...
2025-05-09 13:44:11,461 - ERROR - 数据库表创建失败，终止导入。
2025-05-09 13:44:11,462 - INFO - === 所有数据导入操作结束 ===
2025-05-09 13:45:53,657 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:45:53,659 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:45:53,672 - INFO - 确保数据库表结构存在...
2025-05-09 13:45:53,703 - INFO - 开始导入ETF基本信息...
2025-05-09 13:45:53,704 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:45:53,704 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:45:54,454 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 13:45:54,454 - INFO - 开始导入ETF价格数据...
2025-05-09 13:45:54,454 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:45:54,454 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:45:54,991 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 13:45:54,991 - INFO - 开始导入ETF持有人数据...
2025-05-09 13:45:54,992 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 13:45:55,004 - ERROR - 导入ETF持有人数据时出错: 'code'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'code'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 242, in import_etf_holders
    df['code'] = df['code'].apply(normalize_etf_code)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'code'
2025-05-09 13:45:55,007 - INFO - 开始导入ETF自选数据...
2025-05-09 13:45:55,008 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 13:45:55,020 - ERROR - 导入ETF自选数据时出错: 'code'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2898, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'code'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/import_excel_data.py", line 279, in import_etf_attention
    df['code'] = df['code'].apply(normalize_etf_code)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/frame.py", line 2906, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/admin/PycharmProjects/Weekly_ETF_Data_Changes/venv/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2900, in get_loc
    raise KeyError(key) from err
KeyError: 'code'
2025-05-09 13:45:55,020 - INFO - 开始导入ETF指数分类数据...
2025-05-09 13:45:55,021 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 13:45:55,074 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 13:45:55,075 - INFO - 开始导入ETF商务协议数据...
2025-05-09 13:45:55,075 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 13:45:55,174 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 13:45:55,175 - INFO - === ETF数据导入完成 ===
2025-05-09 13:45:55,175 - INFO - ETF基本信息: 成功
2025-05-09 13:45:55,175 - INFO - ETF价格数据: 成功
2025-05-09 13:45:55,175 - INFO - ETF持有人数据: 失败
2025-05-09 13:45:55,175 - INFO - ETF自选数据: 失败
2025-05-09 13:45:55,175 - INFO - ETF指数分类数据: 成功
2025-05-09 13:45:55,175 - INFO - ETF商务协议数据: 成功
2025-05-09 13:45:55,175 - INFO - === 数据库记录统计 ===
2025-05-09 13:45:55,175 - INFO - ETF基本信息表: 1156条记录
2025-05-09 13:45:55,175 - INFO - ETF价格数据表: 1156条记录
2025-05-09 13:45:55,175 - INFO - ETF持有人数据表: 0条记录
2025-05-09 13:45:55,176 - INFO - ETF自选数据表: 0条记录
2025-05-09 13:45:55,176 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 13:45:55,176 - INFO - 开始更新基金公司分析数据...
2025-05-09 13:45:55,189 - ERROR - 基金公司分析数据更新失败。
2025-05-09 13:45:55,190 - INFO - === 所有数据导入操作结束 ===
2025-05-09 13:50:38,954 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:50:38,957 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:50:38,971 - INFO - 确保数据库表结构存在...
2025-05-09 13:50:38,998 - INFO - 开始导入ETF基本信息...
2025-05-09 13:50:39,000 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:50:39,000 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:50:39,747 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 13:50:39,748 - INFO - 开始导入ETF价格数据...
2025-05-09 13:50:39,748 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:50:39,748 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:50:40,288 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 13:50:40,288 - INFO - 开始导入ETF持有人数据...
2025-05-09 13:50:40,289 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 13:50:40,299 - ERROR - 读取到的ETF持有人数据为空。
2025-05-09 13:50:40,299 - INFO - 开始导入ETF自选数据...
2025-05-09 13:50:40,300 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 13:50:40,309 - ERROR - 读取到的ETF自选数据为空。
2025-05-09 13:50:40,309 - INFO - 开始导入ETF指数分类数据...
2025-05-09 13:50:40,309 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 13:50:40,360 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 13:50:40,360 - INFO - 开始导入ETF商务协议数据...
2025-05-09 13:50:40,360 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 13:50:40,461 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 13:50:40,461 - INFO - === ETF数据导入完成 ===
2025-05-09 13:50:40,461 - INFO - ETF基本信息: 成功
2025-05-09 13:50:40,461 - INFO - ETF价格数据: 成功
2025-05-09 13:50:40,461 - INFO - ETF持有人数据: 失败
2025-05-09 13:50:40,461 - INFO - ETF自选数据: 失败
2025-05-09 13:50:40,461 - INFO - ETF指数分类数据: 成功
2025-05-09 13:50:40,461 - INFO - ETF商务协议数据: 成功
2025-05-09 13:50:40,461 - INFO - === 数据库记录统计 ===
2025-05-09 13:50:40,462 - INFO - ETF基本信息表: 1156条记录
2025-05-09 13:50:40,462 - INFO - ETF价格数据表: 1156条记录
2025-05-09 13:50:40,462 - INFO - ETF持有人数据表: 0条记录
2025-05-09 13:50:40,462 - INFO - ETF自选数据表: 0条记录
2025-05-09 13:50:40,462 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 13:50:40,462 - INFO - 开始更新基金公司分析数据...
2025-05-09 13:50:40,547 - INFO - 基金公司分析数据更新成功。
2025-05-09 13:50:40,547 - INFO - 基金公司分析表: 54条记录
2025-05-09 13:50:40,548 - INFO - === 所有数据导入操作结束 ===
2025-05-09 13:57:52,003 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 13:57:52,005 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 13:57:52,019 - INFO - 确保数据库表结构存在...
2025-05-09 13:57:52,044 - INFO - 开始导入ETF基本信息...
2025-05-09 13:57:52,046 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:57:52,046 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:57:52,779 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 13:57:52,780 - INFO - 开始导入ETF价格数据...
2025-05-09 13:57:52,780 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 13:57:52,780 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 13:57:53,317 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 13:57:53,317 - INFO - 开始导入ETF持有人数据...
2025-05-09 13:57:53,318 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 13:57:53,329 - ERROR - 读取到的ETF持有人数据为空 (文件: '客户ETF保有量20250508.xlsx').
2025-05-09 13:57:53,388 - INFO - 诊断信息: 文件 '客户ETF保有量20250508.xlsx' 中的可用sheet名称: ['客户ETF保有量', '仪表板']
2025-05-09 13:57:53,389 - INFO - 开始导入ETF自选数据...
2025-05-09 13:57:53,389 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 13:57:53,398 - ERROR - 读取到的ETF自选数据为空 (文件: '客户ETF自选人数20250508.xlsx').
2025-05-09 13:57:53,426 - INFO - 诊断信息: 文件 '客户ETF自选人数20250508.xlsx' 中的可用sheet名称: ['客户ETF自选人数', '仪表板']
2025-05-09 13:57:53,426 - INFO - 开始导入ETF指数分类数据...
2025-05-09 13:57:53,426 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 13:57:53,476 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 13:57:53,476 - INFO - 开始导入ETF商务协议数据...
2025-05-09 13:57:53,476 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 13:57:53,576 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 13:57:53,576 - INFO - === ETF数据导入完成 ===
2025-05-09 13:57:53,576 - INFO - ETF基本信息: 成功
2025-05-09 13:57:53,576 - INFO - ETF价格数据: 成功
2025-05-09 13:57:53,576 - INFO - ETF持有人数据: 失败
2025-05-09 13:57:53,576 - INFO - ETF自选数据: 失败
2025-05-09 13:57:53,576 - INFO - ETF指数分类数据: 成功
2025-05-09 13:57:53,576 - INFO - ETF商务协议数据: 成功
2025-05-09 13:57:53,576 - INFO - === 数据库记录统计 ===
2025-05-09 13:57:53,577 - INFO - ETF基本信息表: 1156条记录
2025-05-09 13:57:53,577 - INFO - ETF价格数据表: 1156条记录
2025-05-09 13:57:53,577 - INFO - ETF持有人数据表: 0条记录
2025-05-09 13:57:53,577 - INFO - ETF自选数据表: 0条记录
2025-05-09 13:57:53,577 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 13:57:53,577 - INFO - 开始更新基金公司分析数据...
2025-05-09 13:57:53,662 - INFO - 基金公司分析数据更新成功。
2025-05-09 13:57:53,663 - INFO - 基金公司分析表: 54条记录
2025-05-09 13:57:53,663 - INFO - === 所有数据导入操作结束 ===
2025-05-09 14:00:03,621 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:00:03,623 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:00:03,633 - INFO - 确保数据库表结构存在...
2025-05-09 14:00:03,661 - INFO - 开始导入ETF基本信息...
2025-05-09 14:00:03,662 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:00:03,662 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:00:04,354 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:00:04,354 - INFO - 开始导入ETF价格数据...
2025-05-09 14:00:04,354 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:00:04,354 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:00:04,882 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:00:04,882 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:00:04,883 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:00:04,894 - ERROR - 读取到的ETF持有人数据为空 (文件: '客户ETF保有量20250508.xlsx').
2025-05-09 14:00:04,953 - INFO - 诊断信息: 文件 '客户ETF保有量20250508.xlsx' 中的可用sheet名称: ['客户ETF保有量', '仪表板']
2025-05-09 14:00:04,953 - INFO - 开始导入ETF自选数据...
2025-05-09 14:00:04,954 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:00:04,963 - ERROR - 读取到的ETF自选数据为空 (文件: '客户ETF自选人数20250508.xlsx').
2025-05-09 14:00:04,989 - INFO - 诊断信息: 文件 '客户ETF自选人数20250508.xlsx' 中的可用sheet名称: ['客户ETF自选人数', '仪表板']
2025-05-09 14:00:04,990 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:00:04,990 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:00:05,039 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:00:05,039 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:00:05,039 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:00:05,138 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:00:05,139 - INFO - === ETF数据导入完成 ===
2025-05-09 14:00:05,139 - INFO - ETF基本信息: 成功
2025-05-09 14:00:05,139 - INFO - ETF价格数据: 成功
2025-05-09 14:00:05,139 - INFO - ETF持有人数据: 失败
2025-05-09 14:00:05,139 - INFO - ETF自选数据: 失败
2025-05-09 14:00:05,139 - INFO - ETF指数分类数据: 成功
2025-05-09 14:00:05,139 - INFO - ETF商务协议数据: 成功
2025-05-09 14:00:05,139 - INFO - === 数据库记录统计 ===
2025-05-09 14:00:05,140 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:00:05,140 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:00:05,140 - INFO - ETF持有人数据表: 0条记录
2025-05-09 14:00:05,140 - INFO - ETF自选数据表: 0条记录
2025-05-09 14:00:05,140 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:00:05,140 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:00:05,223 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:00:05,223 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:00:05,224 - INFO - === 所有数据导入操作结束 ===
2025-05-09 14:01:06,891 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:01:06,893 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:01:06,893 - INFO - 开始导入ETF基本信息...
2025-05-09 14:01:06,894 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:01:06,894 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:01:07,644 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:01:07,644 - INFO - 开始导入ETF价格数据...
2025-05-09 14:01:07,645 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:01:07,645 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:01:08,163 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:01:08,164 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:01:08,165 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:01:08,187 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:01:08
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:01:08
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:01:08
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:01:08
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:01:08

[5 rows x 39 columns]
2025-05-09 14:01:08,227 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:01:08,228 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:01:08,229 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:01:08,229 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:01:08,289 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:01:08,298 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:01:08,298 - INFO - 数据形状: (0, 1)
2025-05-09 14:01:08,299 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:01:08,299 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:01:08,410 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:01:08,416 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:01:08,418 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:01:08,420 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:01:08,427 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:01:08,494 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:01:08,494 - INFO - 开始导入ETF自选数据...
2025-05-09 14:01:08,495 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:01:08,495 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:01:08,525 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:01:08,550 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:01:08,550 - INFO - 数据形状: (0, 1)
2025-05-09 14:01:08,550 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:01:08,550 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:01:08,610 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:01:08,614 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:01:08,614 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:01:08,615 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:01:08,615 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:01:08,615 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:01:08,616 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:01:08,620 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:01:08,668 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:01:08,668 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:01:08,668 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:01:08,719 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:01:08,719 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:01:08,720 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:01:08,818 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:01:08,818 - INFO - === ETF数据导入完成 ===
2025-05-09 14:01:08,818 - INFO - ETF基本信息: 成功
2025-05-09 14:01:08,818 - INFO - ETF价格数据: 成功
2025-05-09 14:01:08,818 - INFO - ETF持有人数据: 成功
2025-05-09 14:01:08,818 - INFO - ETF自选数据: 成功
2025-05-09 14:01:08,818 - INFO - ETF指数分类数据: 成功
2025-05-09 14:01:08,818 - INFO - ETF商务协议数据: 成功
2025-05-09 14:01:08,819 - INFO - === 数据库记录统计 ===
2025-05-09 14:01:08,819 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:01:08,819 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:01:08,819 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:01:08,819 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:01:08,819 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:01:08,819 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:01:08,849 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:01:08,850 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:04:48,339 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:04:48,341 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:04:48,341 - INFO - 开始导入ETF基本信息...
2025-05-09 14:04:48,343 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:04:48,344 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:04:49,135 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:04:49,135 - INFO - 开始导入ETF价格数据...
2025-05-09 14:04:49,136 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:04:49,136 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:04:49,645 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:04:49,646 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:04:49,648 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:04:49,670 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:04:49
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:04:49
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:04:49
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:04:49
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:04:49

[5 rows x 39 columns]
2025-05-09 14:04:49,705 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:04:49,706 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:04:49,707 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:04:49,707 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:04:49,767 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:04:49,777 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:04:49,777 - INFO - 数据形状: (0, 1)
2025-05-09 14:04:49,777 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:04:49,778 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:04:49,886 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:04:49,892 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:04:49,894 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:04:49,896 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:04:49,901 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:04:49,964 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:04:49,965 - INFO - 开始导入ETF自选数据...
2025-05-09 14:04:49,965 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:04:49,965 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:04:49,995 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:04:50,019 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:04:50,019 - INFO - 数据形状: (0, 1)
2025-05-09 14:04:50,020 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:04:50,020 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:04:50,078 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:04:50,082 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:04:50,083 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:04:50,083 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:04:50,083 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:04:50,083 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:04:50,085 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:04:50,088 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:04:50,133 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:04:50,134 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:04:50,135 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:04:50,185 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:04:50,185 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:04:50,186 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:04:50,289 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:04:50,290 - INFO - === ETF数据导入完成 ===
2025-05-09 14:04:50,290 - INFO - ETF基本信息: 成功
2025-05-09 14:04:50,290 - INFO - ETF价格数据: 成功
2025-05-09 14:04:50,290 - INFO - ETF持有人数据: 成功
2025-05-09 14:04:50,290 - INFO - ETF自选数据: 成功
2025-05-09 14:04:50,290 - INFO - ETF指数分类数据: 成功
2025-05-09 14:04:50,290 - INFO - ETF商务协议数据: 成功
2025-05-09 14:04:50,291 - INFO - === 数据库记录统计 ===
2025-05-09 14:04:50,291 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:04:50,291 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:04:50,291 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:04:50,291 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:04:50,291 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:04:50,291 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:04:50,347 - ERROR - 基金公司分析数据更新失败。
2025-05-09 14:05:54,562 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:05:54,565 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:05:54,565 - INFO - 开始导入ETF基本信息...
2025-05-09 14:05:54,568 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:05:54,569 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:05:55,334 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:05:55,334 - INFO - 开始导入ETF价格数据...
2025-05-09 14:05:55,335 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:05:55,335 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:05:55,837 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:05:55,837 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:05:55,839 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:05:55,863 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:05:55
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:05:55
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:05:55
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:05:55
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:05:55

[5 rows x 39 columns]
2025-05-09 14:05:55,896 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:05:55,896 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:05:55,897 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:05:55,897 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:05:55,957 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:05:55,966 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:05:55,966 - INFO - 数据形状: (0, 1)
2025-05-09 14:05:55,967 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:05:55,967 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:05:56,073 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:05:56,079 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:05:56,081 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:05:56,083 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:05:56,089 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:05:56,154 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:05:56,155 - INFO - 开始导入ETF自选数据...
2025-05-09 14:05:56,156 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:05:56,156 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:05:56,183 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:05:56,207 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:05:56,207 - INFO - 数据形状: (0, 1)
2025-05-09 14:05:56,208 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:05:56,208 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:05:56,266 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:05:56,270 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:05:56,270 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:05:56,270 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:05:56,270 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:05:56,271 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:05:56,272 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:05:56,275 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:05:56,322 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:05:56,322 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:05:56,323 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:05:56,373 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:05:56,373 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:05:56,373 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:05:56,468 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:05:56,468 - INFO - === ETF数据导入完成 ===
2025-05-09 14:05:56,468 - INFO - ETF基本信息: 成功
2025-05-09 14:05:56,468 - INFO - ETF价格数据: 成功
2025-05-09 14:05:56,468 - INFO - ETF持有人数据: 成功
2025-05-09 14:05:56,468 - INFO - ETF自选数据: 成功
2025-05-09 14:05:56,468 - INFO - ETF指数分类数据: 成功
2025-05-09 14:05:56,468 - INFO - ETF商务协议数据: 成功
2025-05-09 14:05:56,469 - INFO - === 数据库记录统计 ===
2025-05-09 14:05:56,469 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:05:56,469 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:05:56,469 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:05:56,469 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:05:56,469 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:05:56,469 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:05:56,499 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:05:56,500 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:41:21,699 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:41:21,703 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:41:21,703 - INFO - 开始导入ETF基本信息...
2025-05-09 14:41:21,706 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:41:21,706 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:41:22,485 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:41:22,485 - INFO - 开始导入ETF价格数据...
2025-05-09 14:41:22,486 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:41:22,486 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:41:22,996 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:41:22,996 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:41:22,998 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:41:23,020 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:41:22
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:41:22
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:41:22
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:41:22
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:41:22

[5 rows x 39 columns]
2025-05-09 14:41:23,054 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:41:23,054 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:41:23,055 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:41:23,055 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:41:23,117 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:41:23,128 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:41:23,128 - INFO - 数据形状: (0, 1)
2025-05-09 14:41:23,128 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:41:23,128 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:41:23,236 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:41:23,242 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:41:23,244 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:41:23,246 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:41:23,252 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:41:23,315 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:41:23,315 - INFO - 开始导入ETF自选数据...
2025-05-09 14:41:23,316 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:41:23,316 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:41:23,344 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:41:23,367 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:41:23,367 - INFO - 数据形状: (0, 1)
2025-05-09 14:41:23,368 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:41:23,368 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:41:23,426 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:41:23,429 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:41:23,430 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:41:23,430 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:41:23,430 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:41:23,430 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:41:23,432 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:41:23,435 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:41:23,484 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:41:23,484 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:41:23,485 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:41:23,535 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:41:23,535 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:41:23,535 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:41:23,634 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:41:23,634 - INFO - === ETF数据导入完成 ===
2025-05-09 14:41:23,634 - INFO - ETF基本信息: 成功
2025-05-09 14:41:23,635 - INFO - ETF价格数据: 成功
2025-05-09 14:41:23,635 - INFO - ETF持有人数据: 成功
2025-05-09 14:41:23,635 - INFO - ETF自选数据: 成功
2025-05-09 14:41:23,635 - INFO - ETF指数分类数据: 成功
2025-05-09 14:41:23,635 - INFO - ETF商务协议数据: 成功
2025-05-09 14:41:23,635 - INFO - === 数据库记录统计 ===
2025-05-09 14:41:23,635 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:41:23,635 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:41:23,635 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:41:23,635 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:41:23,636 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:41:23,636 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:41:23,677 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:41:23,677 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:42:51,292 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:42:51,294 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:42:51,295 - INFO - 开始导入ETF基本信息...
2025-05-09 14:42:51,297 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:42:51,298 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:42:52,025 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:42:52,025 - INFO - 开始导入ETF价格数据...
2025-05-09 14:42:52,026 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:42:52,026 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:42:52,526 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:42:52,526 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:42:52,528 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:42:52,550 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:42:52
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:42:52
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:42:52
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:42:52
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:42:52

[5 rows x 39 columns]
2025-05-09 14:42:52,587 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:42:52,587 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:42:52,588 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:42:52,588 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:42:52,648 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:42:52,658 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:42:52,658 - INFO - 数据形状: (0, 1)
2025-05-09 14:42:52,659 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:42:52,659 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:42:52,766 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:42:52,772 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:42:52,774 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:42:52,777 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:42:52,782 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:42:52,843 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:42:52,843 - INFO - 开始导入ETF自选数据...
2025-05-09 14:42:52,844 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:42:52,844 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:42:52,871 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:42:52,895 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:42:52,895 - INFO - 数据形状: (0, 1)
2025-05-09 14:42:52,896 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:42:52,896 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:42:52,956 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:42:52,960 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:42:52,961 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:42:52,961 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:42:52,961 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:42:52,961 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:42:52,962 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:42:52,966 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:42:53,012 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:42:53,013 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:42:53,013 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:42:53,063 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:42:53,063 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:42:53,064 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:42:53,162 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:42:53,162 - INFO - === ETF数据导入完成 ===
2025-05-09 14:42:53,162 - INFO - ETF基本信息: 成功
2025-05-09 14:42:53,162 - INFO - ETF价格数据: 成功
2025-05-09 14:42:53,162 - INFO - ETF持有人数据: 成功
2025-05-09 14:42:53,162 - INFO - ETF自选数据: 成功
2025-05-09 14:42:53,162 - INFO - ETF指数分类数据: 成功
2025-05-09 14:42:53,162 - INFO - ETF商务协议数据: 成功
2025-05-09 14:42:53,163 - INFO - === 数据库记录统计 ===
2025-05-09 14:42:53,163 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:42:53,163 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:42:53,163 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:42:53,163 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:42:53,163 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:42:53,163 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:42:53,205 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:42:53,205 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:43:56,149 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:43:56,153 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:43:56,153 - INFO - 开始导入ETF基本信息...
2025-05-09 14:43:56,156 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:43:56,156 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:43:56,869 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:43:56,869 - INFO - 开始导入ETF价格数据...
2025-05-09 14:43:56,870 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:43:56,870 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:43:57,377 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:43:57,377 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:43:57,379 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:43:57,401 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:43:57
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:43:57
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:43:57
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:43:57
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:43:57

[5 rows x 39 columns]
2025-05-09 14:43:57,432 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:43:57,433 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:43:57,434 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:43:57,434 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:43:57,493 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:43:57,502 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:43:57,502 - INFO - 数据形状: (0, 1)
2025-05-09 14:43:57,503 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:43:57,503 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:43:57,611 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:43:57,617 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:43:57,619 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:43:57,621 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:43:57,626 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:43:57,674 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:43:57,674 - INFO - 开始导入ETF自选数据...
2025-05-09 14:43:57,675 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:43:57,675 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:43:57,703 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:43:57,726 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:43:57,726 - INFO - 数据形状: (0, 1)
2025-05-09 14:43:57,726 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:43:57,727 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:43:57,784 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:43:57,788 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:43:57,788 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:43:57,789 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:43:57,789 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:43:57,789 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:43:57,790 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:43:57,794 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:43:57,831 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:43:57,831 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:43:57,831 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:43:57,881 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:43:57,882 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:43:57,882 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:43:57,985 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:43:57,985 - INFO - === ETF数据导入完成 ===
2025-05-09 14:43:57,985 - INFO - ETF基本信息: 成功
2025-05-09 14:43:57,985 - INFO - ETF价格数据: 成功
2025-05-09 14:43:57,985 - INFO - ETF持有人数据: 成功
2025-05-09 14:43:57,985 - INFO - ETF自选数据: 成功
2025-05-09 14:43:57,986 - INFO - ETF指数分类数据: 成功
2025-05-09 14:43:57,986 - INFO - ETF商务协议数据: 成功
2025-05-09 14:43:57,986 - INFO - === 数据库记录统计 ===
2025-05-09 14:43:57,986 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:43:57,986 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:43:57,986 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:43:57,986 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:43:57,986 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:43:57,986 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:43:58,028 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:43:58,028 - INFO - 基金公司分析表: 54条记录
2025-05-09 14:46:32,932 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:46:32,934 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:46:32,934 - INFO - 开始导入ETF基本信息...
2025-05-09 14:46:32,936 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:46:32,936 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:46:33,709 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:46:33,710 - INFO - 开始导入ETF价格数据...
2025-05-09 14:46:33,710 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:46:33,710 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:46:34,224 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:46:34,224 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:46:34,226 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:46:34,249 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:46:34
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:46:34
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:46:34
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:46:34
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:46:34

[5 rows x 39 columns]
2025-05-09 14:46:34,284 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:46:34,285 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:46:34,285 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:46:34,286 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:46:34,346 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:46:34,355 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:46:34,355 - INFO - 数据形状: (0, 1)
2025-05-09 14:46:34,356 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:46:34,356 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:46:34,462 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:46:34,468 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:46:34,470 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:46:34,473 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:46:34,478 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:46:34,539 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:46:34,540 - INFO - 开始导入ETF自选数据...
2025-05-09 14:46:34,540 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:46:34,540 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:46:34,569 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:46:34,593 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:46:34,593 - INFO - 数据形状: (0, 1)
2025-05-09 14:46:34,593 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:46:34,593 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:46:34,653 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:46:34,656 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:46:34,657 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:46:34,657 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:46:34,657 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:46:34,657 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:46:34,659 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:46:34,662 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:46:34,708 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:46:34,708 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:46:34,709 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:46:34,759 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:46:34,759 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:46:34,759 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:46:34,863 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:46:34,863 - INFO - === ETF数据导入完成 ===
2025-05-09 14:46:34,863 - INFO - ETF基本信息: 成功
2025-05-09 14:46:34,863 - INFO - ETF价格数据: 成功
2025-05-09 14:46:34,863 - INFO - ETF持有人数据: 成功
2025-05-09 14:46:34,863 - INFO - ETF自选数据: 成功
2025-05-09 14:46:34,863 - INFO - ETF指数分类数据: 成功
2025-05-09 14:46:34,863 - INFO - ETF商务协议数据: 成功
2025-05-09 14:46:34,864 - INFO - === 数据库记录统计 ===
2025-05-09 14:46:34,864 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:46:34,864 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:46:34,864 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:46:34,864 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:46:34,864 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:46:34,864 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:46:34,919 - ERROR - 基金公司分析数据更新失败。
2025-05-09 14:47:55,512 - INFO - === 开始导入所有ETF数据 ===
2025-05-09 14:47:55,513 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-09 14:47:55,514 - INFO - 开始导入ETF基本信息...
2025-05-09 14:47:55,516 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:47:55,516 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:47:56,289 - INFO - 成功导入ETF基本信息，共1156条记录
2025-05-09 14:47:56,289 - INFO - 开始导入ETF价格数据...
2025-05-09 14:47:56,290 - INFO - 使用文件: data/ETF_DATA_20250508.xlsx
2025-05-09 14:47:56,290 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:47:56,794 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-09 14:47:56,795 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-09 14:47:56,797 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-09 14:47:56,819 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3836  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-08  2025-05-09 14:47:56
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1425  深圳证券交易所  ...    1.7893          -0.0034                -0.3375  2025-05-08  2025-05-09 14:47:56
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0000  深圳证券交易所  ...    2.3963          -0.0016                -0.1502  2025-05-08  2025-05-09 14:47:56
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4521  深圳证券交易所  ...    0.8937          -0.0020                -0.1976  2025-05-08  2025-05-09 14:47:56
4  159531   中证2000ETF              中证2000指数收益率        1.6712  深圳证券交易所  ...    1.9248           0.0003                 0.0272  2025-05-08  2025-05-09 14:47:56

[5 rows x 39 columns]
2025-05-09 14:47:56,852 - INFO - 成功导入ETF价格数据，共1156条记录
2025-05-09 14:47:56,852 - INFO - 开始导入ETF持有人数据...
2025-05-09 14:47:56,853 - INFO - 使用文件: data/客户ETF保有量20250508.xlsx
2025-05-09 14:47:56,853 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:47:56,913 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-09 14:47:56,923 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:47:56,923 - INFO - 数据形状: (0, 1)
2025-05-09 14:47:56,924 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:47:56,924 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:47:57,029 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-09 14:47:57,034 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-09 14:47:57,037 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-09 14:47:57,039 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-09 14:47:57,045 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250508  159001       货币ETF         99304.0            12   9.930301e+06  2025-05-08
1      None  159003     招商快线ETF           853.0             4   8.529915e+04  2025-05-08
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-08
3      None  159150  深证50ETF易方达       1662760.0            36   1.907186e+06  2025-05-08
4      None  159201    自由现金流ETF      24466003.0           561   2.385435e+07  2025-05-08
2025-05-09 14:47:57,107 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-09 14:47:57,107 - INFO - 开始导入ETF自选数据...
2025-05-09 14:47:57,108 - INFO - 使用文件: data/客户ETF自选人数20250508.xlsx
2025-05-09 14:47:57,108 - INFO - 从文件名中提取的日期: 2025-05-08
2025-05-09 14:47:57,135 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-09 14:47:57,159 - INFO - 原始列名: ['数据截止日期']
2025-05-09 14:47:57,159 - INFO - 数据形状: (0, 1)
2025-05-09 14:47:57,159 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-09 14:47:57,159 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-09 14:47:57,217 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-09 14:47:57,220 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-09 14:47:57,221 - INFO - 成功读取数据，形状: (1137, 3)
2025-05-09 14:47:57,221 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-09 14:47:57,221 - INFO - 找到的代码列: ['标的代码']
2025-05-09 14:47:57,221 - INFO - 找到的自选列: ['加自选人数']
2025-05-09 14:47:57,223 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-09 14:47:57,226 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250508  159001              101  2025-05-08
1      None  159003               98  2025-05-08
2      None  159005               45  2025-05-08
3      None  159150              247  2025-05-08
4      None  159201              924  2025-05-08
2025-05-09 14:47:57,271 - INFO - 成功导入ETF自选数据，共1137条记录
2025-05-09 14:47:57,271 - INFO - 开始导入ETF指数分类数据...
2025-05-09 14:47:57,272 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-09 14:47:57,321 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-09 14:47:57,321 - INFO - 开始导入ETF商务协议数据...
2025-05-09 14:47:57,321 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-09 14:47:57,416 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-09 14:47:57,416 - INFO - === ETF数据导入完成 ===
2025-05-09 14:47:57,416 - INFO - ETF基本信息: 成功
2025-05-09 14:47:57,416 - INFO - ETF价格数据: 成功
2025-05-09 14:47:57,416 - INFO - ETF持有人数据: 成功
2025-05-09 14:47:57,416 - INFO - ETF自选数据: 成功
2025-05-09 14:47:57,416 - INFO - ETF指数分类数据: 成功
2025-05-09 14:47:57,416 - INFO - ETF商务协议数据: 成功
2025-05-09 14:47:57,417 - INFO - === 数据库记录统计 ===
2025-05-09 14:47:57,417 - INFO - ETF基本信息表: 1156条记录
2025-05-09 14:47:57,417 - INFO - ETF价格数据表: 1156条记录
2025-05-09 14:47:57,417 - INFO - ETF持有人数据表: 1124条记录
2025-05-09 14:47:57,417 - INFO - ETF自选数据表: 1137条记录
2025-05-09 14:47:57,417 - INFO - ETF商务协议数据表: 341条记录
2025-05-09 14:47:57,417 - INFO - 开始更新基金公司分析数据...
2025-05-09 14:47:57,479 - INFO - 基金公司分析数据更新成功。
2025-05-09 14:47:57,479 - INFO - 基金公司分析表: 54条记录
2025-05-12 09:27:02,936 - INFO - === 开始导入所有ETF数据 ===
2025-05-12 09:27:02,938 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-12 09:27:02,939 - INFO - 开始导入ETF基本信息...
2025-05-12 09:27:02,941 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 09:27:02,941 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 09:27:03,747 - INFO - 成功导入ETF基本信息，共1157条记录
2025-05-12 09:27:03,747 - INFO - 开始导入ETF价格数据...
2025-05-12 09:27:03,748 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 09:27:03,748 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 09:27:04,253 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-12 09:27:04,254 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-12 09:27:04,256 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-12 09:27:04,278 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3918  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-05-09  2025-05-12 09:27:04
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1507  深圳证券交易所  ...    1.3944           0.0008                 0.0790  2025-05-09  2025-05-12 09:27:04
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0082  深圳证券交易所  ...    1.1278          -0.0019                -0.1789  2025-05-09  2025-05-12 09:27:04
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4603  深圳证券交易所  ...    0.4950          -0.0018                -0.1769  2025-05-09  2025-05-12 09:27:04
4  159531   中证2000ETF              中证2000指数收益率        1.6795  深圳证券交易所  ...    1.9928           0.0008                 0.0736  2025-05-09  2025-05-12 09:27:04

[5 rows x 39 columns]
2025-05-12 09:27:04,308 - INFO - 成功导入ETF价格数据，共1157条记录
2025-05-12 09:27:04,308 - INFO - 开始导入ETF持有人数据...
2025-05-12 09:27:04,309 - INFO - 使用文件: data/客户ETF保有量20250509.xlsx
2025-05-12 09:27:04,309 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 09:27:04,373 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-12 09:27:04,382 - INFO - 原始列名: ['数据截止日期']
2025-05-12 09:27:04,382 - INFO - 数据形状: (0, 1)
2025-05-12 09:27:04,382 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 09:27:04,382 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 09:27:04,492 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-12 09:27:04,498 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-12 09:27:04,500 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-12 09:27:04,503 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-12 09:27:04,509 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250509  159001       货币ETF         98804.0            11     9880400.00  2025-05-09
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-05-09
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-05-09
3      None  159150  深证50ETF易方达       1662760.0            36     1900534.65  2025-05-09
4      None  159201    自由现金流ETF      24309703.0           561    23604721.60  2025-05-09
2025-05-12 09:27:04,553 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-12 09:27:04,553 - INFO - 开始导入ETF自选数据...
2025-05-12 09:27:04,554 - INFO - 使用文件: data/客户ETF自选人数20250509.xlsx
2025-05-12 09:27:04,555 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 09:27:04,584 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-12 09:27:04,609 - INFO - 原始列名: ['数据截止日期']
2025-05-12 09:27:04,609 - INFO - 数据形状: (0, 1)
2025-05-12 09:27:04,609 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 09:27:04,609 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 09:27:04,667 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-12 09:27:04,671 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-12 09:27:04,672 - INFO - 成功读取数据，形状: (1141, 3)
2025-05-12 09:27:04,672 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-12 09:27:04,672 - INFO - 找到的代码列: ['标的代码']
2025-05-12 09:27:04,672 - INFO - 找到的自选列: ['加自选人数']
2025-05-12 09:27:04,674 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-12 09:27:04,677 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250509  159001              101  2025-05-09
1      None  159003               98  2025-05-09
2      None  159005               46  2025-05-09
3      None  159150              247  2025-05-09
4      None  159201              930  2025-05-09
2025-05-12 09:27:04,711 - INFO - 成功导入ETF自选数据，共1141条记录
2025-05-12 09:27:04,711 - INFO - 开始导入ETF指数分类数据...
2025-05-12 09:27:04,712 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-12 09:27:04,761 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-12 09:27:04,761 - INFO - 开始导入ETF商务协议数据...
2025-05-12 09:27:04,761 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-12 09:27:04,858 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-12 09:27:04,858 - INFO - === ETF数据导入完成 ===
2025-05-12 09:27:04,859 - INFO - ETF基本信息: 成功
2025-05-12 09:27:04,859 - INFO - ETF价格数据: 成功
2025-05-12 09:27:04,859 - INFO - ETF持有人数据: 成功
2025-05-12 09:27:04,859 - INFO - ETF自选数据: 成功
2025-05-12 09:27:04,859 - INFO - ETF指数分类数据: 成功
2025-05-12 09:27:04,859 - INFO - ETF商务协议数据: 成功
2025-05-12 09:27:04,859 - INFO - === 数据库记录统计 ===
2025-05-12 09:27:04,859 - INFO - ETF基本信息表: 1157条记录
2025-05-12 09:27:04,859 - INFO - ETF价格数据表: 1157条记录
2025-05-12 09:27:04,860 - INFO - ETF持有人数据表: 1124条记录
2025-05-12 09:27:04,860 - INFO - ETF自选数据表: 1141条记录
2025-05-12 09:27:04,860 - INFO - ETF商务协议数据表: 341条记录
2025-05-12 09:27:04,860 - INFO - 开始更新基金公司分析数据...
2025-05-12 09:27:04,927 - INFO - 基金公司分析数据更新成功。
2025-05-12 09:27:04,927 - INFO - 基金公司分析表: 54条记录
2025-05-12 13:22:56,940 - INFO - === 开始导入所有ETF数据 ===
2025-05-12 13:22:56,945 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-12 13:22:56,945 - INFO - 开始导入ETF基本信息...
2025-05-12 13:22:56,951 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 13:22:56,951 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:22:57,795 - INFO - 成功导入ETF基本信息，共1157条记录
2025-05-12 13:22:57,795 - INFO - 开始导入ETF价格数据...
2025-05-12 13:22:57,795 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 13:22:57,795 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:22:58,304 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-12 13:22:58,305 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-12 13:22:58,306 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-12 13:22:58,330 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3918  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-05-09  2025-05-12 13:22:58
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1507  深圳证券交易所  ...    1.3944           0.0008                 0.0790  2025-05-09  2025-05-12 13:22:58
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0082  深圳证券交易所  ...    1.1278          -0.0019                -0.1789  2025-05-09  2025-05-12 13:22:58
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4603  深圳证券交易所  ...    0.4950          -0.0018                -0.1769  2025-05-09  2025-05-12 13:22:58
4  159531   中证2000ETF              中证2000指数收益率        1.6795  深圳证券交易所  ...    1.9928           0.0008                 0.0736  2025-05-09  2025-05-12 13:22:58

[5 rows x 39 columns]
2025-05-12 13:22:58,368 - INFO - 成功导入ETF价格数据，共1157条记录
2025-05-12 13:22:58,369 - INFO - 开始导入ETF持有人数据...
2025-05-12 13:22:58,370 - INFO - 使用文件: data/客户ETF保有量20250509.xlsx
2025-05-12 13:22:58,370 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:22:58,433 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-12 13:22:58,443 - INFO - 原始列名: ['数据截止日期']
2025-05-12 13:22:58,443 - INFO - 数据形状: (0, 1)
2025-05-12 13:22:58,443 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 13:22:58,443 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 13:22:58,552 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-12 13:22:58,558 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-12 13:22:58,560 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-12 13:22:58,563 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-12 13:22:58,567 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250509  159001       货币ETF         98804.0            11     9880400.00  2025-05-09
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-05-09
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-05-09
3      None  159150  深证50ETF易方达       1662760.0            36     1900534.65  2025-05-09
4      None  159201    自由现金流ETF      24309703.0           561    23604721.60  2025-05-09
2025-05-12 13:22:58,642 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-12 13:22:58,643 - INFO - 开始导入ETF自选数据...
2025-05-12 13:22:58,643 - INFO - 使用文件: data/客户ETF自选人数20250509.xlsx
2025-05-12 13:22:58,644 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:22:58,673 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-12 13:22:58,700 - INFO - 原始列名: ['数据截止日期']
2025-05-12 13:22:58,700 - INFO - 数据形状: (0, 1)
2025-05-12 13:22:58,701 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 13:22:58,701 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 13:22:58,762 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-12 13:22:58,765 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-12 13:22:58,766 - INFO - 成功读取数据，形状: (1141, 3)
2025-05-12 13:22:58,766 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-12 13:22:58,766 - INFO - 找到的代码列: ['标的代码']
2025-05-12 13:22:58,766 - INFO - 找到的自选列: ['加自选人数']
2025-05-12 13:22:58,768 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-12 13:22:58,772 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250509  159001              101  2025-05-09
1      None  159003               98  2025-05-09
2      None  159005               46  2025-05-09
3      None  159150              247  2025-05-09
4      None  159201              930  2025-05-09
2025-05-12 13:22:58,824 - INFO - 成功导入ETF自选数据，共1141条记录
2025-05-12 13:22:58,826 - INFO - 开始导入ETF指数分类数据...
2025-05-12 13:22:58,826 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-12 13:22:58,876 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-12 13:22:58,876 - INFO - 开始导入ETF商务协议数据...
2025-05-12 13:22:58,877 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-12 13:22:58,973 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-12 13:22:58,973 - INFO - === ETF数据导入完成 ===
2025-05-12 13:22:58,974 - INFO - ETF基本信息: 成功
2025-05-12 13:22:58,974 - INFO - ETF价格数据: 成功
2025-05-12 13:22:58,974 - INFO - ETF持有人数据: 成功
2025-05-12 13:22:58,974 - INFO - ETF自选数据: 成功
2025-05-12 13:22:58,974 - INFO - ETF指数分类数据: 成功
2025-05-12 13:22:58,974 - INFO - ETF商务协议数据: 成功
2025-05-12 13:22:58,975 - INFO - === 数据库记录统计 ===
2025-05-12 13:22:58,975 - INFO - ETF基本信息表: 1157条记录
2025-05-12 13:22:58,975 - INFO - ETF价格数据表: 1157条记录
2025-05-12 13:22:58,975 - INFO - ETF持有人数据表: 1124条记录
2025-05-12 13:22:58,975 - INFO - ETF自选数据表: 1141条记录
2025-05-12 13:22:58,975 - INFO - ETF商务协议数据表: 341条记录
2025-05-12 13:22:58,975 - INFO - 开始更新基金公司分析数据...
2025-05-12 13:22:59,100 - INFO - 基金公司分析数据更新成功。
2025-05-12 13:22:59,100 - INFO - 基金公司分析表: 54条记录
2025-05-12 13:31:46,634 - INFO - === 开始导入所有ETF数据 ===
2025-05-12 13:31:46,637 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-12 13:31:46,637 - INFO - 开始导入ETF基本信息...
2025-05-12 13:31:46,639 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 13:31:46,639 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:31:49,242 - INFO - 成功导入ETF基本信息，共1157条记录
2025-05-12 13:31:49,242 - INFO - 开始导入ETF价格数据...
2025-05-12 13:31:49,243 - INFO - 使用文件: data/ETF_DATA_20250509.xlsx
2025-05-12 13:31:49,243 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:31:49,754 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-12 13:31:49,755 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-12 13:31:49,757 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-12 13:31:49,781 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.3918  深圳证券交易所  ...    0.0020           0.0010                 0.0010  2025-05-09  2025-05-12 13:31:49
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1507  深圳证券交易所  ...    1.3944           0.0008                 0.0790  2025-05-09  2025-05-12 13:31:49
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0082  深圳证券交易所  ...    1.1278          -0.0019                -0.1789  2025-05-09  2025-05-12 13:31:49
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4603  深圳证券交易所  ...    0.4950          -0.0018                -0.1769  2025-05-09  2025-05-12 13:31:49
4  159531   中证2000ETF              中证2000指数收益率        1.6795  深圳证券交易所  ...    1.9928           0.0008                 0.0736  2025-05-09  2025-05-12 13:31:49

[5 rows x 39 columns]
2025-05-12 13:31:49,818 - INFO - 成功导入ETF价格数据，共1157条记录
2025-05-12 13:31:49,819 - INFO - 开始导入ETF持有人数据...
2025-05-12 13:31:49,820 - INFO - 使用文件: data/客户ETF保有量20250509.xlsx
2025-05-12 13:31:49,820 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:31:49,883 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-12 13:31:49,894 - INFO - 原始列名: ['数据截止日期']
2025-05-12 13:31:49,894 - INFO - 数据形状: (0, 1)
2025-05-12 13:31:49,895 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 13:31:49,895 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 13:31:50,003 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-12 13:31:50,009 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-12 13:31:50,011 - INFO - 成功读取数据，形状: (1124, 6)
2025-05-12 13:31:50,013 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-12 13:31:50,018 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250509  159001       货币ETF         98804.0            11     9880400.00  2025-05-09
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-05-09
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-05-09
3      None  159150  深证50ETF易方达       1662760.0            36     1900534.65  2025-05-09
4      None  159201    自由现金流ETF      24309703.0           561    23604721.60  2025-05-09
2025-05-12 13:31:50,088 - INFO - 成功导入ETF持有人数据，共1124条记录
2025-05-12 13:31:50,089 - INFO - 开始导入ETF自选数据...
2025-05-12 13:31:50,089 - INFO - 使用文件: data/客户ETF自选人数20250509.xlsx
2025-05-12 13:31:50,090 - INFO - 从文件名中提取的日期: 2025-05-09
2025-05-12 13:31:50,116 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-12 13:31:50,140 - INFO - 原始列名: ['数据截止日期']
2025-05-12 13:31:50,140 - INFO - 数据形状: (0, 1)
2025-05-12 13:31:50,141 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-12 13:31:50,141 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-12 13:31:50,201 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-12 13:31:50,204 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-12 13:31:50,205 - INFO - 成功读取数据，形状: (1141, 3)
2025-05-12 13:31:50,205 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-12 13:31:50,205 - INFO - 找到的代码列: ['标的代码']
2025-05-12 13:31:50,205 - INFO - 找到的自选列: ['加自选人数']
2025-05-12 13:31:50,207 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-12 13:31:50,210 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250509  159001              101  2025-05-09
1      None  159003               98  2025-05-09
2      None  159005               46  2025-05-09
3      None  159150              247  2025-05-09
4      None  159201              930  2025-05-09
2025-05-12 13:31:50,266 - INFO - 成功导入ETF自选数据，共1141条记录
2025-05-12 13:31:50,267 - INFO - 开始导入ETF指数分类数据...
2025-05-12 13:31:50,268 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-12 13:31:50,320 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-12 13:31:50,320 - INFO - 开始导入ETF商务协议数据...
2025-05-12 13:31:50,320 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-12 13:31:50,420 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-12 13:31:50,420 - INFO - === ETF数据导入完成 ===
2025-05-12 13:31:50,420 - INFO - ETF基本信息: 成功
2025-05-12 13:31:50,421 - INFO - ETF价格数据: 成功
2025-05-12 13:31:50,421 - INFO - ETF持有人数据: 成功
2025-05-12 13:31:50,421 - INFO - ETF自选数据: 成功
2025-05-12 13:31:50,421 - INFO - ETF指数分类数据: 成功
2025-05-12 13:31:50,421 - INFO - ETF商务协议数据: 成功
2025-05-12 13:31:50,421 - INFO - === 数据库记录统计 ===
2025-05-12 13:31:50,421 - INFO - ETF基本信息表: 1157条记录
2025-05-12 13:31:50,421 - INFO - ETF价格数据表: 1157条记录
2025-05-12 13:31:50,421 - INFO - ETF持有人数据表: 1124条记录
2025-05-12 13:31:50,421 - INFO - ETF自选数据表: 1141条记录
2025-05-12 13:31:50,421 - INFO - ETF商务协议数据表: 341条记录
2025-05-12 13:31:50,421 - INFO - 开始更新基金公司分析数据...
2025-05-12 13:31:50,577 - INFO - 基金公司分析数据更新成功。
2025-05-12 13:31:50,578 - INFO - 基金公司分析表: 54条记录
2025-05-13 08:12:30,511 - INFO - === 开始导入所有ETF数据 ===
2025-05-13 08:12:30,513 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-13 08:12:30,513 - INFO - 开始导入ETF基本信息...
2025-05-13 08:12:30,516 - INFO - 使用文件: data/ETF_DATA_20250512.xlsx
2025-05-13 08:12:30,516 - INFO - 从文件名中提取的日期: 2025-05-12
2025-05-13 08:12:31,289 - INFO - 成功导入ETF基本信息，共1159条记录
2025-05-13 08:12:31,290 - INFO - 开始导入ETF价格数据...
2025-05-13 08:12:31,290 - INFO - 使用文件: data/ETF_DATA_20250512.xlsx
2025-05-13 08:12:31,290 - INFO - 从文件名中提取的日期: 2025-05-12
2025-05-13 08:12:31,795 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-13 08:12:31,795 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-13 08:12:31,797 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-13 08:12:31,821 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.8575  上海证券交易所  ...    0.9577          -0.0016                -0.1259  2025-05-12  2025-05-13 08:12:31
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3945  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-12  2025-05-13 08:12:31
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1534  深圳证券交易所  ...    3.8500          -0.0040                -0.4090  2025-05-12  2025-05-13 08:12:31
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0110  深圳证券交易所  ...    1.7925           0.0001                 0.0096  2025-05-12  2025-05-13 08:12:31
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4630  深圳证券交易所  ...    0.6890          -0.0052                -0.5097  2025-05-12  2025-05-13 08:12:31

[5 rows x 39 columns]
2025-05-13 08:12:31,855 - INFO - 成功导入ETF价格数据，共1159条记录
2025-05-13 08:12:31,855 - INFO - 开始导入ETF持有人数据...
2025-05-13 08:12:31,856 - INFO - 使用文件: data/客户ETF保有量 20250512.xlsx
2025-05-13 08:12:31,856 - INFO - 从文件名中提取的日期: 2025-05-12
2025-05-13 08:12:31,918 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-13 08:12:31,927 - INFO - 原始列名: ['数据截止日期']
2025-05-13 08:12:31,927 - INFO - 数据形状: (0, 1)
2025-05-13 08:12:31,928 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-13 08:12:31,928 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-13 08:12:32,038 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-13 08:12:32,044 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-13 08:12:32,046 - INFO - 成功读取数据，形状: (1128, 6)
2025-05-13 08:12:32,048 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-13 08:12:32,053 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250512  159001       货币ETF         98804.0            11     9880400.00  2025-05-12
1      None  159003     招商快线ETF           853.0             4       85299.15  2025-05-12
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-12
3      None  159150  深证50ETF易方达       1662860.0            37     1928917.60  2025-05-12
4      None  159201    自由现金流ETF      24209003.0           560    23749031.93  2025-05-12
2025-05-13 08:12:32,123 - INFO - 成功导入ETF持有人数据，共1128条记录
2025-05-13 08:12:32,123 - INFO - 开始导入ETF自选数据...
2025-05-13 08:12:32,124 - INFO - 使用文件: data/客户ETF自选人数 20250512.xlsx
2025-05-13 08:12:32,124 - INFO - 从文件名中提取的日期: 2025-05-12
2025-05-13 08:12:32,152 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-13 08:12:32,177 - INFO - 原始列名: ['数据截止日期']
2025-05-13 08:12:32,177 - INFO - 数据形状: (0, 1)
2025-05-13 08:12:32,178 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-13 08:12:32,178 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-13 08:12:32,239 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-13 08:12:32,243 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-13 08:12:32,244 - INFO - 成功读取数据，形状: (1142, 3)
2025-05-13 08:12:32,244 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-13 08:12:32,244 - INFO - 找到的代码列: ['标的代码']
2025-05-13 08:12:32,244 - INFO - 找到的自选列: ['加自选人数']
2025-05-13 08:12:32,246 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-13 08:12:32,249 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250512  159001              101  2025-05-12
1      None  159003               98  2025-05-12
2      None  159005               46  2025-05-12
3      None  159150              247  2025-05-12
4      None  159201              930  2025-05-12
2025-05-13 08:12:32,298 - INFO - 成功导入ETF自选数据，共1142条记录
2025-05-13 08:12:32,298 - INFO - 开始导入ETF指数分类数据...
2025-05-13 08:12:32,298 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-13 08:12:32,348 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-13 08:12:32,348 - INFO - 开始导入ETF商务协议数据...
2025-05-13 08:12:32,348 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-13 08:12:32,450 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-13 08:12:32,451 - INFO - === ETF数据导入完成 ===
2025-05-13 08:12:32,451 - INFO - ETF基本信息: 成功
2025-05-13 08:12:32,451 - INFO - ETF价格数据: 成功
2025-05-13 08:12:32,451 - INFO - ETF持有人数据: 成功
2025-05-13 08:12:32,451 - INFO - ETF自选数据: 成功
2025-05-13 08:12:32,451 - INFO - ETF指数分类数据: 成功
2025-05-13 08:12:32,451 - INFO - ETF商务协议数据: 成功
2025-05-13 08:12:32,452 - INFO - === 数据库记录统计 ===
2025-05-13 08:12:32,452 - INFO - ETF基本信息表: 1159条记录
2025-05-13 08:12:32,452 - INFO - ETF价格数据表: 1159条记录
2025-05-13 08:12:32,452 - INFO - ETF持有人数据表: 1128条记录
2025-05-13 08:12:32,452 - INFO - ETF自选数据表: 1142条记录
2025-05-13 08:12:32,452 - INFO - ETF商务协议数据表: 341条记录
2025-05-13 08:12:32,452 - INFO - 开始更新基金公司分析数据...
2025-05-13 08:12:32,658 - INFO - 基金公司分析数据更新成功。
2025-05-13 08:12:32,658 - INFO - 基金公司分析表: 54条记录
2025-05-14 15:23:45,498 - INFO - === 开始导入所有ETF数据 ===
2025-05-14 15:23:45,499 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-14 15:23:45,500 - INFO - 开始导入ETF基本信息...
2025-05-14 15:23:45,500 - INFO - 使用文件: data/ETF_DATA_20250513.xlsx
2025-05-14 15:23:45,501 - INFO - 从文件名中提取的日期: 2025-05-13
2025-05-14 15:23:46,247 - INFO - 成功导入ETF基本信息，共1163条记录
2025-05-14 15:23:46,247 - INFO - 开始导入ETF价格数据...
2025-05-14 15:23:46,248 - INFO - 使用文件: data/ETF_DATA_20250513.xlsx
2025-05-14 15:23:46,248 - INFO - 从文件名中提取的日期: 2025-05-13
2025-05-14 15:23:46,753 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-14 15:23:46,754 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-14 15:23:46,756 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-14 15:23:46,779 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.8603  上海证券交易所  ...    3.0977           0.0166                 1.3160  2025-05-13  2025-05-14 15:23:46
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.3973  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-13  2025-05-14 15:23:46
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1562  深圳证券交易所  ...    1.3198           0.0056                 0.5700  2025-05-13  2025-05-14 15:23:46
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0137  深圳证券交易所  ...    1.5209          -0.0091                -0.8625  2025-05-13  2025-05-14 15:23:46
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4658  深圳证券交易所  ...    1.3659           0.0068                 0.6620  2025-05-13  2025-05-14 15:23:46

[5 rows x 39 columns]
2025-05-14 15:23:46,816 - INFO - 成功导入ETF价格数据，共1163条记录
2025-05-14 15:23:46,817 - INFO - 开始导入ETF持有人数据...
2025-05-14 15:23:46,817 - INFO - 使用文件: data/客户ETF保有量20250513.xlsx
2025-05-14 15:23:46,818 - INFO - 从文件名中提取的日期: 2025-05-13
2025-05-14 15:23:46,878 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-14 15:23:46,890 - INFO - 原始列名: ['数据截止日期']
2025-05-14 15:23:46,890 - INFO - 数据形状: (0, 1)
2025-05-14 15:23:46,891 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-14 15:23:46,891 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-14 15:23:46,999 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-14 15:23:47,004 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-14 15:23:47,007 - INFO - 成功读取数据，形状: (1128, 6)
2025-05-14 15:23:47,009 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-14 15:23:47,014 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250513  159001       货币ETF         98804.0            11     9880400.00  2025-05-13
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-05-13
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-13
3      None  159150  深证50ETF易方达       1672860.0            37     1945536.15  2025-05-13
4      None  159201    自由现金流ETF      24406903.0           551    23967578.73  2025-05-13
2025-05-14 15:23:47,084 - INFO - 成功导入ETF持有人数据，共1128条记录
2025-05-14 15:23:47,085 - INFO - 开始导入ETF自选数据...
2025-05-14 15:23:47,085 - INFO - 使用文件: data/客户ETF自选人数20250513.xlsx
2025-05-14 15:23:47,085 - INFO - 从文件名中提取的日期: 2025-05-13
2025-05-14 15:23:47,112 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-14 15:23:47,135 - INFO - 原始列名: ['数据截止日期']
2025-05-14 15:23:47,136 - INFO - 数据形状: (0, 1)
2025-05-14 15:23:47,136 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-14 15:23:47,136 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-14 15:23:47,194 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-14 15:23:47,198 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-14 15:23:47,198 - INFO - 成功读取数据，形状: (1144, 3)
2025-05-14 15:23:47,198 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-14 15:23:47,199 - INFO - 找到的代码列: ['标的代码']
2025-05-14 15:23:47,199 - INFO - 找到的自选列: ['加自选人数']
2025-05-14 15:23:47,200 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-14 15:23:47,205 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250513  159001              101  2025-05-13
1      None  159003               98  2025-05-13
2      None  159005               46  2025-05-13
3      None  159150              247  2025-05-13
4      None  159201              928  2025-05-13
2025-05-14 15:23:47,260 - INFO - 成功导入ETF自选数据，共1144条记录
2025-05-14 15:23:47,260 - INFO - 开始导入ETF指数分类数据...
2025-05-14 15:23:47,260 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-14 15:23:47,309 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-14 15:23:47,309 - INFO - 开始导入ETF商务协议数据...
2025-05-14 15:23:47,310 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-14 15:23:47,406 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-14 15:23:47,406 - INFO - === ETF数据导入完成 ===
2025-05-14 15:23:47,406 - INFO - ETF基本信息: 成功
2025-05-14 15:23:47,406 - INFO - ETF价格数据: 成功
2025-05-14 15:23:47,406 - INFO - ETF持有人数据: 成功
2025-05-14 15:23:47,407 - INFO - ETF自选数据: 成功
2025-05-14 15:23:47,407 - INFO - ETF指数分类数据: 成功
2025-05-14 15:23:47,407 - INFO - ETF商务协议数据: 成功
2025-05-14 15:23:47,408 - INFO - === 数据库记录统计 ===
2025-05-14 15:23:47,408 - INFO - ETF基本信息表: 1163条记录
2025-05-14 15:23:47,408 - INFO - ETF价格数据表: 1163条记录
2025-05-14 15:23:47,408 - INFO - ETF持有人数据表: 1128条记录
2025-05-14 15:23:47,408 - INFO - ETF自选数据表: 1144条记录
2025-05-14 15:23:47,408 - INFO - ETF商务协议数据表: 341条记录
2025-05-14 15:23:47,408 - INFO - 开始更新基金公司分析数据...
2025-05-14 15:23:47,606 - INFO - 基金公司分析数据更新成功。
2025-05-14 15:23:47,606 - INFO - 基金公司分析表: 54条记录
2025-05-15 11:02:05,935 - INFO - === 开始导入所有ETF数据 ===
2025-05-15 11:02:05,938 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-15 11:02:05,938 - INFO - 开始导入ETF基本信息...
2025-05-15 11:02:05,941 - INFO - 使用文件: data/ETF_DATA_20250514.xlsx
2025-05-15 11:02:05,941 - INFO - 从文件名中提取的日期: 2025-05-14
2025-05-15 11:02:06,817 - INFO - 成功导入ETF基本信息，共1164条记录
2025-05-15 11:02:06,818 - INFO - 开始导入ETF价格数据...
2025-05-15 11:02:06,818 - INFO - 使用文件: data/ETF_DATA_20250514.xlsx
2025-05-15 11:02:06,818 - INFO - 从文件名中提取的日期: 2025-05-14
2025-05-15 11:02:07,341 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-15 11:02:07,341 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-15 11:02:07,343 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-15 11:02:07,367 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF               活期存款利率(税后)       10.4000  深圳证券交易所  ...    0.0010           0.0000                 0.0000  2025-05-14  2025-05-15 11:02:07
1  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1589  深圳证券交易所  ...    1.3198          -0.0041                -0.4133  2025-05-14  2025-05-15 11:02:07
2  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0164  深圳证券交易所  ...    1.5209          -0.0045                -0.4284  2025-05-14  2025-05-15 11:02:07
3  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4685  深圳证券交易所  ...    1.3659           0.0000                 0.0000  2025-05-14  2025-05-15 11:02:07
4  159531   中证2000ETF              中证2000指数收益率        1.6877  深圳证券交易所  ...    1.5455           0.0025                 0.2268  2025-05-14  2025-05-15 11:02:07

[5 rows x 39 columns]
2025-05-15 11:02:07,402 - INFO - 成功导入ETF价格数据，共1164条记录
2025-05-15 11:02:07,403 - INFO - 开始导入ETF持有人数据...
2025-05-15 11:02:07,403 - INFO - 使用文件: data/客户ETF保有量20250514.xlsx
2025-05-15 11:02:07,404 - INFO - 从文件名中提取的日期: 2025-05-14
2025-05-15 11:02:07,469 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-15 11:02:07,478 - INFO - 原始列名: ['数据截止日期']
2025-05-15 11:02:07,478 - INFO - 数据形状: (0, 1)
2025-05-15 11:02:07,479 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-15 11:02:07,479 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-15 11:02:07,591 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-15 11:02:07,597 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-15 11:02:07,599 - INFO - 成功读取数据，形状: (1130, 6)
2025-05-15 11:02:07,601 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-15 11:02:07,606 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250514  159001       货币ETF         98904.0            12     9890400.00  2025-05-14
1      None  159003     招商快线ETF           853.0             4       85300.00  2025-05-14
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-14
3      None  159150  深证50ETF易方达       1672860.0            37     1960591.92  2025-05-14
4      None  159201    自由现金流ETF      23958303.0           543    23718719.97  2025-05-14
2025-05-15 11:02:07,681 - INFO - 成功导入ETF持有人数据，共1130条记录
2025-05-15 11:02:07,681 - INFO - 开始导入ETF自选数据...
2025-05-15 11:02:07,682 - INFO - 使用文件: data/客户ETF自选人数20250514.xlsx
2025-05-15 11:02:07,682 - INFO - 从文件名中提取的日期: 2025-05-14
2025-05-15 11:02:07,709 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-15 11:02:07,734 - INFO - 原始列名: ['数据截止日期']
2025-05-15 11:02:07,734 - INFO - 数据形状: (0, 1)
2025-05-15 11:02:07,735 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-15 11:02:07,735 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-15 11:02:07,794 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-15 11:02:07,797 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-15 11:02:07,798 - INFO - 成功读取数据，形状: (1145, 3)
2025-05-15 11:02:07,798 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-15 11:02:07,798 - INFO - 找到的代码列: ['标的代码']
2025-05-15 11:02:07,798 - INFO - 找到的自选列: ['加自选人数']
2025-05-15 11:02:07,800 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-15 11:02:07,803 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250514  159001              101  2025-05-14
1      None  159003               98  2025-05-14
2      None  159005               46  2025-05-14
3      None  159150              247  2025-05-14
4      None  159201              933  2025-05-14
2025-05-15 11:02:07,857 - INFO - 成功导入ETF自选数据，共1145条记录
2025-05-15 11:02:07,857 - INFO - 开始导入ETF指数分类数据...
2025-05-15 11:02:07,858 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-15 11:02:07,908 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-15 11:02:07,908 - INFO - 开始导入ETF商务协议数据...
2025-05-15 11:02:07,909 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-15 11:02:08,007 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-15 11:02:08,007 - INFO - === ETF数据导入完成 ===
2025-05-15 11:02:08,007 - INFO - ETF基本信息: 成功
2025-05-15 11:02:08,007 - INFO - ETF价格数据: 成功
2025-05-15 11:02:08,007 - INFO - ETF持有人数据: 成功
2025-05-15 11:02:08,007 - INFO - ETF自选数据: 成功
2025-05-15 11:02:08,007 - INFO - ETF指数分类数据: 成功
2025-05-15 11:02:08,007 - INFO - ETF商务协议数据: 成功
2025-05-15 11:02:08,008 - INFO - === 数据库记录统计 ===
2025-05-15 11:02:08,008 - INFO - ETF基本信息表: 1164条记录
2025-05-15 11:02:08,008 - INFO - ETF价格数据表: 1164条记录
2025-05-15 11:02:08,008 - INFO - ETF持有人数据表: 1130条记录
2025-05-15 11:02:08,008 - INFO - ETF自选数据表: 1145条记录
2025-05-15 11:02:08,008 - INFO - ETF商务协议数据表: 341条记录
2025-05-15 11:02:08,008 - INFO - 开始更新基金公司分析数据...
2025-05-15 11:02:08,164 - INFO - 基金公司分析数据更新成功。
2025-05-15 11:02:08,164 - INFO - 基金公司分析表: 54条记录
2025-05-16 15:43:46,507 - INFO - === 开始导入所有ETF数据 ===
2025-05-16 15:43:46,510 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-16 15:43:46,511 - INFO - 开始导入ETF基本信息...
2025-05-16 15:43:46,514 - INFO - 使用文件: data/ETF_DATA_20250515.xlsx
2025-05-16 15:43:46,514 - INFO - 从文件名中提取的日期: 2025-05-15
2025-05-16 15:43:47,291 - INFO - 成功导入ETF基本信息，共1164条记录
2025-05-16 15:43:47,291 - INFO - 开始导入ETF价格数据...
2025-05-16 15:43:47,292 - INFO - 使用文件: data/ETF_DATA_20250515.xlsx
2025-05-16 15:43:47,292 - INFO - 从文件名中提取的日期: 2025-05-15
2025-05-16 15:43:47,811 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-16 15:43:47,811 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-16 15:43:47,813 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-16 15:43:47,835 - INFO - 数据示例:
     code        证券简称                   业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010       电信ETF              中证电信主题指数收益率        1.8658  上海证券交易所  ...    1.9562           0.0010                 0.0797  2025-05-15  2025-05-16 15:43:47
1  159005    汇添富快钱ETF               活期存款利率(税后)       10.4027  深圳证券交易所  ...    0.0020           0.0000                 0.0000  2025-05-15  2025-05-16 15:43:47
2  159316    恒生创新药ETF  恒生港股通创新药指数收益率(使用估值汇率折算)        0.1616  深圳证券交易所  ...    1.2146           0.0019                 0.1931  2025-05-15  2025-05-16 15:43:47
3  159321     黄金股票ETF         中证沪深港黄金产业股票指数收益率        1.0192  深圳证券交易所  ...    1.1472          -0.0029                -0.2794  2025-05-15  2025-05-16 15:43:47
4  159355  800红利低波ETF          中证800红利低波动指数收益率        0.4712  深圳证券交易所  ...    0.5803          -0.0016                -0.1551  2025-05-15  2025-05-16 15:43:47

[5 rows x 39 columns]
2025-05-16 15:43:47,872 - INFO - 成功导入ETF价格数据，共1164条记录
2025-05-16 15:43:47,872 - INFO - 开始导入ETF持有人数据...
2025-05-16 15:43:47,873 - INFO - 使用文件: data/客户ETF保有量20250515.xlsx
2025-05-16 15:43:47,873 - INFO - 从文件名中提取的日期: 2025-05-15
2025-05-16 15:43:47,934 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-16 15:43:47,943 - INFO - 原始列名: ['数据截止日期']
2025-05-16 15:43:47,943 - INFO - 数据形状: (0, 1)
2025-05-16 15:43:47,944 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-16 15:43:47,944 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-16 15:43:48,053 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-16 15:43:48,059 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-16 15:43:48,061 - INFO - 成功读取数据，形状: (1133, 6)
2025-05-16 15:43:48,063 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-16 15:43:48,068 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250515  159001       货币ETF         78904.0            11   7.890321e+06  2025-05-15
1      None  159003     招商快线ETF           853.0             4   8.530000e+04  2025-05-15
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-15
3      None  159150  深证50ETF易方达       1662860.0            37   1.925592e+06  2025-05-15
4      None  159201    自由现金流ETF      24133303.0           545   2.369890e+07  2025-05-15
2025-05-16 15:43:48,144 - INFO - 成功导入ETF持有人数据，共1133条记录
2025-05-16 15:43:48,144 - INFO - 开始导入ETF自选数据...
2025-05-16 15:43:48,145 - INFO - 使用文件: data/客户ETF自选人数20250515.xlsx
2025-05-16 15:43:48,145 - INFO - 从文件名中提取的日期: 2025-05-15
2025-05-16 15:43:48,172 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-16 15:43:48,181 - INFO - 原始列名: ['数据截止日期']
2025-05-16 15:43:48,181 - INFO - 数据形状: (0, 1)
2025-05-16 15:43:48,181 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-16 15:43:48,181 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-16 15:43:48,259 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-16 15:43:48,262 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-16 15:43:48,263 - INFO - 成功读取数据，形状: (1146, 3)
2025-05-16 15:43:48,263 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-16 15:43:48,263 - INFO - 找到的代码列: ['标的代码']
2025-05-16 15:43:48,263 - INFO - 找到的自选列: ['加自选人数']
2025-05-16 15:43:48,265 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-16 15:43:48,269 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250515  159001              102  2025-05-15
1      None  159003               99  2025-05-15
2      None  159005               46  2025-05-15
3      None  159150              246  2025-05-15
4      None  159201              930  2025-05-15
2025-05-16 15:43:48,335 - INFO - 成功导入ETF自选数据，共1146条记录
2025-05-16 15:43:48,335 - INFO - 开始导入ETF指数分类数据...
2025-05-16 15:43:48,336 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-16 15:43:48,392 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-16 15:43:48,393 - INFO - 开始导入ETF商务协议数据...
2025-05-16 15:43:48,393 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-16 15:43:48,491 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-16 15:43:48,492 - INFO - === ETF数据导入完成 ===
2025-05-16 15:43:48,492 - INFO - ETF基本信息: 成功
2025-05-16 15:43:48,492 - INFO - ETF价格数据: 成功
2025-05-16 15:43:48,492 - INFO - ETF持有人数据: 成功
2025-05-16 15:43:48,492 - INFO - ETF自选数据: 成功
2025-05-16 15:43:48,492 - INFO - ETF指数分类数据: 成功
2025-05-16 15:43:48,492 - INFO - ETF商务协议数据: 成功
2025-05-16 15:43:48,492 - INFO - === 数据库记录统计 ===
2025-05-16 15:43:48,492 - INFO - ETF基本信息表: 1164条记录
2025-05-16 15:43:48,492 - INFO - ETF价格数据表: 1164条记录
2025-05-16 15:43:48,493 - INFO - ETF持有人数据表: 1133条记录
2025-05-16 15:43:48,493 - INFO - ETF自选数据表: 1146条记录
2025-05-16 15:43:48,493 - INFO - ETF商务协议数据表: 341条记录
2025-05-16 15:43:48,493 - INFO - 开始更新基金公司分析数据...
2025-05-16 15:43:48,662 - INFO - 基金公司分析数据更新成功。
2025-05-16 15:43:48,663 - INFO - 基金公司分析表: 54条记录
2025-05-19 14:36:00,412 - INFO - === 开始导入所有ETF数据 ===
2025-05-19 14:36:00,414 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-19 14:36:00,414 - INFO - 开始导入ETF基本信息...
2025-05-19 14:36:00,416 - INFO - 使用文件: data/ETF_DATA_20250516.xlsx
2025-05-19 14:36:00,416 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:36:06,442 - ERROR - 导入ETF基本信息失败
2025-05-19 14:36:06,444 - INFO - 开始导入ETF价格数据...
2025-05-19 14:36:06,446 - INFO - 使用文件: data/ETF_DATA_20250516.xlsx
2025-05-19 14:36:06,446 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:36:07,036 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-19 14:36:07,037 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-19 14:36:07,039 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-19 14:36:07,072 - INFO - 数据示例:
     code        证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF        活期存款利率(税后)       10.4110  深圳证券交易所  2014-12-23  ...     100.001     0.0010            0.0010                 0.0010  2025-05-16  2025-05-19 14:36:07
1  159321     黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0274  深圳证券交易所  2024-05-09  ...       1.040     1.7391           -0.0013                -0.1248  2025-05-16  2025-05-19 14:36:07
2  159355  800红利低波ETF   中证800红利低波动指数收益率        0.4795  深圳证券交易所  2024-11-25  ...       1.024     0.9709           -0.0009                -0.0878  2025-05-16  2025-05-19 14:36:07
3  159526    机器人指数ETF        中证机器人指数收益率        1.0904  深圳证券交易所  2024-04-16  ...       1.275     2.2013           -0.0027                -0.2113  2025-05-16  2025-05-19 14:36:07
4  159531   中证2000ETF       中证2000指数收益率        1.6986  深圳证券交易所  2023-09-07  ...       1.097     2.2018           -0.0010                -0.0911  2025-05-16  2025-05-19 14:36:07

[5 rows x 39 columns]
2025-05-19 14:36:12,281 - ERROR - 导入ETF价格数据失败
2025-05-19 14:36:12,289 - INFO - 开始导入ETF持有人数据...
2025-05-19 14:36:12,299 - INFO - 使用文件: data/客户ETF保有量20250516.xlsx
2025-05-19 14:36:12,299 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:36:12,398 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-19 14:36:12,419 - INFO - 原始列名: ['数据截止日期']
2025-05-19 14:36:12,419 - INFO - 数据形状: (0, 1)
2025-05-19 14:36:12,420 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-19 14:36:12,420 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-19 14:36:12,536 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-19 14:36:12,543 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-19 14:36:12,546 - INFO - 成功读取数据，形状: (1135, 6)
2025-05-19 14:36:12,551 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-19 14:36:12,558 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250516  159001       货币ETF         78904.0            11   7.890479e+06  2025-05-16
1      None  159003     招商快线ETF           753.0             3   7.530075e+04  2025-05-16
2      None  159005    汇添富快钱ETF          1300.0            12   1.300013e+05  2025-05-16
3      None  159150  深证50ETF易方达       1662860.0            37   1.925592e+06  2025-05-16
4      None  159201    自由现金流ETF      24072403.0           541   2.356688e+07  2025-05-16
2025-05-19 14:36:17,788 - ERROR - 导入ETF持有人数据失败
2025-05-19 14:36:17,795 - INFO - 开始导入ETF自选数据...
2025-05-19 14:36:17,799 - INFO - 使用文件: data/客户ETF自选人数20250516.xlsx
2025-05-19 14:36:17,800 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:36:17,875 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-19 14:36:17,897 - INFO - 原始列名: ['数据截止日期']
2025-05-19 14:36:17,897 - INFO - 数据形状: (0, 1)
2025-05-19 14:36:17,898 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-19 14:36:17,898 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-19 14:36:17,999 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-19 14:36:18,003 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-19 14:36:18,004 - INFO - 成功读取数据，形状: (1147, 3)
2025-05-19 14:36:18,004 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-19 14:36:18,004 - INFO - 找到的代码列: ['标的代码']
2025-05-19 14:36:18,004 - INFO - 找到的自选列: ['加自选人数']
2025-05-19 14:36:18,006 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-19 14:36:18,010 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250516  159001              101  2025-05-16
1      None  159003               99  2025-05-16
2      None  159005               46  2025-05-16
3      None  159150              245  2025-05-16
4      None  159201              933  2025-05-16
2025-05-19 14:36:23,284 - ERROR - 导入ETF自选数据失败
2025-05-19 14:36:23,292 - INFO - 开始导入ETF指数分类数据...
2025-05-19 14:36:23,300 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-19 14:36:28,580 - ERROR - 导入ETF指数分类数据失败
2025-05-19 14:36:28,583 - INFO - 开始导入ETF商务协议数据...
2025-05-19 14:36:28,589 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-19 14:36:33,951 - ERROR - 导入ETF商务协议数据失败
2025-05-19 14:36:33,959 - INFO - === ETF数据导入完成 ===
2025-05-19 14:36:33,960 - INFO - ETF基本信息: 失败
2025-05-19 14:36:33,960 - INFO - ETF价格数据: 失败
2025-05-19 14:36:33,961 - INFO - ETF持有人数据: 失败
2025-05-19 14:36:33,965 - INFO - ETF自选数据: 失败
2025-05-19 14:36:33,966 - INFO - ETF指数分类数据: 失败
2025-05-19 14:36:33,966 - INFO - ETF商务协议数据: 失败
2025-05-19 14:36:33,998 - INFO - === 数据库记录统计 ===
2025-05-19 14:36:34,000 - INFO - ETF基本信息表: 1164条记录
2025-05-19 14:36:34,001 - INFO - ETF价格数据表: 1164条记录
2025-05-19 14:36:34,001 - INFO - ETF持有人数据表: 1133条记录
2025-05-19 14:36:34,001 - INFO - ETF自选数据表: 1146条记录
2025-05-19 14:36:34,001 - INFO - ETF商务协议数据表: 341条记录
2025-05-19 14:36:34,001 - INFO - 开始更新基金公司分析数据...
2025-05-19 14:36:39,205 - ERROR - 基金公司分析数据更新失败。
2025-05-19 14:37:24,225 - INFO - === 开始导入所有ETF数据 ===
2025-05-19 14:37:24,228 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-19 14:37:24,228 - INFO - 开始导入ETF基本信息...
2025-05-19 14:37:24,233 - INFO - 使用文件: data/ETF_DATA_20250516.xlsx
2025-05-19 14:37:24,234 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:37:25,207 - INFO - 成功导入ETF基本信息，共1164条记录
2025-05-19 14:37:25,207 - INFO - 开始导入ETF价格数据...
2025-05-19 14:37:25,208 - INFO - 使用文件: data/ETF_DATA_20250516.xlsx
2025-05-19 14:37:25,208 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:37:25,732 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-19 14:37:25,733 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-19 14:37:25,735 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-19 14:37:25,757 - INFO - 数据示例:
     code        证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF        活期存款利率(税后)       10.4110  深圳证券交易所  2014-12-23  ...     100.001     0.0010            0.0010                 0.0010  2025-05-16  2025-05-19 14:37:25
1  159321     黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0274  深圳证券交易所  2024-05-09  ...       1.040     1.7391           -0.0013                -0.1248  2025-05-16  2025-05-19 14:37:25
2  159355  800红利低波ETF   中证800红利低波动指数收益率        0.4795  深圳证券交易所  2024-11-25  ...       1.024     0.9709           -0.0009                -0.0878  2025-05-16  2025-05-19 14:37:25
3  159526    机器人指数ETF        中证机器人指数收益率        1.0904  深圳证券交易所  2024-04-16  ...       1.275     2.2013           -0.0027                -0.2113  2025-05-16  2025-05-19 14:37:25
4  159531   中证2000ETF       中证2000指数收益率        1.6986  深圳证券交易所  2023-09-07  ...       1.097     2.2018           -0.0010                -0.0911  2025-05-16  2025-05-19 14:37:25

[5 rows x 39 columns]
2025-05-19 14:37:25,813 - INFO - 成功导入ETF价格数据，共1164条记录
2025-05-19 14:37:25,813 - INFO - 开始导入ETF持有人数据...
2025-05-19 14:37:25,814 - INFO - 使用文件: data/客户ETF保有量20250516.xlsx
2025-05-19 14:37:25,814 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:37:25,879 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-19 14:37:25,888 - INFO - 原始列名: ['数据截止日期']
2025-05-19 14:37:25,888 - INFO - 数据形状: (0, 1)
2025-05-19 14:37:25,889 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-19 14:37:25,889 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-19 14:37:26,010 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-19 14:37:26,016 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-19 14:37:26,018 - INFO - 成功读取数据，形状: (1135, 6)
2025-05-19 14:37:26,021 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-19 14:37:26,026 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250516  159001       货币ETF         78904.0            11   7.890479e+06  2025-05-16
1      None  159003     招商快线ETF           753.0             3   7.530075e+04  2025-05-16
2      None  159005    汇添富快钱ETF          1300.0            12   1.300013e+05  2025-05-16
3      None  159150  深证50ETF易方达       1662860.0            37   1.925592e+06  2025-05-16
4      None  159201    自由现金流ETF      24072403.0           541   2.356688e+07  2025-05-16
2025-05-19 14:37:26,113 - INFO - 成功导入ETF持有人数据，共1135条记录
2025-05-19 14:37:26,114 - INFO - 开始导入ETF自选数据...
2025-05-19 14:37:26,114 - INFO - 使用文件: data/客户ETF自选人数20250516.xlsx
2025-05-19 14:37:26,114 - INFO - 从文件名中提取的日期: 2025-05-16
2025-05-19 14:37:26,145 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-19 14:37:26,154 - INFO - 原始列名: ['数据截止日期']
2025-05-19 14:37:26,154 - INFO - 数据形状: (0, 1)
2025-05-19 14:37:26,155 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-19 14:37:26,155 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-19 14:37:26,218 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-19 14:37:26,238 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-19 14:37:26,239 - INFO - 成功读取数据，形状: (1147, 3)
2025-05-19 14:37:26,239 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-19 14:37:26,239 - INFO - 找到的代码列: ['标的代码']
2025-05-19 14:37:26,239 - INFO - 找到的自选列: ['加自选人数']
2025-05-19 14:37:26,241 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-19 14:37:26,245 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250516  159001              101  2025-05-16
1      None  159003               99  2025-05-16
2      None  159005               46  2025-05-16
3      None  159150              245  2025-05-16
4      None  159201              933  2025-05-16
2025-05-19 14:37:26,309 - INFO - 成功导入ETF自选数据，共1147条记录
2025-05-19 14:37:26,310 - INFO - 开始导入ETF指数分类数据...
2025-05-19 14:37:26,310 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-19 14:37:26,364 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-19 14:37:26,364 - INFO - 开始导入ETF商务协议数据...
2025-05-19 14:37:26,365 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-19 14:37:26,470 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-19 14:37:26,470 - INFO - === ETF数据导入完成 ===
2025-05-19 14:37:26,470 - INFO - ETF基本信息: 成功
2025-05-19 14:37:26,470 - INFO - ETF价格数据: 成功
2025-05-19 14:37:26,470 - INFO - ETF持有人数据: 成功
2025-05-19 14:37:26,471 - INFO - ETF自选数据: 成功
2025-05-19 14:37:26,471 - INFO - ETF指数分类数据: 成功
2025-05-19 14:37:26,471 - INFO - ETF商务协议数据: 成功
2025-05-19 14:37:26,471 - INFO - === 数据库记录统计 ===
2025-05-19 14:37:26,471 - INFO - ETF基本信息表: 1164条记录
2025-05-19 14:37:26,471 - INFO - ETF价格数据表: 1164条记录
2025-05-19 14:37:26,471 - INFO - ETF持有人数据表: 1135条记录
2025-05-19 14:37:26,471 - INFO - ETF自选数据表: 1147条记录
2025-05-19 14:37:26,471 - INFO - ETF商务协议数据表: 341条记录
2025-05-19 14:37:26,471 - INFO - 开始更新基金公司分析数据...
2025-05-19 14:37:26,616 - INFO - 基金公司分析数据更新成功。
2025-05-19 14:37:26,616 - INFO - 基金公司分析表: 54条记录
2025-05-20 08:25:37,779 - INFO - === 开始导入所有ETF数据 ===
2025-05-20 08:25:37,788 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-20 08:25:37,789 - INFO - 开始导入ETF基本信息...
2025-05-20 08:25:37,803 - INFO - 使用文件: data/ETF_DATA_20250519.xlsx
2025-05-20 08:25:37,803 - INFO - 从文件名中提取的日期: 2025-05-19
2025-05-20 08:25:40,597 - INFO - 成功导入ETF基本信息，共1166条记录
2025-05-20 08:25:40,598 - INFO - 开始导入ETF价格数据...
2025-05-20 08:25:40,598 - INFO - 使用文件: data/ETF_DATA_20250519.xlsx
2025-05-20 08:25:40,598 - INFO - 从文件名中提取的日期: 2025-05-19
2025-05-20 08:25:41,126 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-20 08:25:41,127 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-20 08:25:41,128 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-20 08:25:41,406 - INFO - 数据示例:
     code        证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  563010       电信ETF       中证电信主题指数收益率        1.8767  上海证券交易所  2023-07-05  ...       1.252     0.9592            0.0005                 0.0400  2025-05-19  2025-05-20 08:25:41
1  159005    汇添富快钱ETF        活期存款利率(税后)       10.4137  深圳证券交易所  2014-12-23  ...     100.000     0.0010            0.0000                 0.0000  2025-05-19  2025-05-20 08:25:41
2  159321     黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0301  深圳证券交易所  2024-05-09  ...       1.043     1.2500           -0.0002                -0.0192  2025-05-19  2025-05-20 08:25:41
3  159355  800红利低波ETF   中证800红利低波动指数收益率        0.4822  深圳证券交易所  2024-11-25  ...       1.025     0.6836           -0.0019                -0.1850  2025-05-19  2025-05-20 08:25:41
4  159526    机器人指数ETF        中证机器人指数收益率        1.0932  深圳证券交易所  2024-04-16  ...       1.270     2.0392            0.0001                 0.0079  2025-05-19  2025-05-20 08:25:41

[5 rows x 39 columns]
2025-05-20 08:25:41,577 - INFO - 成功导入ETF价格数据，共1166条记录
2025-05-20 08:25:41,578 - INFO - 开始导入ETF持有人数据...
2025-05-20 08:25:41,579 - INFO - 使用文件: data/客户ETF保有量20250519.xlsx
2025-05-20 08:25:41,580 - INFO - 从文件名中提取的日期: 2025-05-19
2025-05-20 08:25:41,657 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-20 08:25:41,670 - INFO - 原始列名: ['数据截止日期']
2025-05-20 08:25:41,670 - INFO - 数据形状: (0, 1)
2025-05-20 08:25:41,671 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-20 08:25:41,671 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-20 08:25:41,791 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-20 08:25:41,797 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-20 08:25:41,800 - INFO - 成功读取数据，形状: (1136, 6)
2025-05-20 08:25:41,803 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-20 08:25:41,808 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250519  159001       货币ETF         79004.0            12     7900400.00  2025-05-19
1      None  159003     招商快线ETF           753.0             3       75300.00  2025-05-19
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-19
3      None  159150  深证50ETF易方达       1662860.0            37     1920603.36  2025-05-19
4      None  159201    自由现金流ETF      24129203.0           542    23743135.71  2025-05-19
2025-05-20 08:25:41,900 - INFO - 成功导入ETF持有人数据，共1136条记录
2025-05-20 08:25:41,900 - INFO - 开始导入ETF自选数据...
2025-05-20 08:25:41,901 - INFO - 使用文件: data/客户ETF自选人数20250519.xlsx
2025-05-20 08:25:41,901 - INFO - 从文件名中提取的日期: 2025-05-19
2025-05-20 08:25:41,932 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-20 08:25:41,941 - INFO - 原始列名: ['数据截止日期']
2025-05-20 08:25:41,941 - INFO - 数据形状: (0, 1)
2025-05-20 08:25:41,941 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-20 08:25:41,941 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-20 08:25:42,044 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-20 08:25:42,049 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-20 08:25:42,050 - INFO - 成功读取数据，形状: (1148, 3)
2025-05-20 08:25:42,050 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-20 08:25:42,050 - INFO - 找到的代码列: ['标的代码']
2025-05-20 08:25:42,050 - INFO - 找到的自选列: ['加自选人数']
2025-05-20 08:25:42,053 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-20 08:25:42,057 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250519  159001              101  2025-05-19
1      None  159003               99  2025-05-19
2      None  159005               46  2025-05-19
3      None  159150              245  2025-05-19
4      None  159201              937  2025-05-19
2025-05-20 08:25:42,136 - INFO - 成功导入ETF自选数据，共1148条记录
2025-05-20 08:25:42,137 - INFO - 开始导入ETF指数分类数据...
2025-05-20 08:25:42,137 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-20 08:25:42,191 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-20 08:25:42,191 - INFO - 开始导入ETF商务协议数据...
2025-05-20 08:25:42,191 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-20 08:25:42,294 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-20 08:25:42,295 - INFO - === ETF数据导入完成 ===
2025-05-20 08:25:42,295 - INFO - ETF基本信息: 成功
2025-05-20 08:25:42,295 - INFO - ETF价格数据: 成功
2025-05-20 08:25:42,295 - INFO - ETF持有人数据: 成功
2025-05-20 08:25:42,295 - INFO - ETF自选数据: 成功
2025-05-20 08:25:42,295 - INFO - ETF指数分类数据: 成功
2025-05-20 08:25:42,295 - INFO - ETF商务协议数据: 成功
2025-05-20 08:25:42,296 - INFO - === 数据库记录统计 ===
2025-05-20 08:25:42,296 - INFO - ETF基本信息表: 1166条记录
2025-05-20 08:25:42,296 - INFO - ETF价格数据表: 1166条记录
2025-05-20 08:25:42,296 - INFO - ETF持有人数据表: 1136条记录
2025-05-20 08:25:42,296 - INFO - ETF自选数据表: 1148条记录
2025-05-20 08:25:42,296 - INFO - ETF商务协议数据表: 341条记录
2025-05-20 08:25:42,296 - INFO - 开始更新基金公司分析数据...
2025-05-20 08:25:42,450 - INFO - 基金公司分析数据更新成功。
2025-05-20 08:25:42,450 - INFO - 基金公司分析表: 54条记录
2025-05-21 09:32:31,130 - INFO - === 开始导入所有ETF数据 ===
2025-05-21 09:32:31,134 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-21 09:32:31,134 - INFO - 开始导入ETF基本信息...
2025-05-21 09:32:31,137 - INFO - 使用文件: data/ETF_DATA_20250520.xlsx
2025-05-21 09:32:31,138 - INFO - 从文件名中提取的日期: 2025-05-20
2025-05-21 09:32:31,954 - INFO - 成功导入ETF基本信息，共1166条记录
2025-05-21 09:32:31,956 - INFO - 开始导入ETF价格数据...
2025-05-21 09:32:31,957 - INFO - 使用文件: data/ETF_DATA_20250520.xlsx
2025-05-21 09:32:31,957 - INFO - 从文件名中提取的日期: 2025-05-20
2025-05-21 09:32:32,460 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-21 09:32:32,460 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-21 09:32:32,462 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-21 09:32:32,485 - INFO - 数据示例:
     code        证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005    汇添富快钱ETF        活期存款利率(税后)       10.4164  深圳证券交易所  2014-12-23  ...     100.000     0.0010            0.0000                 0.0000  2025-05-20  2025-05-21 09:32:32
1  159321     黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0329  深圳证券交易所  2024-05-09  ...       1.055     1.7258            0.0003                 0.0284  2025-05-20  2025-05-21 09:32:32
2  159355  800红利低波ETF   中证800红利低波动指数收益率        0.4849  深圳证券交易所  2024-11-25  ...       1.029     0.5854           -0.0010                -0.0971  2025-05-20  2025-05-21 09:32:32
3  159526    机器人指数ETF        中证机器人指数收益率        1.0959  深圳证券交易所  2024-04-16  ...       1.274     1.8110           -0.0007                -0.0549  2025-05-20  2025-05-21 09:32:32
4  159531   中证2000ETF       中证2000指数收益率        1.7041  深圳证券交易所  2023-09-07  ...       1.118     1.4453            0.0012                 0.1074  2025-05-20  2025-05-21 09:32:32

[5 rows x 39 columns]
2025-05-21 09:32:32,519 - INFO - 成功导入ETF价格数据，共1166条记录
2025-05-21 09:32:32,519 - INFO - 开始导入ETF持有人数据...
2025-05-21 09:32:32,520 - INFO - 使用文件: data/客户ETF保有量20250520.xlsx
2025-05-21 09:32:32,520 - INFO - 从文件名中提取的日期: 2025-05-20
2025-05-21 09:32:32,582 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-21 09:32:32,591 - INFO - 原始列名: ['数据截止日期']
2025-05-21 09:32:32,591 - INFO - 数据形状: (0, 1)
2025-05-21 09:32:32,592 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-21 09:32:32,592 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-21 09:32:32,699 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-21 09:32:32,705 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-21 09:32:32,707 - INFO - 成功读取数据，形状: (1138, 6)
2025-05-21 09:32:32,709 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-21 09:32:32,714 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250520  159001       货币ETF         78704.0            11     7870400.00  2025-05-20
1      None  159003     招商快线ETF           953.0             4       95300.00  2025-05-20
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-20
3      None  159150  深证50ETF易方达       1662860.0            37     1940557.65  2025-05-20
4      None  159201    自由现金流ETF      23827803.0           531    23589524.97  2025-05-20
2025-05-21 09:32:32,797 - INFO - 成功导入ETF持有人数据，共1138条记录
2025-05-21 09:32:32,797 - INFO - 开始导入ETF自选数据...
2025-05-21 09:32:32,798 - INFO - 使用文件: data/客户ETF自选人数20250520.xlsx
2025-05-21 09:32:32,798 - INFO - 从文件名中提取的日期: 2025-05-20
2025-05-21 09:32:32,825 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-21 09:32:32,834 - INFO - 原始列名: ['数据截止日期']
2025-05-21 09:32:32,834 - INFO - 数据形状: (0, 1)
2025-05-21 09:32:32,834 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-21 09:32:32,834 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-21 09:32:32,909 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-21 09:32:32,912 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-21 09:32:32,913 - INFO - 成功读取数据，形状: (1149, 3)
2025-05-21 09:32:32,913 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-21 09:32:32,913 - INFO - 找到的代码列: ['标的代码']
2025-05-21 09:32:32,913 - INFO - 找到的自选列: ['加自选人数']
2025-05-21 09:32:32,915 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-21 09:32:32,918 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250520  159001              102  2025-05-20
1      None  159003               99  2025-05-20
2      None  159005               46  2025-05-20
3      None  159150              244  2025-05-20
4      None  159201              942  2025-05-20
2025-05-21 09:32:32,985 - INFO - 成功导入ETF自选数据，共1149条记录
2025-05-21 09:32:32,986 - INFO - 开始导入ETF指数分类数据...
2025-05-21 09:32:32,986 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-21 09:32:33,037 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-21 09:32:33,037 - INFO - 开始导入ETF商务协议数据...
2025-05-21 09:32:33,038 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-21 09:32:33,134 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-21 09:32:33,135 - INFO - === ETF数据导入完成 ===
2025-05-21 09:32:33,135 - INFO - ETF基本信息: 成功
2025-05-21 09:32:33,135 - INFO - ETF价格数据: 成功
2025-05-21 09:32:33,135 - INFO - ETF持有人数据: 成功
2025-05-21 09:32:33,135 - INFO - ETF自选数据: 成功
2025-05-21 09:32:33,135 - INFO - ETF指数分类数据: 成功
2025-05-21 09:32:33,135 - INFO - ETF商务协议数据: 成功
2025-05-21 09:32:33,135 - INFO - === 数据库记录统计 ===
2025-05-21 09:32:33,135 - INFO - ETF基本信息表: 1166条记录
2025-05-21 09:32:33,135 - INFO - ETF价格数据表: 1166条记录
2025-05-21 09:32:33,136 - INFO - ETF持有人数据表: 1138条记录
2025-05-21 09:32:33,136 - INFO - ETF自选数据表: 1149条记录
2025-05-21 09:32:33,136 - INFO - ETF商务协议数据表: 341条记录
2025-05-21 09:32:33,136 - INFO - 开始更新基金公司分析数据...
2025-05-21 09:32:33,270 - INFO - 基金公司分析数据更新成功。
2025-05-21 09:32:33,270 - INFO - 基金公司分析表: 54条记录
2025-05-22 11:06:25,018 - INFO - === 开始导入所有ETF数据 ===
2025-05-22 11:06:25,023 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-22 11:06:25,023 - INFO - 开始导入ETF基本信息...
2025-05-22 11:06:25,026 - INFO - 使用文件: data/ETF_DATA_20250521.xlsx
2025-05-22 11:06:25,026 - INFO - 从文件名中提取的日期: 2025-05-21
2025-05-22 11:06:26,112 - INFO - 成功导入ETF基本信息，共1166条记录
2025-05-22 11:06:26,113 - INFO - 开始导入ETF价格数据...
2025-05-22 11:06:26,113 - INFO - 使用文件: data/ETF_DATA_20250521.xlsx
2025-05-22 11:06:26,113 - INFO - 从文件名中提取的日期: 2025-05-21
2025-05-22 11:06:26,645 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-22 11:06:26,646 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-22 11:06:26,647 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-22 11:06:26,670 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)       10.4192  深圳证券交易所  2014-12-23  ...     100.000     0.0020            0.0000                 0.0000  2025-05-21  2025-05-22 11:06:26
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0356  深圳证券交易所  2024-05-09  ...       1.100     3.1280           -0.0013                -0.1180  2025-05-21  2025-05-22 11:06:26
2  159526     机器人指数ETF        中证机器人指数收益率        1.0986  深圳证券交易所  2024-04-16  ...       1.264     1.1774           -0.0003                -0.0237  2025-05-21  2025-05-22 11:06:26
3  159531    中证2000ETF       中证2000指数收益率        1.7068  深圳证券交易所  2023-09-07  ...       1.109     1.1628            0.0010                 0.0903  2025-05-21  2025-05-22 11:06:26
4  159597  创业板成长ETF易方达        创业板成长指数收益率        1.0384  深圳证券交易所  2024-05-08  ...       1.148     0.9624           -0.0004                -0.0348  2025-05-21  2025-05-22 11:06:26

[5 rows x 39 columns]
2025-05-22 11:06:26,707 - INFO - 成功导入ETF价格数据，共1166条记录
2025-05-22 11:06:26,707 - INFO - 开始导入ETF持有人数据...
2025-05-22 11:06:26,708 - INFO - 使用文件: data/客户ETF保有量20250521.xlsx
2025-05-22 11:06:26,708 - INFO - 从文件名中提取的日期: 2025-05-21
2025-05-22 11:06:26,773 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-22 11:06:26,782 - INFO - 原始列名: ['数据截止日期']
2025-05-22 11:06:26,782 - INFO - 数据形状: (0, 1)
2025-05-22 11:06:26,783 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-22 11:06:26,783 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-22 11:06:26,896 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-22 11:06:26,904 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-22 11:06:26,912 - INFO - 成功读取数据，形状: (1139, 6)
2025-05-22 11:06:26,914 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-22 11:06:26,922 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250521  159001       货币ETF         78504.0            11     7850400.00  2025-05-21
1      None  159003     招商快线ETF           953.0             4       95299.05  2025-05-21
2      None  159005    汇添富快钱ETF          1300.0            12      130000.00  2025-05-21
3      None  159150  深证50ETF易方达       1663160.0            38     1950886.65  2025-05-21
4      None  159201    自由现金流ETF      23070803.0           528    23024661.41  2025-05-21
2025-05-22 11:06:27,062 - INFO - 成功导入ETF持有人数据，共1139条记录
2025-05-22 11:06:27,063 - INFO - 开始导入ETF自选数据...
2025-05-22 11:06:27,065 - INFO - 使用文件: data/客户ETF自选人数20250521.xlsx
2025-05-22 11:06:27,065 - INFO - 从文件名中提取的日期: 2025-05-21
2025-05-22 11:06:27,096 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-22 11:06:27,106 - INFO - 原始列名: ['数据截止日期']
2025-05-22 11:06:27,106 - INFO - 数据形状: (0, 1)
2025-05-22 11:06:27,106 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-22 11:06:27,107 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-22 11:06:27,189 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-22 11:06:27,193 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-22 11:06:27,194 - INFO - 成功读取数据，形状: (1150, 3)
2025-05-22 11:06:27,194 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-22 11:06:27,194 - INFO - 找到的代码列: ['标的代码']
2025-05-22 11:06:27,194 - INFO - 找到的自选列: ['加自选人数']
2025-05-22 11:06:27,197 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-22 11:06:27,200 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250521  159001              100  2025-05-21
1      None  159003               99  2025-05-21
2      None  159005               46  2025-05-21
3      None  159150              244  2025-05-21
4      None  159201              951  2025-05-21
2025-05-22 11:06:27,265 - INFO - 成功导入ETF自选数据，共1150条记录
2025-05-22 11:06:27,265 - INFO - 开始导入ETF指数分类数据...
2025-05-22 11:06:27,266 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-22 11:06:27,317 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-22 11:06:27,317 - INFO - 开始导入ETF商务协议数据...
2025-05-22 11:06:27,317 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-22 11:06:27,418 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-22 11:06:27,418 - INFO - === ETF数据导入完成 ===
2025-05-22 11:06:27,419 - INFO - ETF基本信息: 成功
2025-05-22 11:06:27,419 - INFO - ETF价格数据: 成功
2025-05-22 11:06:27,419 - INFO - ETF持有人数据: 成功
2025-05-22 11:06:27,419 - INFO - ETF自选数据: 成功
2025-05-22 11:06:27,419 - INFO - ETF指数分类数据: 成功
2025-05-22 11:06:27,419 - INFO - ETF商务协议数据: 成功
2025-05-22 11:06:27,419 - INFO - === 数据库记录统计 ===
2025-05-22 11:06:27,419 - INFO - ETF基本信息表: 1166条记录
2025-05-22 11:06:27,419 - INFO - ETF价格数据表: 1166条记录
2025-05-22 11:06:27,420 - INFO - ETF持有人数据表: 1139条记录
2025-05-22 11:06:27,420 - INFO - ETF自选数据表: 1150条记录
2025-05-22 11:06:27,420 - INFO - ETF商务协议数据表: 341条记录
2025-05-22 11:06:27,420 - INFO - 开始更新基金公司分析数据...
2025-05-22 11:06:27,666 - INFO - 基金公司分析数据更新成功。
2025-05-22 11:06:27,666 - INFO - 基金公司分析表: 54条记录
2025-05-23 17:07:21,186 - INFO - === 开始导入所有ETF数据 ===
2025-05-23 17:07:21,188 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-23 17:07:21,188 - INFO - 开始导入ETF基本信息...
2025-05-23 17:07:21,190 - INFO - 使用文件: data/ETF_DATA_20250522.xlsx
2025-05-23 17:07:21,190 - INFO - 从文件名中提取的日期: 2025-05-22
2025-05-23 17:07:21,986 - INFO - 成功导入ETF基本信息，共1166条记录
2025-05-23 17:07:21,988 - INFO - 开始导入ETF价格数据...
2025-05-23 17:07:21,988 - INFO - 使用文件: data/ETF_DATA_20250522.xlsx
2025-05-23 17:07:21,989 - INFO - 从文件名中提取的日期: 2025-05-22
2025-05-23 17:07:22,539 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-23 17:07:22,540 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-23 17:07:22,542 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-23 17:07:22,573 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)       10.4219  深圳证券交易所  2014-12-23  ...     100.001     0.0020            0.0010                 0.0010  2025-05-22  2025-05-23 17:07:22
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0384  深圳证券交易所  2024-05-09  ...       1.106     2.8336            0.0067                 0.6095  2025-05-22  2025-05-23 17:07:22
2  159526     机器人指数ETF        中证机器人指数收益率        1.1014  深圳证券交易所  2024-04-16  ...       1.241     2.1514           -0.0120                -0.9577  2025-05-22  2025-05-23 17:07:22
3  159531    中证2000ETF       中证2000指数收益率        1.7096  深圳证券交易所  2023-09-07  ...       1.084     2.0091           -0.0105                -0.9593  2025-05-22  2025-05-23 17:07:22
4  159597  创业板成长ETF易方达        创业板成长指数收益率        1.0411  深圳证券交易所  2024-05-08  ...       1.124     1.9332           -0.0150                -1.3169  2025-05-22  2025-05-23 17:07:22

[5 rows x 39 columns]
2025-05-23 17:07:22,618 - INFO - 成功导入ETF价格数据，共1166条记录
2025-05-23 17:07:22,619 - INFO - 开始导入ETF持有人数据...
2025-05-23 17:07:22,621 - INFO - 使用文件: data/客户ETF保有量20250522.xlsx
2025-05-23 17:07:22,621 - INFO - 从文件名中提取的日期: 2025-05-22
2025-05-23 17:07:22,690 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-23 17:07:22,699 - INFO - 原始列名: ['数据截止日期']
2025-05-23 17:07:22,700 - INFO - 数据形状: (0, 1)
2025-05-23 17:07:22,700 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-23 17:07:22,700 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-23 17:07:22,821 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-23 17:07:22,827 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-23 17:07:22,830 - INFO - 成功读取数据，形状: (1140, 6)
2025-05-23 17:07:22,832 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-23 17:07:22,838 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250522  159001       货币ETF         78504.0            11   7.850479e+06  2025-05-22
1      None  159003     招商快线ETF           953.0             4   9.530000e+04  2025-05-22
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-05-22
3      None  159150  深证50ETF易方达       1660260.0            38   1.939184e+06  2025-05-22
4      None  159201    自由现金流ETF      23119003.0           523   2.298029e+07  2025-05-22
2025-05-23 17:07:22,927 - INFO - 成功导入ETF持有人数据，共1140条记录
2025-05-23 17:07:22,927 - INFO - 开始导入ETF自选数据...
2025-05-23 17:07:22,928 - INFO - 使用文件: data/客户ETF自选人数20250522.xlsx
2025-05-23 17:07:22,928 - INFO - 从文件名中提取的日期: 2025-05-22
2025-05-23 17:07:22,960 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-23 17:07:22,975 - INFO - 原始列名: ['数据截止日期']
2025-05-23 17:07:22,975 - INFO - 数据形状: (0, 1)
2025-05-23 17:07:22,975 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-23 17:07:22,975 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-23 17:07:23,064 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-23 17:07:23,068 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-23 17:07:23,071 - INFO - 成功读取数据，形状: (1150, 3)
2025-05-23 17:07:23,072 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-23 17:07:23,072 - INFO - 找到的代码列: ['标的代码']
2025-05-23 17:07:23,072 - INFO - 找到的自选列: ['加自选人数']
2025-05-23 17:07:23,074 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-23 17:07:23,078 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250522  159001              100  2025-05-22
1      None  159003               99  2025-05-22
2      None  159005               46  2025-05-22
3      None  159150              243  2025-05-22
4      None  159201              954  2025-05-22
2025-05-23 17:07:23,148 - INFO - 成功导入ETF自选数据，共1150条记录
2025-05-23 17:07:23,148 - INFO - 开始导入ETF指数分类数据...
2025-05-23 17:07:23,148 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-23 17:07:23,208 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-23 17:07:23,208 - INFO - 开始导入ETF商务协议数据...
2025-05-23 17:07:23,209 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-23 17:07:23,312 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-23 17:07:23,312 - INFO - === ETF数据导入完成 ===
2025-05-23 17:07:23,312 - INFO - ETF基本信息: 成功
2025-05-23 17:07:23,312 - INFO - ETF价格数据: 成功
2025-05-23 17:07:23,312 - INFO - ETF持有人数据: 成功
2025-05-23 17:07:23,312 - INFO - ETF自选数据: 成功
2025-05-23 17:07:23,313 - INFO - ETF指数分类数据: 成功
2025-05-23 17:07:23,313 - INFO - ETF商务协议数据: 成功
2025-05-23 17:07:23,313 - INFO - === 数据库记录统计 ===
2025-05-23 17:07:23,313 - INFO - ETF基本信息表: 1166条记录
2025-05-23 17:07:23,313 - INFO - ETF价格数据表: 1166条记录
2025-05-23 17:07:23,313 - INFO - ETF持有人数据表: 1140条记录
2025-05-23 17:07:23,314 - INFO - ETF自选数据表: 1150条记录
2025-05-23 17:07:23,314 - INFO - ETF商务协议数据表: 341条记录
2025-05-23 17:07:23,314 - INFO - 开始更新基金公司分析数据...
2025-05-23 17:07:23,456 - INFO - 基金公司分析数据更新成功。
2025-05-23 17:07:23,456 - INFO - 基金公司分析表: 54条记录
2025-05-26 17:35:54,434 - INFO - === 开始导入所有ETF数据 ===
2025-05-26 17:35:54,441 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-26 17:35:54,441 - INFO - 开始导入ETF基本信息...
2025-05-26 17:35:54,443 - INFO - 使用文件: data/ETF_DATA_20250523.xlsx
2025-05-26 17:35:54,443 - INFO - 从文件名中提取的日期: 2025-05-23
2025-05-26 17:35:55,368 - INFO - 成功导入ETF基本信息，共1170条记录
2025-05-26 17:35:55,368 - INFO - 开始导入ETF价格数据...
2025-05-26 17:35:55,368 - INFO - 使用文件: data/ETF_DATA_20250523.xlsx
2025-05-26 17:35:55,368 - INFO - 从文件名中提取的日期: 2025-05-23
2025-05-26 17:35:55,919 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-26 17:35:55,920 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-26 17:35:55,921 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-26 17:35:55,948 - INFO - 数据示例:
     code       证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  563010      电信ETF       中证电信主题指数收益率        1.8932  上海证券交易所  2023-07-05  ...       1.244     0.7264            0.0066                 0.5334  2025-05-23  2025-05-26 17:35:55
1  159005   汇添富快钱ETF        活期存款利率(税后)       10.4301  深圳证券交易所  2014-12-23  ...      99.999     0.0020           -0.0010                -0.0010  2025-05-23  2025-05-26 17:35:55
2  159321    黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0466  深圳证券交易所  2024-05-09  ...       1.108     2.1700           -0.0005                -0.0451  2025-05-23  2025-05-26 17:35:55
3  159526   机器人指数ETF        中证机器人指数收益率        1.1096  深圳证券交易所  2024-04-16  ...       1.244     1.0475            0.0048                 0.3873  2025-05-23  2025-05-26 17:35:55
4  159531  中证2000ETF       中证2000指数收益率        1.7178  深圳证券交易所  2023-09-07  ...       1.096     1.4760            0.0141                 1.3033  2025-05-23  2025-05-26 17:35:55

[5 rows x 39 columns]
2025-05-26 17:35:55,992 - INFO - 成功导入ETF价格数据，共1170条记录
2025-05-26 17:35:55,993 - INFO - 开始导入ETF持有人数据...
2025-05-26 17:35:55,995 - INFO - 使用文件: data/客户ETF保有量20250523.xlsx
2025-05-26 17:35:55,995 - INFO - 从文件名中提取的日期: 2025-05-23
2025-05-26 17:35:56,112 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-26 17:35:56,122 - INFO - 原始列名: ['数据截止日期']
2025-05-26 17:35:56,122 - INFO - 数据形状: (0, 1)
2025-05-26 17:35:56,122 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-26 17:35:56,123 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-26 17:35:56,237 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-26 17:35:56,243 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-26 17:35:56,246 - INFO - 成功读取数据，形状: (1141, 6)
2025-05-26 17:35:56,248 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-26 17:35:56,254 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250523  159001       货币ETF         78504.0            11     7850400.00  2025-05-23
1      None  159003     招商快线ETF          2953.0             5      295300.00  2025-05-23
2      None  159005    汇添富快钱ETF          1300.0            12      130001.30  2025-05-23
3      None  159150  深证50ETF易方达       1660260.0            38     1925901.60  2025-05-23
4      None  159201    自由现金流ETF      21454703.0           528    21218701.29  2025-05-23
2025-05-26 17:35:56,351 - INFO - 成功导入ETF持有人数据，共1141条记录
2025-05-26 17:35:56,352 - INFO - 开始导入ETF自选数据...
2025-05-26 17:35:56,352 - INFO - 使用文件: data/客户ETF自选人数20250523.xlsx
2025-05-26 17:35:56,352 - INFO - 从文件名中提取的日期: 2025-05-23
2025-05-26 17:35:56,383 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-26 17:35:56,392 - INFO - 原始列名: ['数据截止日期']
2025-05-26 17:35:56,392 - INFO - 数据形状: (0, 1)
2025-05-26 17:35:56,393 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-26 17:35:56,393 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-26 17:35:56,483 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-26 17:35:56,487 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-26 17:35:56,487 - INFO - 成功读取数据，形状: (1151, 3)
2025-05-26 17:35:56,488 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-26 17:35:56,488 - INFO - 找到的代码列: ['标的代码']
2025-05-26 17:35:56,488 - INFO - 找到的自选列: ['加自选人数']
2025-05-26 17:35:56,490 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-26 17:35:56,495 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250523  159001              100  2025-05-23
1      None  159003               98  2025-05-23
2      None  159005               46  2025-05-23
3      None  159150              243  2025-05-23
4      None  159201              955  2025-05-23
2025-05-26 17:35:56,570 - INFO - 成功导入ETF自选数据，共1151条记录
2025-05-26 17:35:56,570 - INFO - 开始导入ETF指数分类数据...
2025-05-26 17:35:56,571 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-26 17:35:56,630 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-26 17:35:56,631 - INFO - 开始导入ETF商务协议数据...
2025-05-26 17:35:56,631 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-26 17:35:56,735 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-26 17:35:56,735 - INFO - === ETF数据导入完成 ===
2025-05-26 17:35:56,736 - INFO - ETF基本信息: 成功
2025-05-26 17:35:56,736 - INFO - ETF价格数据: 成功
2025-05-26 17:35:56,736 - INFO - ETF持有人数据: 成功
2025-05-26 17:35:56,736 - INFO - ETF自选数据: 成功
2025-05-26 17:35:56,736 - INFO - ETF指数分类数据: 成功
2025-05-26 17:35:56,736 - INFO - ETF商务协议数据: 成功
2025-05-26 17:35:56,736 - INFO - === 数据库记录统计 ===
2025-05-26 17:35:56,736 - INFO - ETF基本信息表: 1170条记录
2025-05-26 17:35:56,736 - INFO - ETF价格数据表: 1170条记录
2025-05-26 17:35:56,736 - INFO - ETF持有人数据表: 1141条记录
2025-05-26 17:35:56,737 - INFO - ETF自选数据表: 1151条记录
2025-05-26 17:35:56,737 - INFO - ETF商务协议数据表: 341条记录
2025-05-26 17:35:56,737 - INFO - 开始更新基金公司分析数据...
2025-05-26 17:35:56,892 - INFO - 基金公司分析数据更新成功。
2025-05-26 17:35:56,893 - INFO - 基金公司分析表: 54条记录
2025-05-27 14:32:51,571 - INFO - === 开始导入所有ETF数据 ===
2025-05-27 14:32:51,578 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-05-27 14:32:51,578 - INFO - 开始导入ETF基本信息...
2025-05-27 14:32:51,582 - INFO - 使用文件: data/ETF_DATA_20250526.xlsx
2025-05-27 14:32:51,582 - INFO - 从文件名中提取的日期: 2025-05-26
2025-05-27 14:32:52,497 - INFO - 成功导入ETF基本信息，共1170条记录
2025-05-27 14:32:52,497 - INFO - 开始导入ETF价格数据...
2025-05-27 14:32:52,498 - INFO - 使用文件: data/ETF_DATA_20250526.xlsx
2025-05-27 14:32:52,498 - INFO - 从文件名中提取的日期: 2025-05-26
2025-05-27 14:32:53,056 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-05-27 14:32:53,057 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-05-27 14:32:53,059 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证综合指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证综合指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-05-27 14:32:53,084 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)       10.4329  深圳证券交易所  2014-12-23  ...      99.999     0.0020           -0.0010                -0.0010  2025-05-26  2025-05-27 14:32:53
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率        1.0493  深圳证券交易所  2024-05-09  ...       1.108     2.1700           -0.0047                -0.4224  2025-05-26  2025-05-27 14:32:53
2  159526     机器人指数ETF        中证机器人指数收益率        1.1123  深圳证券交易所  2024-04-16  ...       1.244     1.0475            0.0011                 0.0885  2025-05-26  2025-05-27 14:32:53
3  159531    中证2000ETF       中证2000指数收益率        1.7205  深圳证券交易所  2023-09-07  ...       1.096     1.4760            0.0005                 0.0456  2025-05-26  2025-05-27 14:32:53
4  159597  创业板成长ETF易方达        创业板成长指数收益率        1.0521  深圳证券交易所  2024-05-08  ...       1.120     1.6014           -0.0020                -0.1783  2025-05-26  2025-05-27 14:32:53

[5 rows x 39 columns]
2025-05-27 14:32:53,127 - INFO - 成功导入ETF价格数据，共1170条记录
2025-05-27 14:32:53,127 - INFO - 开始导入ETF持有人数据...
2025-05-27 14:32:53,128 - INFO - 使用文件: data/客户ETF保有量20250526.xlsx
2025-05-27 14:32:53,128 - INFO - 从文件名中提取的日期: 2025-05-26
2025-05-27 14:32:53,202 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-05-27 14:32:53,212 - INFO - 原始列名: ['数据截止日期']
2025-05-27 14:32:53,212 - INFO - 数据形状: (0, 1)
2025-05-27 14:32:53,212 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-27 14:32:53,213 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-27 14:32:53,376 - INFO - 尝试读取工作表: 客户ETF保有量
2025-05-27 14:32:53,382 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-05-27 14:32:53,385 - INFO - 成功读取数据，形状: (1139, 6)
2025-05-27 14:32:53,387 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-05-27 14:32:53,393 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250526  159001       货币ETF         98804.0            13   9.880400e+06  2025-05-26
1      None  159003     招商快线ETF           753.0             3   7.530000e+04  2025-05-26
2      None  159005    汇添富快钱ETF          1300.0            12   1.299987e+05  2025-05-26
3      None  159150  深证50ETF易方达       1664460.0            38   1.910800e+06  2025-05-26
4      None  159201    自由现金流ETF      21016603.0           528   2.078542e+07  2025-05-26
2025-05-27 14:32:53,481 - INFO - 成功导入ETF持有人数据，共1139条记录
2025-05-27 14:32:53,481 - INFO - 开始导入ETF自选数据...
2025-05-27 14:32:53,482 - INFO - 使用文件: data/客户ETF自选人数20250526.xlsx
2025-05-27 14:32:53,482 - INFO - 从文件名中提取的日期: 2025-05-26
2025-05-27 14:32:53,514 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-05-27 14:32:53,524 - INFO - 原始列名: ['数据截止日期']
2025-05-27 14:32:53,524 - INFO - 数据形状: (0, 1)
2025-05-27 14:32:53,524 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-05-27 14:32:53,524 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-05-27 14:32:53,606 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-05-27 14:32:53,609 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-05-27 14:32:53,610 - INFO - 成功读取数据，形状: (1153, 3)
2025-05-27 14:32:53,611 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-05-27 14:32:53,611 - INFO - 找到的代码列: ['标的代码']
2025-05-27 14:32:53,611 - INFO - 找到的自选列: ['加自选人数']
2025-05-27 14:32:53,613 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-05-27 14:32:53,617 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250526  159001              100  2025-05-26
1      None  159003               98  2025-05-26
2      None  159005               46  2025-05-26
3      None  159150              243  2025-05-26
4      None  159201              953  2025-05-26
2025-05-27 14:32:53,686 - INFO - 成功导入ETF自选数据，共1153条记录
2025-05-27 14:32:53,686 - INFO - 开始导入ETF指数分类数据...
2025-05-27 14:32:53,687 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-05-27 14:32:53,742 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-05-27 14:32:53,742 - INFO - 开始导入ETF商务协议数据...
2025-05-27 14:32:53,743 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-05-27 14:32:53,854 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-05-27 14:32:53,854 - INFO - === ETF数据导入完成 ===
2025-05-27 14:32:53,854 - INFO - ETF基本信息: 成功
2025-05-27 14:32:53,854 - INFO - ETF价格数据: 成功
2025-05-27 14:32:53,854 - INFO - ETF持有人数据: 成功
2025-05-27 14:32:53,854 - INFO - ETF自选数据: 成功
2025-05-27 14:32:53,854 - INFO - ETF指数分类数据: 成功
2025-05-27 14:32:53,854 - INFO - ETF商务协议数据: 成功
2025-05-27 14:32:53,855 - INFO - === 数据库记录统计 ===
2025-05-27 14:32:53,855 - INFO - ETF基本信息表: 1170条记录
2025-05-27 14:32:53,855 - INFO - ETF价格数据表: 1170条记录
2025-05-27 14:32:53,855 - INFO - ETF持有人数据表: 1139条记录
2025-05-27 14:32:53,855 - INFO - ETF自选数据表: 1153条记录
2025-05-27 14:32:53,855 - INFO - ETF商务协议数据表: 341条记录
2025-05-27 14:32:53,855 - INFO - 开始更新基金公司分析数据...
2025-05-27 14:32:54,014 - INFO - 基金公司分析数据更新成功。
2025-05-27 14:32:54,014 - INFO - 基金公司分析表: 54条记录
2025-06-03 08:35:01,091 - INFO - === 开始导入所有ETF数据 ===
2025-06-03 08:35:01,094 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-03 08:35:01,095 - INFO - 开始导入ETF基本信息...
2025-06-03 08:35:01,099 - INFO - 使用文件: data/ETF_DATA_20250530.xlsx
2025-06-03 08:35:01,100 - INFO - 从文件名中提取的日期: 2025-05-30
2025-06-03 08:35:01,999 - INFO - 成功导入ETF基本信息，共1180条记录
2025-06-03 08:35:02,000 - INFO - 开始导入ETF价格数据...
2025-06-03 08:35:02,000 - INFO - 使用文件: data/ETF_DATA_20250530.xlsx
2025-06-03 08:35:02,000 - INFO - 从文件名中提取的日期: 2025-05-30
2025-06-03 08:35:02,540 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-03 08:35:02,541 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-03 08:35:02,542 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-03 08:35:02,565 - INFO - 数据示例:
     code       证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  563010      电信ETF       中证电信主题指数收益率      1.915068  上海证券交易所  2023-07-05  ...       1.262   1.109350            0.0002               0.015850  2025-05-30  2025-06-03 08:35:02
1  159005   汇添富快钱ETF        活期存款利率(税后)     10.452055  深圳证券交易所  2014-12-23  ...     100.001   0.002000            0.0010               0.001000  2025-05-30  2025-06-03 08:35:02
2  159321    黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.068493  深圳证券交易所  2024-05-09  ...       1.077   1.846722           -0.0045              -0.416089  2025-05-30  2025-06-03 08:35:02
3  159526   机器人指数ETF        中证机器人指数收益率      1.131507  深圳证券交易所  2024-04-16  ...       1.214   1.854839            0.0028               0.231176  2025-05-30  2025-06-03 08:35:02
4  159531  中证2000ETF       中证2000指数收益率      1.739726  深圳证券交易所  2023-09-07  ...       1.095   1.880036           -0.0001              -0.009132  2025-05-30  2025-06-03 08:35:02

[5 rows x 39 columns]
2025-06-03 08:35:02,603 - INFO - 成功导入ETF价格数据，共1180条记录
2025-06-03 08:35:02,603 - INFO - 开始导入ETF持有人数据...
2025-06-03 08:35:02,604 - INFO - 使用文件: data/客户ETF保有量20250530.xlsx
2025-06-03 08:35:02,604 - INFO - 从文件名中提取的日期: 2025-05-30
2025-06-03 08:35:02,666 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-03 08:35:02,675 - INFO - 原始列名: ['数据截止日期']
2025-06-03 08:35:02,675 - INFO - 数据形状: (0, 1)
2025-06-03 08:35:02,676 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-03 08:35:02,676 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-03 08:35:02,790 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-03 08:35:02,796 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-03 08:35:02,799 - INFO - 成功读取数据，形状: (1141, 6)
2025-06-03 08:35:02,801 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-03 08:35:02,806 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250530  159001       货币ETF        134204.0            15   1.342040e+07  2025-05-30
1      None  159003     招商快线ETF         10753.0             4   1.075311e+06  2025-05-30
2      None  159005    汇添富快钱ETF          1300.0            12   1.300013e+05  2025-05-30
3      None  159150  深证50ETF易方达       1663160.0            38   1.897666e+06  2025-05-30
4      None  159201    自由现金流ETF      21521489.0           527   2.128475e+07  2025-05-30
2025-06-03 08:35:02,887 - INFO - 成功导入ETF持有人数据，共1141条记录
2025-06-03 08:35:02,887 - INFO - 开始导入ETF自选数据...
2025-06-03 08:35:02,888 - INFO - 使用文件: data/客户ETF自选人数20250530.xlsx
2025-06-03 08:35:02,888 - INFO - 从文件名中提取的日期: 2025-05-30
2025-06-03 08:35:02,915 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-03 08:35:02,924 - INFO - 原始列名: ['数据截止日期']
2025-06-03 08:35:02,924 - INFO - 数据形状: (0, 1)
2025-06-03 08:35:02,925 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-03 08:35:02,925 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-03 08:35:02,987 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-03 08:35:02,991 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-03 08:35:02,991 - INFO - 成功读取数据，形状: (1162, 3)
2025-06-03 08:35:02,992 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-03 08:35:02,992 - INFO - 找到的代码列: ['标的代码']
2025-06-03 08:35:02,992 - INFO - 找到的自选列: ['加自选人数']
2025-06-03 08:35:02,993 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-03 08:35:02,997 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250530  159001              102  2025-05-30
1      None  159003               98  2025-05-30
2      None  159005               46  2025-05-30
3      None  159150              243  2025-05-30
4      None  159201              959  2025-05-30
2025-06-03 08:35:03,080 - INFO - 成功导入ETF自选数据，共1162条记录
2025-06-03 08:35:03,080 - INFO - 开始导入ETF指数分类数据...
2025-06-03 08:35:03,080 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-03 08:35:03,129 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-03 08:35:03,130 - INFO - 开始导入ETF商务协议数据...
2025-06-03 08:35:03,130 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-03 08:35:03,226 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-03 08:35:03,226 - INFO - === ETF数据导入完成 ===
2025-06-03 08:35:03,226 - INFO - ETF基本信息: 成功
2025-06-03 08:35:03,226 - INFO - ETF价格数据: 成功
2025-06-03 08:35:03,226 - INFO - ETF持有人数据: 成功
2025-06-03 08:35:03,226 - INFO - ETF自选数据: 成功
2025-06-03 08:35:03,226 - INFO - ETF指数分类数据: 成功
2025-06-03 08:35:03,226 - INFO - ETF商务协议数据: 成功
2025-06-03 08:35:03,227 - INFO - === 数据库记录统计 ===
2025-06-03 08:35:03,227 - INFO - ETF基本信息表: 1180条记录
2025-06-03 08:35:03,227 - INFO - ETF价格数据表: 1180条记录
2025-06-03 08:35:03,227 - INFO - ETF持有人数据表: 1141条记录
2025-06-03 08:35:03,227 - INFO - ETF自选数据表: 1162条记录
2025-06-03 08:35:03,227 - INFO - ETF商务协议数据表: 341条记录
2025-06-03 08:35:03,227 - INFO - 开始更新基金公司分析数据...
2025-06-03 08:35:03,365 - INFO - 基金公司分析数据更新成功。
2025-06-03 08:35:03,365 - INFO - 基金公司分析表: 54条记录
2025-06-04 15:39:46,794 - INFO - === 开始导入所有ETF数据 ===
2025-06-04 15:39:46,795 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-04 15:39:46,795 - INFO - 开始导入ETF基本信息...
2025-06-04 15:39:46,796 - INFO - 使用文件: data/ETF_DATA_20250603.xlsx
2025-06-04 15:39:46,796 - INFO - 从文件名中提取的日期: 2025-06-03
2025-06-04 15:39:47,602 - INFO - 成功导入ETF基本信息，共1181条记录
2025-06-04 15:39:47,602 - INFO - 开始导入ETF价格数据...
2025-06-04 15:39:47,603 - INFO - 使用文件: data/ETF_DATA_20250603.xlsx
2025-06-04 15:39:47,603 - INFO - 从文件名中提取的日期: 2025-06-03
2025-06-04 15:39:48,159 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-04 15:39:48,160 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-04 15:39:48,161 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-04 15:39:48,183 - INFO - 数据示例:
     code       证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  563010      电信ETF       中证电信主题指数收益率      1.917808  上海证券交易所  2023-07-05  ...       1.258   0.554675           -0.0001              -0.007948  2025-06-03  2025-06-04 15:39:48
1  159005   汇添富快钱ETF        活期存款利率(税后)     10.454795  深圳证券交易所  2014-12-23  ...     100.000   0.001000            0.0000               0.000000  2025-06-03  2025-06-04 15:39:48
2  159321    黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.071233  深圳证券交易所  2024-05-09  ...       1.115   3.528319           -0.0020              -0.179051  2025-06-03  2025-06-04 15:39:48
3  159526   机器人指数ETF        中证机器人指数收益率      1.134247  深圳证券交易所  2024-04-16  ...       1.213   1.235585            0.0003               0.024738  2025-06-03  2025-06-04 15:39:48
4  159531  中证2000ETF       中证2000指数收益率      1.742466  深圳证券交易所  2023-09-07  ...       1.104   1.552511           -0.0003              -0.027167  2025-06-03  2025-06-04 15:39:48

[5 rows x 39 columns]
2025-06-04 15:39:48,219 - INFO - 成功导入ETF价格数据，共1181条记录
2025-06-04 15:39:48,219 - INFO - 开始导入ETF持有人数据...
2025-06-04 15:39:48,220 - INFO - 使用文件: data/客户ETF保有量20250603.xlsx
2025-06-04 15:39:48,220 - INFO - 从文件名中提取的日期: 2025-06-03
2025-06-04 15:39:48,284 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-04 15:39:48,295 - INFO - 原始列名: ['数据截止日期']
2025-06-04 15:39:48,295 - INFO - 数据形状: (0, 1)
2025-06-04 15:39:48,295 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-04 15:39:48,295 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-04 15:39:48,405 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-04 15:39:48,411 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-04 15:39:48,414 - INFO - 成功读取数据，形状: (1143, 6)
2025-06-04 15:39:48,416 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-04 15:39:48,421 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250603  159001       货币ETF        134404.0            15   1.344040e+07  2025-06-03
1      None  159003     招商快线ETF         10753.0             4   1.075300e+06  2025-06-03
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-06-03
3      None  159150  深证50ETF易方达       1663160.0            38   1.892676e+06  2025-06-03
4      None  159201    自由现金流ETF      21758089.0           529   2.145348e+07  2025-06-03
2025-06-04 15:39:48,502 - INFO - 成功导入ETF持有人数据，共1143条记录
2025-06-04 15:39:48,502 - INFO - 开始导入ETF自选数据...
2025-06-04 15:39:48,503 - INFO - 使用文件: data/客户ETF自选人数20250603.xlsx
2025-06-04 15:39:48,503 - INFO - 从文件名中提取的日期: 2025-06-03
2025-06-04 15:39:48,531 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-04 15:39:48,540 - INFO - 原始列名: ['数据截止日期']
2025-06-04 15:39:48,540 - INFO - 数据形状: (0, 1)
2025-06-04 15:39:48,540 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-04 15:39:48,540 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-04 15:39:48,600 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-04 15:39:48,603 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-04 15:39:48,604 - INFO - 成功读取数据，形状: (1163, 3)
2025-06-04 15:39:48,604 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-04 15:39:48,604 - INFO - 找到的代码列: ['标的代码']
2025-06-04 15:39:48,604 - INFO - 找到的自选列: ['加自选人数']
2025-06-04 15:39:48,606 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-04 15:39:48,609 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250603  159001              102  2025-06-03
1      None  159003               98  2025-06-03
2      None  159005               46  2025-06-03
3      None  159150              243  2025-06-03
4      None  159201              959  2025-06-03
2025-06-04 15:39:48,668 - INFO - 成功导入ETF自选数据，共1163条记录
2025-06-04 15:39:48,668 - INFO - 开始导入ETF指数分类数据...
2025-06-04 15:39:48,669 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-04 15:39:48,737 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-04 15:39:48,737 - INFO - 开始导入ETF商务协议数据...
2025-06-04 15:39:48,737 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-04 15:39:48,860 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-04 15:39:48,860 - INFO - === ETF数据导入完成 ===
2025-06-04 15:39:48,860 - INFO - ETF基本信息: 成功
2025-06-04 15:39:48,860 - INFO - ETF价格数据: 成功
2025-06-04 15:39:48,860 - INFO - ETF持有人数据: 成功
2025-06-04 15:39:48,860 - INFO - ETF自选数据: 成功
2025-06-04 15:39:48,860 - INFO - ETF指数分类数据: 成功
2025-06-04 15:39:48,860 - INFO - ETF商务协议数据: 成功
2025-06-04 15:39:48,861 - INFO - === 数据库记录统计 ===
2025-06-04 15:39:48,861 - INFO - ETF基本信息表: 1181条记录
2025-06-04 15:39:48,861 - INFO - ETF价格数据表: 1181条记录
2025-06-04 15:39:48,861 - INFO - ETF持有人数据表: 1143条记录
2025-06-04 15:39:48,861 - INFO - ETF自选数据表: 1163条记录
2025-06-04 15:39:48,861 - INFO - ETF商务协议数据表: 341条记录
2025-06-04 15:39:48,861 - INFO - 开始更新基金公司分析数据...
2025-06-04 15:39:49,012 - INFO - 基金公司分析数据更新成功。
2025-06-04 15:39:49,012 - INFO - 基金公司分析表: 54条记录
2025-06-09 10:29:11,907 - INFO - === 开始导入所有ETF数据 ===
2025-06-09 10:29:11,909 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-09 10:29:11,910 - INFO - 开始导入ETF基本信息...
2025-06-09 10:29:11,912 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:29:11,912 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:29:12,705 - INFO - 成功导入ETF基本信息，共1186条记录
2025-06-09 10:29:12,706 - INFO - 开始导入ETF价格数据...
2025-06-09 10:29:12,706 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:29:12,706 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:29:13,233 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-09 10:29:13,234 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-09 10:29:13,236 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-09 10:29:13,258 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)     10.468493  深圳证券交易所  2014-12-23  ...     100.001   0.002000            0.0010               0.001000  2025-06-06  2025-06-09 10:29:13
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.084932  深圳证券交易所  2024-05-09  ...       1.120   2.631579           -0.0027              -0.240492  2025-06-06  2025-06-09 10:29:13
2  159526     机器人指数ETF        中证机器人指数收益率      1.147945  深圳证券交易所  2024-04-16  ...       1.232   1.451613            0.0009               0.073105  2025-06-06  2025-06-09 10:29:13
3  159531    中证2000ETF       中证2000指数收益率      1.756164  深圳证券交易所  2023-09-07  ...       1.120   0.533808           -0.0011              -0.098118  2025-06-06  2025-06-09 10:29:13
4  159597  创业板成长ETF易方达        创业板成长指数收益率      1.087671  深圳证券交易所  2024-05-08  ...       1.165   0.769231           -0.0005              -0.042900  2025-06-06  2025-06-09 10:29:13

[5 rows x 39 columns]
2025-06-09 10:29:13,294 - INFO - 成功导入ETF价格数据，共1186条记录
2025-06-09 10:29:13,294 - INFO - 开始导入ETF持有人数据...
2025-06-09 10:29:13,295 - INFO - 使用文件: data/客户ETF保有量20250606.xlsx
2025-06-09 10:29:13,295 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:29:13,397 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-09 10:29:13,407 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:29:13,407 - INFO - 数据形状: (0, 1)
2025-06-09 10:29:13,408 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:29:13,408 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:29:13,521 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-09 10:29:13,527 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-09 10:29:13,546 - INFO - 成功读取数据，形状: (1142, 6)
2025-06-09 10:29:13,548 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-09 10:29:13,553 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250605  159001       货币ETF        133904.0            14   1.339027e+07  2025-06-06
1      None  159003     招商快线ETF           753.0             3   7.529925e+04  2025-06-06
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-06-06
3      None  159150  深证50ETF易方达       1654160.0            36   1.902284e+06  2025-06-06
4      None  159201    自由现金流ETF      21870389.0           518   2.162981e+07  2025-06-06
2025-06-09 10:29:13,637 - INFO - 成功导入ETF持有人数据，共1142条记录
2025-06-09 10:29:13,637 - INFO - 开始导入ETF自选数据...
2025-06-09 10:29:13,638 - INFO - 使用文件: data/客户ETF自选人数20250606.xlsx
2025-06-09 10:29:13,638 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:29:13,669 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-09 10:29:13,677 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:29:13,677 - INFO - 数据形状: (0, 1)
2025-06-09 10:29:13,678 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:29:13,678 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:29:13,740 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-09 10:29:13,743 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-09 10:29:13,744 - INFO - 成功读取数据，形状: (1166, 3)
2025-06-09 10:29:13,744 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-09 10:29:13,744 - INFO - 找到的代码列: ['标的代码']
2025-06-09 10:29:13,744 - INFO - 找到的自选列: ['加自选人数']
2025-06-09 10:29:13,746 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-09 10:29:13,749 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250605  159001              102  2025-06-06
1      None  159003               98  2025-06-06
2      None  159005               45  2025-06-06
3      None  159150              243  2025-06-06
4      None  159201              953  2025-06-06
2025-06-09 10:29:13,812 - INFO - 成功导入ETF自选数据，共1166条记录
2025-06-09 10:29:13,812 - INFO - 开始导入ETF指数分类数据...
2025-06-09 10:29:13,813 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-09 10:29:13,865 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-09 10:29:13,866 - INFO - 开始导入ETF商务协议数据...
2025-06-09 10:29:13,866 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-09 10:29:13,965 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-09 10:29:13,966 - INFO - === ETF数据导入完成 ===
2025-06-09 10:29:13,966 - INFO - ETF基本信息: 成功
2025-06-09 10:29:13,966 - INFO - ETF价格数据: 成功
2025-06-09 10:29:13,966 - INFO - ETF持有人数据: 成功
2025-06-09 10:29:13,966 - INFO - ETF自选数据: 成功
2025-06-09 10:29:13,966 - INFO - ETF指数分类数据: 成功
2025-06-09 10:29:13,966 - INFO - ETF商务协议数据: 成功
2025-06-09 10:29:13,966 - INFO - === 数据库记录统计 ===
2025-06-09 10:29:13,967 - INFO - ETF基本信息表: 1186条记录
2025-06-09 10:29:13,967 - INFO - ETF价格数据表: 1186条记录
2025-06-09 10:29:13,967 - INFO - ETF持有人数据表: 1142条记录
2025-06-09 10:29:13,967 - INFO - ETF自选数据表: 1166条记录
2025-06-09 10:29:13,967 - INFO - ETF商务协议数据表: 341条记录
2025-06-09 10:29:13,967 - INFO - 开始更新基金公司分析数据...
2025-06-09 10:29:14,107 - INFO - 基金公司分析数据更新成功。
2025-06-09 10:29:14,108 - INFO - 基金公司分析表: 54条记录
2025-06-09 10:41:28,120 - INFO - === 开始导入所有ETF数据 ===
2025-06-09 10:41:28,125 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-09 10:41:28,125 - INFO - 开始导入ETF基本信息...
2025-06-09 10:41:28,128 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:41:28,129 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:41:28,946 - INFO - 成功导入ETF基本信息，共1186条记录
2025-06-09 10:41:28,947 - INFO - 开始导入ETF价格数据...
2025-06-09 10:41:28,947 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:41:28,947 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:41:29,473 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-09 10:41:29,474 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-09 10:41:29,475 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-09 10:41:29,498 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)     10.468493  深圳证券交易所  ...  0.002000           0.0010               0.001000  2025-06-06  2025-06-09 10:41:29
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.084932  深圳证券交易所  ...  2.631579          -0.0027              -0.240492  2025-06-06  2025-06-09 10:41:29
2  159526     机器人指数ETF        中证机器人指数收益率      1.147945  深圳证券交易所  ...  1.451613           0.0009               0.073105  2025-06-06  2025-06-09 10:41:29
3  159531    中证2000ETF       中证2000指数收益率      1.756164  深圳证券交易所  ...  0.533808          -0.0011              -0.098118  2025-06-06  2025-06-09 10:41:29
4  159597  创业板成长ETF易方达        创业板成长指数收益率      1.087671  深圳证券交易所  ...  0.769231          -0.0005              -0.042900  2025-06-06  2025-06-09 10:41:29

[5 rows x 39 columns]
2025-06-09 10:41:29,534 - INFO - 成功导入ETF价格数据，共1186条记录
2025-06-09 10:41:29,534 - INFO - 开始导入ETF持有人数据...
2025-06-09 10:41:29,535 - INFO - 使用文件: data/客户ETF保有量20250606.xlsx
2025-06-09 10:41:29,535 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:41:29,599 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-09 10:41:29,608 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:41:29,608 - INFO - 数据形状: (0, 1)
2025-06-09 10:41:29,609 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:41:29,609 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:41:29,718 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-09 10:41:29,724 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-09 10:41:29,741 - INFO - 成功读取数据，形状: (1142, 6)
2025-06-09 10:41:29,743 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-09 10:41:29,748 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250605  159001       货币ETF        133904.0            14   1.339027e+07  2025-06-06
1      None  159003     招商快线ETF           753.0             3   7.529925e+04  2025-06-06
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-06-06
3      None  159150  深证50ETF易方达       1654160.0            36   1.902284e+06  2025-06-06
4      None  159201    自由现金流ETF      21870389.0           518   2.162981e+07  2025-06-06
2025-06-09 10:41:29,834 - INFO - 成功导入ETF持有人数据，共1142条记录
2025-06-09 10:41:29,835 - INFO - 开始导入ETF自选数据...
2025-06-09 10:41:29,836 - INFO - 使用文件: data/客户ETF自选人数20250606.xlsx
2025-06-09 10:41:29,836 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:41:29,868 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-09 10:41:29,877 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:41:29,877 - INFO - 数据形状: (0, 1)
2025-06-09 10:41:29,878 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:41:29,878 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:41:29,941 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-09 10:41:29,945 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-09 10:41:29,946 - INFO - 成功读取数据，形状: (1166, 3)
2025-06-09 10:41:29,946 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-09 10:41:29,946 - INFO - 找到的代码列: ['标的代码']
2025-06-09 10:41:29,946 - INFO - 找到的自选列: ['加自选人数']
2025-06-09 10:41:29,948 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-09 10:41:29,952 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250605  159001              102  2025-06-06
1      None  159003               98  2025-06-06
2      None  159005               45  2025-06-06
3      None  159150              243  2025-06-06
4      None  159201              953  2025-06-06
2025-06-09 10:41:30,022 - INFO - 成功导入ETF自选数据，共1166条记录
2025-06-09 10:41:30,023 - INFO - 开始导入ETF指数分类数据...
2025-06-09 10:41:30,023 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-09 10:41:30,078 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-09 10:41:30,078 - INFO - 开始导入ETF商务协议数据...
2025-06-09 10:41:30,078 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-09 10:41:30,180 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-09 10:41:30,180 - INFO - === ETF数据导入完成 ===
2025-06-09 10:41:30,180 - INFO - ETF基本信息: 成功
2025-06-09 10:41:30,180 - INFO - ETF价格数据: 成功
2025-06-09 10:41:30,181 - INFO - ETF持有人数据: 成功
2025-06-09 10:41:30,181 - INFO - ETF自选数据: 成功
2025-06-09 10:41:30,181 - INFO - ETF指数分类数据: 成功
2025-06-09 10:41:30,181 - INFO - ETF商务协议数据: 成功
2025-06-09 10:41:30,182 - INFO - === 数据库记录统计 ===
2025-06-09 10:41:30,182 - INFO - ETF基本信息表: 1186条记录
2025-06-09 10:41:30,182 - INFO - ETF价格数据表: 1186条记录
2025-06-09 10:41:30,182 - INFO - ETF持有人数据表: 1142条记录
2025-06-09 10:41:30,182 - INFO - ETF自选数据表: 1166条记录
2025-06-09 10:41:30,182 - INFO - ETF商务协议数据表: 341条记录
2025-06-09 10:41:30,182 - INFO - 开始更新基金公司分析数据...
2025-06-09 10:41:30,317 - INFO - 基金公司分析数据更新成功。
2025-06-09 10:41:30,318 - INFO - 基金公司分析表: 54条记录
2025-06-09 10:42:20,178 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-09 10:42:20,179 - INFO - 开始导入ETF基本信息...
2025-06-09 10:42:20,179 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:42:20,180 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:20,955 - INFO - 成功导入ETF基本信息，共1186条记录
2025-06-09 10:42:20,955 - INFO - 开始导入ETF价格数据...
2025-06-09 10:42:20,955 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:42:20,955 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:21,479 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-09 10:42:21,480 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-09 10:42:21,482 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-09 10:42:21,505 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)     10.468493  深圳证券交易所  ...  0.002000           0.0010               0.001000  2025-06-06  2025-06-09 10:42:21
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.084932  深圳证券交易所  ...  2.631579          -0.0027              -0.240492  2025-06-06  2025-06-09 10:42:21
2  159526     机器人指数ETF        中证机器人指数收益率      1.147945  深圳证券交易所  ...  1.451613           0.0009               0.073105  2025-06-06  2025-06-09 10:42:21
3  159531    中证2000ETF       中证2000指数收益率      1.756164  深圳证券交易所  ...  0.533808          -0.0011              -0.098118  2025-06-06  2025-06-09 10:42:21
4  159597  创业板成长ETF易方达        创业板成长指数收益率      1.087671  深圳证券交易所  ...  0.769231          -0.0005              -0.042900  2025-06-06  2025-06-09 10:42:21

[5 rows x 39 columns]
2025-06-09 10:42:21,541 - INFO - 成功导入ETF价格数据，共1186条记录
2025-06-09 10:42:21,541 - INFO - 开始导入ETF持有人数据...
2025-06-09 10:42:21,542 - INFO - 使用文件: data/客户ETF保有量20250606.xlsx
2025-06-09 10:42:21,542 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:21,604 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-09 10:42:21,613 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:42:21,613 - INFO - 数据形状: (0, 1)
2025-06-09 10:42:21,614 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:42:21,614 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:42:21,724 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-09 10:42:21,730 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-09 10:42:21,747 - INFO - 成功读取数据，形状: (1142, 6)
2025-06-09 10:42:21,749 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-09 10:42:21,754 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250605  159001       货币ETF        133904.0            14   1.339027e+07  2025-06-06
1      None  159003     招商快线ETF           753.0             3   7.529925e+04  2025-06-06
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-06-06
3      None  159150  深证50ETF易方达       1654160.0            36   1.902284e+06  2025-06-06
4      None  159201    自由现金流ETF      21870389.0           518   2.162981e+07  2025-06-06
2025-06-09 10:42:21,839 - INFO - 成功导入ETF持有人数据，共1142条记录
2025-06-09 10:42:21,839 - INFO - 开始导入ETF自选数据...
2025-06-09 10:42:21,840 - INFO - 使用文件: data/客户ETF自选人数20250606.xlsx
2025-06-09 10:42:21,840 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:21,870 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-09 10:42:21,878 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:42:21,878 - INFO - 数据形状: (0, 1)
2025-06-09 10:42:21,879 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:42:21,879 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:42:21,942 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-09 10:42:21,946 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-09 10:42:21,947 - INFO - 成功读取数据，形状: (1166, 3)
2025-06-09 10:42:21,947 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-09 10:42:21,947 - INFO - 找到的代码列: ['标的代码']
2025-06-09 10:42:21,947 - INFO - 找到的自选列: ['加自选人数']
2025-06-09 10:42:21,948 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-09 10:42:21,952 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250605  159001              102  2025-06-06
1      None  159003               98  2025-06-06
2      None  159005               45  2025-06-06
3      None  159150              243  2025-06-06
4      None  159201              953  2025-06-06
2025-06-09 10:42:22,017 - INFO - 成功导入ETF自选数据，共1166条记录
2025-06-09 10:42:22,605 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-09 10:42:22,606 - INFO - 开始导入ETF基本信息...
2025-06-09 10:42:22,606 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:42:22,606 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:23,303 - INFO - 成功导入ETF基本信息，共1186条记录
2025-06-09 10:42:23,303 - INFO - 开始导入ETF价格数据...
2025-06-09 10:42:23,304 - INFO - 使用文件: data/ETF_DATA_20250606.xlsx
2025-06-09 10:42:23,304 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:23,872 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-09 10:42:23,873 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-09 10:42:23,875 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-09 10:42:23,898 - INFO - 数据示例:
     code         证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  159005     汇添富快钱ETF        活期存款利率(税后)     10.468493  深圳证券交易所  ...  0.002000           0.0010               0.001000  2025-06-06  2025-06-09 10:42:23
1  159321      黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.084932  深圳证券交易所  ...  2.631579          -0.0027              -0.240492  2025-06-06  2025-06-09 10:42:23
2  159526     机器人指数ETF        中证机器人指数收益率      1.147945  深圳证券交易所  ...  1.451613           0.0009               0.073105  2025-06-06  2025-06-09 10:42:23
3  159531    中证2000ETF       中证2000指数收益率      1.756164  深圳证券交易所  ...  0.533808          -0.0011              -0.098118  2025-06-06  2025-06-09 10:42:23
4  159597  创业板成长ETF易方达        创业板成长指数收益率      1.087671  深圳证券交易所  ...  0.769231          -0.0005              -0.042900  2025-06-06  2025-06-09 10:42:23

[5 rows x 39 columns]
2025-06-09 10:42:23,930 - INFO - 成功导入ETF价格数据，共1186条记录
2025-06-09 10:42:23,930 - INFO - 开始导入ETF持有人数据...
2025-06-09 10:42:23,931 - INFO - 使用文件: data/客户ETF保有量20250606.xlsx
2025-06-09 10:42:23,931 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:23,999 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-09 10:42:24,010 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:42:24,010 - INFO - 数据形状: (0, 1)
2025-06-09 10:42:24,011 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:42:24,011 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:42:24,131 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-09 10:42:24,138 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-09 10:42:24,158 - INFO - 成功读取数据，形状: (1142, 6)
2025-06-09 10:42:24,160 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-09 10:42:24,165 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250605  159001       货币ETF        133904.0            14   1.339027e+07  2025-06-06
1      None  159003     招商快线ETF           753.0             3   7.529925e+04  2025-06-06
2      None  159005    汇添富快钱ETF          1300.0            12   1.300000e+05  2025-06-06
3      None  159150  深证50ETF易方达       1654160.0            36   1.902284e+06  2025-06-06
4      None  159201    自由现金流ETF      21870389.0           518   2.162981e+07  2025-06-06
2025-06-09 10:42:24,214 - INFO - 成功导入ETF持有人数据，共1142条记录
2025-06-09 10:42:24,215 - INFO - 开始导入ETF自选数据...
2025-06-09 10:42:24,216 - INFO - 使用文件: data/客户ETF自选人数20250606.xlsx
2025-06-09 10:42:24,216 - INFO - 从文件名中提取的日期: 2025-06-06
2025-06-09 10:42:24,245 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-09 10:42:24,254 - INFO - 原始列名: ['数据截止日期']
2025-06-09 10:42:24,254 - INFO - 数据形状: (0, 1)
2025-06-09 10:42:24,254 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-09 10:42:24,254 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-09 10:42:24,317 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-09 10:42:24,321 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-09 10:42:24,322 - INFO - 成功读取数据，形状: (1166, 3)
2025-06-09 10:42:24,322 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-09 10:42:24,322 - INFO - 找到的代码列: ['标的代码']
2025-06-09 10:42:24,322 - INFO - 找到的自选列: ['加自选人数']
2025-06-09 10:42:24,324 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-09 10:42:24,327 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250605  159001              102  2025-06-06
1      None  159003               98  2025-06-06
2      None  159005               45  2025-06-06
3      None  159150              243  2025-06-06
4      None  159201              953  2025-06-06
2025-06-09 10:42:24,366 - INFO - 成功导入ETF自选数据，共1166条记录
2025-06-12 15:23:50,041 - INFO - === 开始导入所有ETF数据 ===
2025-06-12 15:23:50,047 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-12 15:23:50,047 - INFO - 开始导入ETF基本信息...
2025-06-12 15:23:50,050 - INFO - 使用文件: data/ETF_DATA_20250611.xlsx
2025-06-12 15:23:50,051 - INFO - 从文件名中提取的日期: 2025-06-11
2025-06-12 15:23:50,895 - INFO - 成功导入ETF基本信息，共1190条记录
2025-06-12 15:23:50,896 - INFO - 开始导入ETF价格数据...
2025-06-12 15:23:50,896 - INFO - 使用文件: data/ETF_DATA_20250611.xlsx
2025-06-12 15:23:50,896 - INFO - 从文件名中提取的日期: 2025-06-11
2025-06-12 15:23:51,427 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-12 15:23:51,427 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-12 15:23:51,429 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20240630\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20240630\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-12 15:23:51,454 - INFO - 数据示例:
     code       证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点       基金成立日  ... close_price  amplitude  premium_discount  premium_discount_rate        date          update_time
0  563010      电信ETF       中证电信主题指数收益率      1.939726  上海证券交易所  2023-07-05  ...       1.282   1.170960           -0.0001              -0.007800  2025-06-11  2025-06-12 15:23:51
1  159005   汇添富快钱ETF        活期存款利率(税后)     10.476712  深圳证券交易所  2014-12-23  ...     100.001   0.002000            0.0010               0.001000  2025-06-11  2025-06-12 15:23:51
2  159321    黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.093151  深圳证券交易所  2024-05-09  ...       1.123   1.524664           -0.0036              -0.319546  2025-06-11  2025-06-12 15:23:51
3  159526   机器人指数ETF        中证机器人指数收益率      1.156164  深圳证券交易所  2024-04-16  ...       1.221   1.069079            0.0003               0.024576  2025-06-11  2025-06-12 15:23:51
4  159531  中证2000ETF       中证2000指数收益率      1.764384  深圳证券交易所  2023-09-07  ...       1.133   1.151461           -0.0012              -0.105801  2025-06-11  2025-06-12 15:23:51

[5 rows x 39 columns]
2025-06-12 15:23:51,502 - INFO - 成功导入ETF价格数据，共1190条记录
2025-06-12 15:23:51,503 - INFO - 开始导入ETF持有人数据...
2025-06-12 15:23:51,504 - INFO - 使用文件: data/客户ETF保有量20250611.xlsx
2025-06-12 15:23:51,504 - INFO - 从文件名中提取的日期: 2025-06-11
2025-06-12 15:23:51,572 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-12 15:23:51,581 - INFO - 原始列名: ['数据截止日期']
2025-06-12 15:23:51,581 - INFO - 数据形状: (0, 1)
2025-06-12 15:23:51,581 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-12 15:23:51,582 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-12 15:23:51,698 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-12 15:23:51,704 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-12 15:23:51,723 - INFO - 成功读取数据，形状: (1146, 6)
2025-06-12 15:23:51,726 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-12 15:23:51,732 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250611  159001       货币ETF        124804.0            13   1.248052e+07  2025-06-11
1      None  159003     招商快线ETF           753.0             3   7.530000e+04  2025-06-11
2      None  159005    汇添富快钱ETF          1500.0            13   1.500015e+05  2025-06-11
3      None  159150  深证50ETF易方达       1654160.0            36   1.912209e+06  2025-06-11
4      None  159201    自由现金流ETF      21193389.0           496   2.121458e+07  2025-06-11
2025-06-12 15:23:51,836 - INFO - 成功导入ETF持有人数据，共1146条记录
2025-06-12 15:23:51,836 - INFO - 开始导入ETF自选数据...
2025-06-12 15:23:51,837 - INFO - 使用文件: data/客户ETF自选人数20250611.xlsx
2025-06-12 15:23:51,837 - INFO - 从文件名中提取的日期: 2025-06-11
2025-06-12 15:23:51,865 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-12 15:23:51,874 - INFO - 原始列名: ['数据截止日期']
2025-06-12 15:23:51,874 - INFO - 数据形状: (0, 1)
2025-06-12 15:23:51,874 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-12 15:23:51,874 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-12 15:23:51,935 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-12 15:23:51,939 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-12 15:23:51,940 - INFO - 成功读取数据，形状: (1170, 3)
2025-06-12 15:23:51,940 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-12 15:23:51,940 - INFO - 找到的代码列: ['标的代码']
2025-06-12 15:23:51,940 - INFO - 找到的自选列: ['加自选人数']
2025-06-12 15:23:51,942 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-12 15:23:51,945 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250611  159001              101  2025-06-11
1      None  159003               96  2025-06-11
2      None  159005               45  2025-06-11
3      None  159150              243  2025-06-11
4      None  159201              949  2025-06-11
2025-06-12 15:23:52,023 - INFO - 成功导入ETF自选数据，共1170条记录
2025-06-12 15:23:52,024 - INFO - 开始导入ETF指数分类数据...
2025-06-12 15:23:52,024 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-12 15:23:52,075 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-12 15:23:52,075 - INFO - 开始导入ETF商务协议数据...
2025-06-12 15:23:52,076 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-12 15:23:52,180 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-12 15:23:52,180 - INFO - === ETF数据导入完成 ===
2025-06-12 15:23:52,180 - INFO - ETF基本信息: 成功
2025-06-12 15:23:52,180 - INFO - ETF价格数据: 成功
2025-06-12 15:23:52,180 - INFO - ETF持有人数据: 成功
2025-06-12 15:23:52,180 - INFO - ETF自选数据: 成功
2025-06-12 15:23:52,180 - INFO - ETF指数分类数据: 成功
2025-06-12 15:23:52,180 - INFO - ETF商务协议数据: 成功
2025-06-12 15:23:52,181 - INFO - === 数据库记录统计 ===
2025-06-12 15:23:52,181 - INFO - ETF基本信息表: 1190条记录
2025-06-12 15:23:52,181 - INFO - ETF价格数据表: 1190条记录
2025-06-12 15:23:52,181 - INFO - ETF持有人数据表: 1146条记录
2025-06-12 15:23:52,181 - INFO - ETF自选数据表: 1170条记录
2025-06-12 15:23:52,181 - INFO - ETF商务协议数据表: 341条记录
2025-06-12 15:23:52,181 - INFO - 开始更新基金公司分析数据...
2025-06-12 15:23:52,362 - INFO - 基金公司分析数据更新成功。
2025-06-12 15:23:52,362 - INFO - 基金公司分析表: 54条记录
2025-06-17 10:29:21,440 - INFO - === 开始导入所有ETF数据 ===
2025-06-17 10:29:21,516 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-17 10:29:21,517 - INFO - 开始导入ETF基本信息...
2025-06-17 10:29:21,519 - INFO - 使用文件: data/ETF_DATA_20250616.xlsx
2025-06-17 10:29:21,520 - INFO - 从文件名中提取的日期: 2025-06-16
2025-06-17 10:29:22,391 - INFO - 成功导入ETF基本信息，共1194条记录
2025-06-17 10:29:22,392 - INFO - 开始导入ETF价格数据...
2025-06-17 10:29:22,392 - INFO - 使用文件: data/ETF_DATA_20250616.xlsx
2025-06-17 10:29:22,392 - INFO - 从文件名中提取的日期: 2025-06-16
2025-06-17 10:29:22,932 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20241231\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20241231\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-17 10:29:22,933 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-17 10:29:22,935 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20241231\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20241231\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-17 10:29:22,958 - INFO - 数据示例:
     code       证券简称                      业绩比较基准  ...  premium_discount_rate        date          update_time
0  159005   汇添富快钱ETF                  活期存款利率(税后)  ...               0.000000  2025-06-16  2025-06-17 10:29:22
1  159321    黄金股票ETF            中证沪深港黄金产业股票指数收益率  ...               0.180894  2025-06-16  2025-06-17 10:29:22
2  159526   机器人ETF嘉实                  中证机器人指数收益率  ...              -0.091583  2025-06-16  2025-06-17 10:29:22
3  159531  中证2000ETF                 中证2000指数收益率  ...               0.248624  2025-06-16  2025-06-17 10:29:22
4  159569  港股红利低波ETF  国证港股通红利低波动率指数收益率(使用估值汇率折算)  ...              -0.030455  2025-06-16  2025-06-17 10:29:22

[5 rows x 39 columns]
2025-06-17 10:29:22,998 - INFO - 成功导入ETF价格数据，共1194条记录
2025-06-17 10:29:22,998 - INFO - 开始导入ETF持有人数据...
2025-06-17 10:29:22,999 - INFO - 使用文件: data/客户ETF保有量20250616.xlsx
2025-06-17 10:29:22,999 - INFO - 从文件名中提取的日期: 2025-06-16
2025-06-17 10:29:23,064 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-17 10:29:23,074 - INFO - 原始列名: ['数据截止日期']
2025-06-17 10:29:23,074 - INFO - 数据形状: (0, 1)
2025-06-17 10:29:23,074 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-17 10:29:23,074 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-17 10:29:23,189 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-17 10:29:23,210 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-17 10:29:23,213 - INFO - 成功读取数据，形状: (1146, 6)
2025-06-17 10:29:23,215 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-17 10:29:23,222 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250616  159001       货币ETF         91304.0            12   9.130400e+06  2025-06-16
1      None  159003     招商快线ETF           753.0             3   7.530000e+04  2025-06-16
2      None  159005    汇添富快钱ETF          1500.0            13   1.500000e+05  2025-06-16
3      None  159150  深证50ETF易方达       1652760.0            34   1.895716e+06  2025-06-16
4      None  159201    自由现金流ETF      21373389.0           495   2.128790e+07  2025-06-16
2025-06-17 10:29:23,320 - INFO - 成功导入ETF持有人数据，共1146条记录
2025-06-17 10:29:23,320 - INFO - 开始导入ETF自选数据...
2025-06-17 10:29:23,321 - INFO - 使用文件: data/客户ETF自选人数20250616.xlsx
2025-06-17 10:29:23,321 - INFO - 从文件名中提取的日期: 2025-06-16
2025-06-17 10:29:23,350 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-17 10:29:23,359 - INFO - 原始列名: ['数据截止日期']
2025-06-17 10:29:23,359 - INFO - 数据形状: (0, 1)
2025-06-17 10:29:23,360 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-17 10:29:23,360 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-17 10:29:23,423 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-17 10:29:23,426 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-17 10:29:23,427 - INFO - 成功读取数据，形状: (1175, 3)
2025-06-17 10:29:23,427 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-17 10:29:23,427 - INFO - 找到的代码列: ['标的代码']
2025-06-17 10:29:23,427 - INFO - 找到的自选列: ['加自选人数']
2025-06-17 10:29:23,429 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-17 10:29:23,433 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250616  159001              101  2025-06-16
1      None  159003               96  2025-06-16
2      None  159005               45  2025-06-16
3      None  159150              243  2025-06-16
4      None  159201              952  2025-06-16
2025-06-17 10:29:23,511 - INFO - 成功导入ETF自选数据，共1175条记录
2025-06-17 10:29:23,511 - INFO - 开始导入ETF指数分类数据...
2025-06-17 10:29:23,512 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-17 10:29:23,593 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-17 10:29:23,593 - INFO - 开始导入ETF商务协议数据...
2025-06-17 10:29:23,594 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-17 10:29:23,701 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-17 10:29:23,701 - INFO - === ETF数据导入完成 ===
2025-06-17 10:29:23,701 - INFO - ETF基本信息: 成功
2025-06-17 10:29:23,701 - INFO - ETF价格数据: 成功
2025-06-17 10:29:23,701 - INFO - ETF持有人数据: 成功
2025-06-17 10:29:23,701 - INFO - ETF自选数据: 成功
2025-06-17 10:29:23,701 - INFO - ETF指数分类数据: 成功
2025-06-17 10:29:23,701 - INFO - ETF商务协议数据: 成功
2025-06-17 10:29:23,703 - INFO - === 数据库记录统计 ===
2025-06-17 10:29:23,703 - INFO - ETF基本信息表: 1194条记录
2025-06-17 10:29:23,703 - INFO - ETF价格数据表: 1194条记录
2025-06-17 10:29:23,703 - INFO - ETF持有人数据表: 1146条记录
2025-06-17 10:29:23,703 - INFO - ETF自选数据表: 1175条记录
2025-06-17 10:29:23,703 - INFO - ETF商务协议数据表: 341条记录
2025-06-17 10:29:23,703 - INFO - 开始更新基金公司分析数据...
2025-06-17 10:29:23,849 - INFO - 基金公司分析数据更新成功。
2025-06-17 10:29:23,849 - INFO - 基金公司分析表: 55条记录
2025-06-18 08:53:16,651 - INFO - === 开始导入所有ETF数据 ===
2025-06-18 08:53:16,653 - INFO - 列名映射已保存到: data/etf_column_names.json
2025-06-18 08:53:16,653 - INFO - 开始导入ETF基本信息...
2025-06-18 08:53:16,655 - INFO - 使用文件: data/ETF_DATA_20250617.xlsx
2025-06-18 08:53:16,655 - INFO - 从文件名中提取的日期: 2025-06-17
2025-06-18 08:53:17,589 - INFO - 成功导入ETF基本信息，共1194条记录
2025-06-18 08:53:17,589 - INFO - 开始导入ETF价格数据...
2025-06-18 08:53:17,590 - INFO - 使用文件: data/ETF_DATA_20250617.xlsx
2025-06-18 08:53:17,590 - INFO - 从文件名中提取的日期: 2025-06-17
2025-06-18 08:53:18,119 - INFO - 原始列名: ['证券代码', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20241231\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20241231\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %', '换手率\n[交易日期] 最新收盘日\n[单位] %', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元', '振幅\n[交易日期] 最新收盘日\n[单位] %', '升贴水\n[交易日期] 最新收盘日\n[单位] 元', '升贴水率\n[交易日期] 最新收盘日\n[单位] %']
2025-06-18 08:53:18,120 - INFO - 匹配到的列映射: {'证券代码': 'code', '涨跌幅\n[交易日期] 最新收盘日\n[单位] %': 'change_rate', '换手率\n[交易日期] 最新收盘日\n[单位] %': 'turnover_rate', '成交额\n[交易日期] 最新收盘日\n[单位] 亿元': 'amount', '成交笔数\n[交易日期] 最新收盘日\n[单位] 笔': 'transaction_count', '总市值\n[交易日期] 最新收盘日\n[单位] 亿元': 'total_market_value', '开盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'open_price', '最高价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'high_price', '最低价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'low_price', '收盘价\n[交易日期] 最新收盘日\n[复权方式] 不复权\n[单位] 元': 'close_price', '振幅\n[交易日期] 最新收盘日\n[单位] %': 'amplitude', '升贴水\n[交易日期] 最新收盘日\n[单位] 元': 'premium_discount', '升贴水率\n[交易日期] 最新收盘日\n[单位] %': 'premium_discount_rate'}
2025-06-18 08:53:18,122 - INFO - 最终列名: ['code', '证券简称', '业绩比较基准', '成立年限\n[单位] 年', '基金上市地点', '基金成立日', '基金管理人', '管理费率\n[单位] %', '托管费率\n[单位] %', '指数使用费率', '跟踪指数代码', '日均跟踪偏离度阈值(业绩基准)\n[单位] %', '年化跟踪误差阈值(业绩基准)\n[单位] %', '跟踪误差\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '跟踪误差(跟踪指数)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[单位] %', '信息比率(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[无风险收益率] 一年定存利率（税前）\n[标的指数] 上证指数', '跟踪误差(年化)\n[起始交易日期] S_cal_date(enddate,-52,W,0)\n[截止交易日期] 最新收盘日\n[计算周期] 日\n[收益率计算方法] 普通收益率\n[标的指数] 上证指数\n[单位] %', '基金规模(合计)\n[交易日期] S_cal_date(now(),0,D,0)\n[单位] 亿元', '基金份额持有人户数\n[报告期] 20241231\n[单位] 户', '基金份额持有人户数(合计)\n[报告期] 20241231\n[单位] 户', '区间日均成交额\n[起始交易日期] S_cal_date(enddate,-1,M,0)\n[截止交易日期] 最新收盘日\n[单位] 亿元', '基金管理人简称', '基金场内简称', '跟踪指数名称', '月成交额\n[交易日期] 最新收盘日\n[单位] 百万元', 'change_rate', 'turnover_rate', 'amount', 'transaction_count', 'total_market_value', 'open_price', 'high_price', 'low_price', 'close_price', 'amplitude', 'premium_discount', 'premium_discount_rate', 'date', 'update_time']
2025-06-18 08:53:18,145 - INFO - 数据示例:
     code       证券简称            业绩比较基准  成立年限\n[单位] 年   基金上市地点  ... amplitude premium_discount  premium_discount_rate        date          update_time
0  563010      电信ETF       中证电信主题指数收益率      1.956164  上海证券交易所  ...  0.691776          -0.0041              -0.316823  2025-06-17  2025-06-18 08:53:18
1  159005   汇添富快钱ETF        活期存款利率(税后)     10.493151  深圳证券交易所  ...  0.002000           0.0000               0.000000  2025-06-17  2025-06-18 08:53:18
2  159321    黄金股票ETF  中证沪深港黄金产业股票指数收益率      1.109589  深圳证券交易所  ...  2.321582           0.0009               0.078322  2025-06-17  2025-06-18 08:53:18
3  159526   机器人ETF嘉实        中证机器人指数收益率      1.172603  深圳证券交易所  ...  1.000000          -0.0006              -0.050184  2025-06-17  2025-06-18 08:53:18
4  159531  中证2000ETF       中证2000指数收益率      1.780822  深圳证券交易所  ...  0.974314          -0.0007              -0.062239  2025-06-17  2025-06-18 08:53:18

[5 rows x 39 columns]
2025-06-18 08:53:18,184 - INFO - 成功导入ETF价格数据，共1194条记录
2025-06-18 08:53:18,185 - INFO - 开始导入ETF持有人数据...
2025-06-18 08:53:18,186 - INFO - 使用文件: data/客户ETF保有量20250617.xlsx
2025-06-18 08:53:18,186 - INFO - 从文件名中提取的日期: 2025-06-17
2025-06-18 08:53:18,251 - INFO - 文件中的工作表: ['客户ETF保有量', '仪表板']
2025-06-18 08:53:18,260 - INFO - 原始列名: ['数据截止日期']
2025-06-18 08:53:18,260 - INFO - 数据形状: (0, 1)
2025-06-18 08:53:18,261 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-18 08:53:18,261 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-18 08:53:18,370 - INFO - 尝试读取工作表: 客户ETF保有量
2025-06-18 08:53:18,391 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '标的名称', '持仓份额', '持仓客户数', '持仓市值')
2025-06-18 08:53:18,393 - INFO - 成功读取数据，形状: (1148, 6)
2025-06-18 08:53:18,395 - INFO - 处理后列名: ['数据截止日期', 'code', '标的名称', 'holding_amount', 'holder_count', 'holding_value', 'date']
2025-06-18 08:53:18,400 - INFO - 处理后数据前5行:
     数据截止日期    code        标的名称  holding_amount  holder_count  holding_value        date
0  20250617  159001       货币ETF         91104.0            12   9.110400e+06  2025-06-17
1      None  159003     招商快线ETF           753.0             3   7.529925e+04  2025-06-17
2      None  159005    汇添富快钱ETF          1900.0            14   1.900000e+05  2025-06-17
3      None  159150  深证50ETF易方达       1652760.0            34   1.892410e+06  2025-06-17
4      None  159201    自由现金流ETF      21601989.0           490   2.149398e+07  2025-06-17
2025-06-18 08:53:18,508 - INFO - 成功导入ETF持有人数据，共1148条记录
2025-06-18 08:53:18,509 - INFO - 开始导入ETF自选数据...
2025-06-18 08:53:18,509 - INFO - 使用文件: data/客户ETF自选人数20250617.xlsx
2025-06-18 08:53:18,509 - INFO - 从文件名中提取的日期: 2025-06-17
2025-06-18 08:53:18,538 - INFO - 文件中的工作表: ['客户ETF自选人数', '仪表板']
2025-06-18 08:53:18,547 - INFO - 原始列名: ['数据截止日期']
2025-06-18 08:53:18,547 - INFO - 数据形状: (0, 1)
2025-06-18 08:53:18,547 - INFO - 数据前5行:
Empty DataFrame
Columns: [数据截止日期]
Index: []
2025-06-18 08:53:18,547 - WARNING - 标准读取方式返回空数据或只有单列，尝试读取所有单元格...
2025-06-18 08:53:18,609 - INFO - 尝试读取工作表: 客户ETF自选人数
2025-06-18 08:53:18,613 - INFO - 找到的标题行: ('数据截止日期', '标的代码', '加自选人数')
2025-06-18 08:53:18,614 - INFO - 成功读取数据，形状: (1176, 3)
2025-06-18 08:53:18,614 - INFO - 标准化后列名: ['数据截止日期', '标的代码', '加自选人数']
2025-06-18 08:53:18,614 - INFO - 找到的代码列: ['标的代码']
2025-06-18 08:53:18,614 - INFO - 找到的自选列: ['加自选人数']
2025-06-18 08:53:18,616 - INFO - 处理后列名: ['数据截止日期', 'code', 'attention_count', 'date']
2025-06-18 08:53:18,619 - INFO - 处理后数据前5行:
     数据截止日期    code  attention_count        date
0  20250617  159001              101  2025-06-17
1      None  159003               97  2025-06-17
2      None  159005               45  2025-06-17
3      None  159150              243  2025-06-17
4      None  159201              952  2025-06-17
2025-06-18 08:53:18,692 - INFO - 成功导入ETF自选数据，共1176条记录
2025-06-18 08:53:18,693 - INFO - 开始导入ETF指数分类数据...
2025-06-18 08:53:18,693 - INFO - 使用文件: data/ETF-Index-Classification_20250328.xlsx
2025-06-18 08:53:18,744 - INFO - 成功导入ETF指数分类数据，共429条记录
2025-06-18 08:53:18,744 - INFO - 开始导入ETF商务协议数据...
2025-06-18 08:53:18,745 - INFO - 使用文件: data/ETF单产品商务协议20250416.xlsx
2025-06-18 08:53:18,848 - INFO - 成功导入ETF商务协议数据，共341条记录
2025-06-18 08:53:18,848 - INFO - === ETF数据导入完成 ===
2025-06-18 08:53:18,848 - INFO - ETF基本信息: 成功
2025-06-18 08:53:18,848 - INFO - ETF价格数据: 成功
2025-06-18 08:53:18,848 - INFO - ETF持有人数据: 成功
2025-06-18 08:53:18,848 - INFO - ETF自选数据: 成功
2025-06-18 08:53:18,848 - INFO - ETF指数分类数据: 成功
2025-06-18 08:53:18,848 - INFO - ETF商务协议数据: 成功
2025-06-18 08:53:18,849 - INFO - === 数据库记录统计 ===
2025-06-18 08:53:18,849 - INFO - ETF基本信息表: 1194条记录
2025-06-18 08:53:18,849 - INFO - ETF价格数据表: 1194条记录
2025-06-18 08:53:18,849 - INFO - ETF持有人数据表: 1148条记录
2025-06-18 08:53:18,849 - INFO - ETF自选数据表: 1176条记录
2025-06-18 08:53:18,849 - INFO - ETF商务协议数据表: 341条记录
2025-06-18 08:53:18,849 - INFO - 开始更新基金公司分析数据...
2025-06-18 08:53:18,989 - INFO - 基金公司分析数据更新成功。
2025-06-18 08:53:18,989 - INFO - 基金公司分析表: 55条记录
